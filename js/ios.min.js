function explode(a,b,c){var d={0:""};if(arguments.length<2||"undefined"==typeof arguments[0]||"undefined"==typeof arguments[1])return null;
if(""===a||a===!1||null===a)return!1;if("function"==typeof a||"object"==typeof a||"function"==typeof b||"object"==typeof b)return d;
if(a===!0&&(a="1"),c){var e=b.toString().split(a.toString()),f=e.splice(0,c-1),g=e.join(a.toString());
return f.push(g),f}return b.toString().split(a.toString())}function utf8_encode(a){if(null===a||"undefined"==typeof a)return"";
var b,c,d=a+"",e="",f=0;b=c=0,f=d.length;for(var g=0;f>g;g++){var h=d.charCodeAt(g),i=null;
128>h?c++:i=h>127&&2048>h?String.fromCharCode(h>>6|192)+String.fromCharCode(63&h|128):String.fromCharCode(h>>12|224)+String.fromCharCode(h>>6&63|128)+String.fromCharCode(63&h|128),null!==i&&(c>b&&(e+=d.slice(b,c)),e+=i,b=c=g+1)
}return c>b&&(e+=d.slice(b,f)),e}function sha1(a){var b,c,d,e,f,g,h,i,j,k=function(a,b){var c=a<<b|a>>>32-b;
return c},l=function(a){var b,c,d="";for(b=7;b>=0;b--)c=a>>>4*b&15,d+=c.toString(16);
return d},m=new Array(80),n=1732584193,o=4023233417,p=2562383102,q=271733878,r=3285377520;
a=this.utf8_encode(a);var s=a.length,t=[];for(c=0;s-3>c;c+=4)d=a.charCodeAt(c)<<24|a.charCodeAt(c+1)<<16|a.charCodeAt(c+2)<<8|a.charCodeAt(c+3),t.push(d);
switch(s%4){case 0:c=2147483648;break;case 1:c=a.charCodeAt(s-1)<<24|8388608;break;
case 2:c=a.charCodeAt(s-2)<<24|a.charCodeAt(s-1)<<16|32768;break;case 3:c=a.charCodeAt(s-3)<<24|a.charCodeAt(s-2)<<16|a.charCodeAt(s-1)<<8|128
}for(t.push(c);t.length%16!=14;)t.push(0);for(t.push(s>>>29),t.push(s<<3&4294967295),b=0;b<t.length;b+=16){for(c=0;16>c;c++)m[c]=t[b+c];
for(c=16;79>=c;c++)m[c]=k(m[c-3]^m[c-8]^m[c-14]^m[c-16],1);for(e=n,f=o,g=p,h=q,i=r,c=0;19>=c;c++)j=k(e,5)+(f&g|~f&h)+i+m[c]+1518500249&4294967295,i=h,h=g,g=k(f,30),f=e,e=j;
for(c=20;39>=c;c++)j=k(e,5)+(f^g^h)+i+m[c]+1859775393&4294967295,i=h,h=g,g=k(f,30),f=e,e=j;
for(c=40;59>=c;c++)j=k(e,5)+(f&g|f&h|g&h)+i+m[c]+2400959708&4294967295,i=h,h=g,g=k(f,30),f=e,e=j;
for(c=60;79>=c;c++)j=k(e,5)+(f^g^h)+i+m[c]+3395469782&4294967295,i=h,h=g,g=k(f,30),f=e,e=j;
n=n+e&4294967295,o=o+f&4294967295,p=p+g&4294967295,q=q+h&4294967295,r=r+i&4294967295
}return j=l(n)+l(o)+l(p)+l(q)+l(r),j.toLowerCase()}function urldecode(a){return decodeURIComponent((a+"").replace(/\+/g,"%20"))
}function parse_url(a,b){for(var c={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},d=c.parser[c.strictMode?"strict":"loose"].exec(a),e={},f=14;f--;)e[c.key[f]]=d[f]||"";
switch(b){case"PHP_URL_SCHEME":return e.protocol;case"PHP_URL_HOST":return e.host;
case"PHP_URL_PORT":return e.port;case"PHP_URL_USER":return e.user;case"PHP_URL_PASS":return e.password;
case"PHP_URL_PATH":return e.path;case"PHP_URL_QUERY":return e.query;case"PHP_URL_FRAGMENT":return e.anchor;
default:var g={};return""!==e.protocol&&(g.scheme=e.protocol),""!==e.host&&(g.host=e.host),""!==e.port&&(g.port=e.port),""!==e.user&&(g.user=e.user),""!==e.password&&(g.pass=e.password),""!==e.path&&(g.path=e.path),""!==e.query&&(g.query=e.query),""!==e.anchor&&(g.fragment=e.anchor),g
}}function parse_str(str,array){var glue1="=",glue2="&",array2=String(str).replace(/^&?([\s\S]*?)&?$/,"$1").split(glue2),i,j,chr,tmp,key,value,bracket,keys,evalStr,that=this,fixStr=function(a){return that.urldecode(a).replace(/([\\"'])/g,"\\$1").replace(/\n/g,"\\n").replace(/\r/g,"\\r")
};for(array||(array=this.window),i=0;i<array2.length;i++){for(tmp=array2[i].split(glue1),tmp.length<2&&(tmp=[tmp,""]),key=fixStr(tmp[0]),value=fixStr(tmp[1]);" "===key.charAt(0);)key=key.substr(1);
if(-1!==key.indexOf("\x00")&&(key=key.substr(0,key.indexOf("\x00"))),key&&"["!==key.charAt(0)){for(keys=[],bracket=0,j=0;j<key.length;j++)if("["!==key.charAt(j)||bracket){if("]"===key.charAt(j)&&bracket&&(keys.length||keys.push(key.substr(0,bracket-1)),keys.push(key.substr(bracket,j-bracket)),bracket=0,"["!==key.charAt(j+1)))break
}else bracket=j+1;for(keys.length||(keys=[key]),j=0;j<keys[0].length&&(chr=keys[0].charAt(j),(" "===chr||"."===chr||"["===chr)&&(keys[0]=keys[0].substr(0,j)+"_"+keys[0].substr(j+1)),"["!==chr);j++);for(evalStr="array",j=0;j<keys.length;j++)key=keys[j],key=""!==key&&" "!==key||0===j?"'"+key+"'":eval(evalStr+".push([]);")-1,evalStr+="["+key+"]",j!==keys.length-1&&"undefined"===eval("typeof "+evalStr)&&eval(evalStr+" = [];");
evalStr+=" = '"+value+"';\n",eval(evalStr)}}}function htmlspecialchars(a,b,c,d){var e=0,f=0,g=!1;
("undefined"==typeof b||null===b)&&(b=2),a=a.toString(),d!==!1&&(a=a.replace(/&/g,"&amp;")),a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");
var h={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};
if(0===b&&(g=!0),"number"!=typeof b){for(b=[].concat(b),f=0;f<b.length;f++)0===h[b[f]]?g=!0:h[b[f]]&&(e|=h[b[f]]);
b=e}return b&h.ENT_HTML_QUOTE_SINGLE&&(a=a.replace(/'/g,"&#039;")),g||(a=a.replace(/"/g,"&quot;")),a
}function htmlspecialchars_decode(a,b){var c=0,d=0,e=!1;"undefined"==typeof b&&(b=2),a=a.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");
var f={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};
if(0===b&&(e=!0),"number"!=typeof b){for(b=[].concat(b),d=0;d<b.length;d++)0===f[b[d]]?e=!0:f[b[d]]&&(c|=f[b[d]]);
b=c}return b&f.ENT_HTML_QUOTE_SINGLE&&(a=a.replace(/&#0*39;/g,"'")),e||(a=a.replace(/&quot;/g,'"')),a=a.replace(/&amp;/g,"&")
}function setlocale(a,b){var c="",d=[],e=0,f=this.window.document,g=function m(a){if(a instanceof RegExp)return new RegExp(a);
if(a instanceof Date)return new Date(a);var b={};for(var c in a)b[c]="object"==typeof a[c]?m(a[c]):a[c];
return b},h=function(a){return 1!==a?1:0},i=function(a){return a>1?1:0};this.php_js=this.php_js||{};
var j=this.php_js;if(j.locales||(j.locales={},j.locales.en={LC_COLLATE:function(a,b){return a==b?0:a>b?1:-1
},LC_CTYPE:{an:/^[A-Za-z\d]+$/g,al:/^[A-Za-z]+$/g,ct:/^[\u0000-\u001F\u007F]+$/g,dg:/^[\d]+$/g,gr:/^[\u0021-\u007E]+$/g,lw:/^[a-z]+$/g,pr:/^[\u0020-\u007E]+$/g,pu:/^[\u0021-\u002F\u003A-\u0040\u005B-\u0060\u007B-\u007E]+$/g,sp:/^[\f\n\r\t\v ]+$/g,up:/^[A-Z]+$/g,xd:/^[A-Fa-f\d]+$/g,CODESET:"UTF-8",lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"},LC_TIME:{a:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],A:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B:["January","February","March","April","May","June","July","August","September","October","November","December"],c:"%a %d %b %Y %r %Z",p:["AM","PM"],P:["am","pm"],r:"%I:%M:%S %p",x:"%m/%d/%Y",X:"%r",alt_digits:"",ERA:"",ERA_YEAR:"",ERA_D_T_FMT:"",ERA_D_FMT:"",ERA_T_FMT:""},LC_MONETARY:{int_curr_symbol:"USD",currency_symbol:"$",mon_decimal_point:".",mon_thousands_sep:",",mon_grouping:[3],positive_sign:"",negative_sign:"-",int_frac_digits:2,frac_digits:2,p_cs_precedes:1,p_sep_by_space:0,n_cs_precedes:1,n_sep_by_space:0,p_sign_posn:3,n_sign_posn:0},LC_NUMERIC:{decimal_point:".",thousands_sep:",",grouping:[3]},LC_MESSAGES:{YESEXPR:"^[yY].*",NOEXPR:"^[nN].*",YESSTR:"",NOSTR:""},nplurals:h},j.locales.en_US=g(j.locales.en),j.locales.en_US.LC_TIME.c="%a %d %b %Y %r %Z",j.locales.en_US.LC_TIME.x="%D",j.locales.en_US.LC_TIME.X="%r",j.locales.en_US.LC_MONETARY.int_curr_symbol="USD ",j.locales.en_US.LC_MONETARY.p_sign_posn=1,j.locales.en_US.LC_MONETARY.n_sign_posn=1,j.locales.en_US.LC_MONETARY.mon_grouping=[3,3],j.locales.en_US.LC_NUMERIC.thousands_sep="",j.locales.en_US.LC_NUMERIC.grouping=[],j.locales.en_GB=g(j.locales.en),j.locales.en_GB.LC_TIME.r="%l:%M:%S %P %Z",j.locales.en_AU=g(j.locales.en_GB),j.locales.C=g(j.locales.en),j.locales.C.LC_CTYPE.CODESET="ANSI_X3.4-1968",j.locales.C.LC_MONETARY={int_curr_symbol:"",currency_symbol:"",mon_decimal_point:"",mon_thousands_sep:"",mon_grouping:[],p_cs_precedes:127,p_sep_by_space:127,n_cs_precedes:127,n_sep_by_space:127,p_sign_posn:127,n_sign_posn:127,positive_sign:"",negative_sign:"",int_frac_digits:127,frac_digits:127},j.locales.C.LC_NUMERIC={decimal_point:".",thousands_sep:"",grouping:[]},j.locales.C.LC_TIME.c="%a %b %e %H:%M:%S %Y",j.locales.C.LC_TIME.x="%m/%d/%y",j.locales.C.LC_TIME.X="%H:%M:%S",j.locales.C.LC_MESSAGES.YESEXPR="^[yY]",j.locales.C.LC_MESSAGES.NOEXPR="^[nN]",j.locales.fr=g(j.locales.en),j.locales.fr.nplurals=i,j.locales.fr.LC_TIME.a=["dim","lun","mar","mer","jeu","ven","sam"],j.locales.fr.LC_TIME.A=["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],j.locales.fr.LC_TIME.b=["jan","f\xe9v","mar","avr","mai","jun","jui","ao\xfb","sep","oct","nov","d\xe9c"],j.locales.fr.LC_TIME.B=["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"],j.locales.fr.LC_TIME.c="%a %d %b %Y %T %Z",j.locales.fr.LC_TIME.p=["",""],j.locales.fr.LC_TIME.P=["",""],j.locales.fr.LC_TIME.x="%d.%m.%Y",j.locales.fr.LC_TIME.X="%T",j.locales.fr_CA=g(j.locales.fr),j.locales.fr_CA.LC_TIME.x="%Y-%m-%d"),!j.locale){j.locale="en_US";
var k="http://www.w3.org/1999/xhtml",l="http://www.w3.org/XML/1998/namespace";f.getElementsByTagNameNS&&f.getElementsByTagNameNS(k,"html")[0]?f.getElementsByTagNameNS(k,"html")[0].getAttributeNS&&f.getElementsByTagNameNS(k,"html")[0].getAttributeNS(l,"lang")?j.locale=f.getElementsByTagName(k,"html")[0].getAttributeNS(l,"lang"):f.getElementsByTagNameNS(k,"html")[0].lang&&(j.locale=f.getElementsByTagNameNS(k,"html")[0].lang):f.getElementsByTagName("html")[0]&&f.getElementsByTagName("html")[0].lang&&(j.locale=f.getElementsByTagName("html")[0].lang)
}if(j.locale=j.locale.replace("-","_"),j.locale in j.locales||j.locale.replace(/_[a-zA-Z]+$/,"")in j.locales&&(j.locale=j.locale.replace(/_[a-zA-Z]+$/,"")),j.localeCategories||(j.localeCategories={LC_COLLATE:j.locale,LC_CTYPE:j.locale,LC_MONETARY:j.locale,LC_NUMERIC:j.locale,LC_TIME:j.locale,LC_MESSAGES:j.locale}),null===b||""===b)b=this.getenv(a)||this.getenv("LANG");
else if("[object Array]"===Object.prototype.toString.call(b))for(e=0;e<b.length;e++){if(b[e]in this.php_js.locales){b=b[e];
break}if(e===b.length-1)return!1}if("0"===b||0===b){if("LC_ALL"===a){for(c in this.php_js.localeCategories)d.push(c+"="+this.php_js.localeCategories[c]);
return d.join(";")}return this.php_js.localeCategories[a]}if(!(b in this.php_js.locales))return!1;
if("LC_ALL"===a)for(c in this.php_js.localeCategories)this.php_js.localeCategories[c]=b;
else this.php_js.localeCategories[a]=b;return b}function strftime(a,b){this.php_js=this.php_js||{},this.setlocale("LC_ALL",0);
for(var c=this.php_js,d=function(a,b,c){for("undefined"==typeof c&&(c=10);parseInt(a,10)<c&&c>1;c/=10)a=b.toString()+a;
return a.toString()},e=c.localeCategories.LC_TIME,f=c.locales,g=f[e].LC_TIME,h={a:function(a){return g.a[a.getDay()]
},A:function(a){return g.A[a.getDay()]},b:function(a){return g.b[a.getMonth()]},B:function(a){return g.B[a.getMonth()]
},C:function(a){return d(parseInt(a.getFullYear()/100,10),0)},d:["getDate","0"],e:["getDate"," "],g:function(a){return d(parseInt(this.G(a)/100,10),0)
},G:function(a){var b=a.getFullYear(),c=parseInt(h.V(a),10),d=parseInt(h.W(a),10);
return d>c?b++:0===d&&c>=52&&b--,b},H:["getHours","0"],I:function(a){var b=a.getHours()%12;
return d(0===b?12:b,0)},j:function(a){var b=a-new Date(""+a.getFullYear()+"/1/1 GMT");
b+=6e4*a.getTimezoneOffset();var c=parseInt(b/6e4/60/24,10)+1;return d(c,0,100)},k:["getHours","0"],l:function(a){var b=a.getHours()%12;
return d(0===b?12:b," ")},m:function(a){return d(a.getMonth()+1,0)},M:["getMinutes","0"],p:function(a){return g.p[a.getHours()>=12?1:0]
},P:function(a){return g.P[a.getHours()>=12?1:0]},s:function(a){return Date.parse(a)/1e3
},S:["getSeconds","0"],u:function(a){var b=a.getDay();return 0===b?7:b},U:function(a){var b=parseInt(h.j(a),10),c=6-a.getDay(),e=parseInt((b+c)/7,10);
return d(e,0)},V:function(a){var b=parseInt(h.W(a),10),c=new Date(""+a.getFullYear()+"/1/1").getDay(),e=b+(c>4||1>=c?0:1);
return 53===e&&new Date(""+a.getFullYear()+"/12/31").getDay()<4?e=1:0===e&&(e=h.V(new Date(""+(a.getFullYear()-1)+"/12/31"))),d(e,0)
},w:"getDay",W:function(a){var b=parseInt(h.j(a),10),c=7-h.u(a),e=parseInt((b+c)/7,10);
return d(e,0,10)},y:function(a){return d(a.getFullYear()%100,0)},Y:"getFullYear",z:function(a){var b=a.getTimezoneOffset(),c=d(parseInt(Math.abs(b/60),10),0),e=d(b%60,0);
return(b>0?"-":"+")+c+e},Z:function(a){return a.toString().replace(/^.*\(([^)]+)\)$/,"$1")
},"%":function(){return"%"}},i="undefined"==typeof b?new Date:new Date("object"==typeof b?b:1e3*b),j={c:"locale",D:"%m/%d/%y",F:"%y-%m-%d",h:"%b",n:"\n",r:"locale",R:"%H:%M",t:"	",T:"%H:%M:%S",x:"locale",X:"locale"};a.match(/%[cDFhnrRtTxX]/);)a=a.replace(/%([cDFhnrRtTxX])/g,function(a,b){var c=j[b];
return"locale"===c?g[b]:c});var k=a.replace(/%([aAbBCdegGHIjklmMpPsSuUVwWyYzZ%])/g,function(a,b){var c=h[b];
return"string"==typeof c?i[c]():"function"==typeof c?c(i):"object"==typeof c&&"string"==typeof c[0]?d(i[c[0]](),c[1]):b
});return k}function init_device(){var a=$("#activityIndicator");log("init_device()"),deviceVars.engineVersion=navigator.userAgent.match(/WebKit\/(\d+)/),deviceVars.engineVersion=null!==deviceVars.engineVersion?deviceVars.engineVersion[1]:525,deviceVars.useCSS3animations=deviceVars.engineVersion>=532,deviceVars.scrollProperty=deviceVars.engineVersion>=532?"-webkit-transform":"top",deviceVars.scrollValue=deviceVars.engineVersion>=532?"translateY($1px)":"$1px",$navBar=$("#navBoxHeader"),activityIndicatorTop=Math.floor($(window).height()/3),a.css("top",activityIndicatorTop),$("#startUp-initDevice").addClass("success")
}function onDeviceReady(){try{log("Device Ready"),log("URL to Load: "+window.Settings.LoadURL),log("Device: "+window.device.platform),log("Camera Present: "+window.device.camerapresent),log("Multitasking: "+window.device.multitasking),MyAnswers.cameraPresent=window.device.camerapresent,MyAnswers.loadURL=window.Settings.LoadURL,MyAnswers.multiTasking=window.device.multitasking,siteVars.answerSpace=window.Settings.answerSpace,siteVars.serverDevicePath=MyAnswers.loadURL+"ios/"+siteVars.serverAppVersion+"/",deviceVars.deviceFileName="/ios.js",log("AppDevicePath: "+siteVars.serverDevicePath),log("AppPath: "+siteVars.serverAppPath)
}catch(a){log("onDeviceReady exception: "),log(a)}}function isCameraPresent(){var a=isBlinkGapDevice();
return info("isBlinkGapDevice(): "+a),a&&window.device.camerapresent}function triggerScroll(){$(window).trigger("scroll")
}function insertHTML(a,b){"object"===$.type(a)&&MyAnswers.dispatch.add(function(){$(a).html(b),$("img").off("error",siteVars.fixImages),$("img").on("error",siteVars.fixImages)
})}function insertText(a,b){"object"===$.type(a)&&"string"==typeof b&&MyAnswers.dispatch.add(function(){$(a).text(b)
})}function setMainLabel(a){var b=document.getElementById("mainLabel");insertText(b,a)
}function deserialize(a){var b=a.split("&"),c={};return $.each(b,function(a,b){var d,e,f;
0!==b.length&&-1!==(d=b.indexOf("="))&&(e=b.substring(0,d),f=b.substring(d+1),c[decodeURIComponent(e)]=decodeURIComponent(f))
}),c}function getURLParameters(){var a,b=window.location.href,c={},d=new RegExp("/"+siteVars.answerSpace+"/([^/?]*)","i");
return-1!==b.indexOf("?")&&(a=b.match(/\?([^#]*)#?.*$/),a&&a.length>=2&&(c=deserialize(a[1]),"string"==typeof c.keyword&&(c.keyword=c.keyword.replace("/","")))),a=b.match(d),a&&a.length>=2&&(c.keyword=a[1]),c
}function isAJAXError(a){switch(a){case null:case"timeout":case"error":case"notmodified":case"parseerror":return!0;
default:return!1}}function populateDataTags(a,b){var c;for(c in b)b.hasOwnProperty(c)&&a.attr("data-"+c,b[c])
}function processBlinkAnswerMessage(a){var b,c,d=MyAnswers.device.persistentStorage;
if(a=$.parseJSON(a),d&&"string"==typeof a.mojotarget&&("string"==typeof a.mojoxml?(log("controlMessage: populating Data Suitcase: "+a.mojotarget),MyAnswers.store.set("mojoXML:"+a.mojotarget,a.mojoxml)):a.mojodelete&&(log("controlMessage: deleting Data Suitcase: "+a.mojotarget),MyAnswers.store.remove("mojoXML:"+a.mojotarget))),d&&a.startype){if(starsProfile[a.startype]=starsProfile[a.startype]||{},a.clearstars&&delete starsProfile[a.startype],"array"===$.type(a.staroff))for(c=a.staroff.length,b=0;c>b;b++)delete starsProfile[a.startype][a.staroff[b]];
if("array"===$.type(a.staron))for(c=a.staron.length,b=0;c>b;b++)starsProfile[a.startype][a.staron[b]]=starsProfile[a.startype][a.staron[b]]||{};
MyAnswers.store.set("starsProfile",JSON.stringify(starsProfile))}}function resolveItemName(a,b){var c,d,e,f,g;
if(b="string"==typeof b&&b||"interactions",c=b.substring(0,1),"number"==typeof a&&!isNaN(a)&&"object"===$.type(siteVars.config[c+a]))return a;
if("string"!=typeof a)return!1;for(a=decodeURI(a.replace(/\+/g," ").toLowerCase()),d=siteVars.map[b],f=d.length,e=0;f>e;e++)if(g=c+d[e],"object"===$.type(siteVars.config[g])&&a===siteVars.config[g].pertinent.name.toLowerCase())return d[e];
return"object"===$.type(siteVars.config[c+a])?a:!1}function performXSLT(a,b){var c=new $.Deferred(function(c){{var d,e,f,g;
window.ActiveXObject}return"string"!=typeof a||"string"!=typeof b?void c.reject("XSLT failed due to poorly formed XML or XSL."):(e=$.parseXML(a),f=$.parseXML(b),window.XSLTProcessor?(log("performXSLT(): performing XSLT via XSLTProcessor (W3C)"),g=new window.XSLTProcessor,g.importStylesheet(f),d=g.transformToFragment(e,document)):"undefined"!=typeof e.transformNode?(log("performXSLT(): performing XSLT via transformNode (IE)"),d=e.transformNode(f)):window.xsltProcess?(log("performXSLT(): performing XSLT via AJAXSLT library"),d=window.xsltProcess(e,f)):d="<p>Your browser does not support Data Suitcase keywords.</p>",void c.resolve(d))
});return c.promise()}function isHome(){var a=siteVars.config["a"+siteVars.id].pertinent.siteStructure,b=$(".view:visible").first().attr("id");
switch(a){case"master categories":return"masterCategoriesView"===b;case"categories":return"categoriesView"===b;
default:return"keywordListView"===b}}function generateMojoAnswer(a){log("generateMojoAnswer(): currentConfig="+currentConfig.name);
var b,c,d,e,f,g,h,i,j=new $.Deferred,k=new $.Deferred,l=currentConfig.xsl,m=function(a,c){b+="<"+a+">"+c+"</"+a+">"
},n=function(a){h+=" or "+g+"='"+a+"'"};if("string"!==$.type(l)||0===l.length)return j.reject("<p>Error: this Interaction does not have any XSL to transform.</p>"),j.promise();
if(a)for(c=l.match(/\$args\[[\w\:][\w\:\-\.]*\]/g),e=c?c.length:0,d=0;e>d;d++)f="string"==typeof a[c[d].substring(1)]?a[c[d].substring(1)]:"",f=f.replace('"',""),f=f.replace("'",""),f=decodeURIComponent(f),l=l.replace(c[d],f);
for(i=l.match(/blink-stars\(([@\w.]+),\W*(\w+)\W*\)/);i;)h="",g=i[1],i=i[2],"object"===$.type(starsProfile[i])&&($.each(starsProfile[i],n),h=h.substr(4)),l=h.length>0?l.replace(/\(?blink-stars\(([@\w.]+),\W*(\w+)\W*\)\)?/,"("+h+")"):l.replace(/\(?blink-stars\(([@\w.]+),\W*(\w+)\W*\)\)?/,"(false())"),i=l.match(/blink-stars\(([@\w.]+),\W*(\w+)\W*\)/);
return"string"===$.type(currentConfig.xml)&&0===currentConfig.xml.indexOf("stars:")&&(currentConfig.mojoType="stars",currentConfig.xml=currentConfig.xml.replace(/^stars:/,"")),"stars"===currentConfig.mojoType?(i=currentConfig.xml,b="","object"!==$.type(starsProfile[i])?b="<stars></stars>":($.each(starsProfile[i],function(a,c){b+="<"+i+' id="'+a+'">',$.each(c,m),b+="</"+i+">"
}),b="<stars>"+b+"</stars>"),setTimeout(k.resolve,0)):"active-forms"===currentConfig.mojoType?$.when(window.getActiveFormsXML()).always(function(a){b=a,setTimeout(k.resolve,0)
}):"string"===$.type(currentConfig.xml)&&currentConfig.xml?$.when(MyAnswers.store.get("mojoXML:"+currentConfig.xml)).always(function(a){b=a,b||(b="<xml />"),setTimeout(k.resolve,0)
}):(b="<xml />",setTimeout(k.resolve,0)),"pending"!==j.state()?j.promise():($.when(k).always(function(){$.when(performXSLT(b,l)).done(function(a){j.resolve(a)
}).fail(function(a){j.resolve(a)})}),j.promise())}function getActiveFormsXML(){var a=new $.Deferred,b="";
return $.when(MyAnswers.pendingStore.keys(),MyAnswers.pendingV1Store.keys()).fail(function(){b="<type>error</type>",b+="<message>Unable to list active form records.</message>",b="<status>"+b+"</status>",a.resolve('<?xml version="1.0"?>\n<records>'+b+"</records>")
}).then(function(c,d){var e=[],f=function(a,c,d){var f,g=c.split(":"),h=siteVars.config["i"+g[0]],i=h?h.pertinent.name:"* unknown *",j=h?h.pertinent.displayName||h.pertinent.name:"* unknown *",k=g[1],l=g[2],m="";
m+="<id>"+c+"</id>\n",m+="<interaction>"+i+"</interaction>\n",m+="<interactionLabel>"+j+"</interactionLabel>\n",m+="<uuid>"+l+"</uuid>\n",m+="<form>"+k+"</form>\n",m+="<blinkFormsVersion>"+d+"</blinkFormsVersion>\n",2===d?(f=MyAnswers.pendingStore.get(c),e.push(f.promise()),$.when(f).fail(function(){b+="<record>"+m+"</record>\n"
}).then(function(a){var c,d="";"string"==typeof a&&0!==a.length&&("object"!==$.type(a)&&(a=$.parseJSON(a)),"array"===$.type(a)&&(a.length>=3&&(c=a[2],c.status&&(m+="<status>"+c.status+"</status>\n")),$.each(a[1],function(a,b){var c="";
c+="<name>"+a+"</name>\n",c+="<value>"+htmlspecialchars(b)+"</value>\n",d+="<field>"+c+"</field>\n"
}),m+="<fields>"+d+"</fields>\n"),b+="<record>"+m+"</record>\n")})):b+="<record>"+m+"</record>\n"
};$.each(c,function(a,b){f(a,b,2)}),$.each(d,function(a,b){f(a,b,1)}),$.whenArray(e).fail(function(){b="<type>error</type>",b+="<message>Unable to list active form records.</message>",b="<status>"+b+"</status>",a.resolve('<?xml version="1.0"?>\n<records>'+b+"</records>")
}).then(function(){a.resolve('<?xml version="1.0"?>\n<records>'+b+"</records>")})
}),a.promise()}function setSubmitCachedFormButton(){var a=$("#pendingButton");a.length>0&&$.when(window.countPendingForms()).fail(function(){a.hide()
}).then(function(b){var c=b+" Pending";MyAnswers.dispatch.add(function(){"number"==typeof b&&b>0?(insertText(a[0],c),a.show()):a.hide(),log("setSubmitCachedFormButton(): "+c)
})})}function onStarClick(){var a,b=$(this).data("id"),c=$(this).data("type"),d=$(this).data(),e=new Date;
if(delete d.id,delete d.type,$(this).hasClass("blink-star-on"))$(this).addClass("blink-star-off"),$(this).removeClass("blink-star-on"),delete starsProfile[c][b],$.isEmptyObject(starsProfile[c])&&delete starsProfile[c];
else if($(this).hasClass("blink-star-off")){$(this).addClass("blink-star-on"),$(this).removeClass("blink-star-off"),"object"!==$.type(starsProfile[c])&&(starsProfile[c]={}),starsProfile[c][b]={};
for(a in d)d.hasOwnProperty(a)&&(starsProfile[c][b][a.toUpperCase()]=d[a]);starsProfile[c][b].time=e.getTime(),starsProfile[c][b].type=c,starsProfile[c][b].id=b
}MyAnswers.store.set("starsProfile",JSON.stringify(starsProfile))}function onLinkClick(a){var b,c,d=$(this),e=d.attr(),f=!1,g=!0,h=null,i=null,j=null;
try{if(log("onLinkClick(): "+$(this).tagHTML()),"string"==typeof e.href){if(e.href=$.trim(e.href),c=explode("?",e.href,2),c[1]&&$.each(deserialize(c[1].trim()),function(a,b){e[a]=b
}),-1!==e.href.indexOf("../")&&(c[0]=c[0].replace(/^\.\.\//,""),e.interaction=c[0].replace(/^(.*)(?:\/)$/g,"$1"),delete e.href),e.href&&"#"===e.href[0])return!0;
if(e.href&&"?"===e.href[0])return delete e.interaction,delete e.keyword,delete e.style,delete e["class"],j=e.href,h=History.getState().data,h.arguments=e,i=window.document.title,g?History.pushState(h,i,j):History.replaceState(h,i,j),a.preventDefault(),!1
}if(!e.href&&!e.onclick)return e.back?(History.back(),a.preventDefault(),!1):(e.home?j="/"+siteVars.answerSpace+"/":e.login?h={login:!0}:e.interaction||e.keyword?(b=resolveItemName(e.interaction||e.keyword,"interactions"),b&&($.each(e,function(a,b){"_"===a[0]&&(e["args["+a.substr(1)+"]"]=b,delete e[a])
}),delete e.interaction,delete e.keyword,delete e.style,delete e["class"],e["data-submit-stars-type"]&&(e._submitStarsType=d.data("submitStarsType"),e._submitStarsPost=d.data("submitStarsPost")||"stars"),j="/"+siteVars.answerSpace+"/"+siteVars.config["i"+b].pertinent.name+"/?"+$.param(e),h={m:currentMasterCategory,c:currentCategory,i:b,arguments:e})):e.category?(b=resolveItemName(e.category,"categories"),b&&(j="/"+siteVars.answerSpace+"/?_c="+b,h={m:currentMasterCategory,c:b})):e.mastercategory&&(b=resolveItemName(e.mastercategory,"masterCategories"),b&&(j="/"+siteVars.answerSpace+"/?_m="+b,h={m:b})),f&&("object"===$.type(h)?h._timestamp=$.now():h={_timestamp:$.now()}),(h||j)&&(g?History.pushState(h,i,j):History.replaceState(h,i,j)),a.preventDefault(),!1)
}catch(k){error("Error in onLinkClick handler..."),error(k)}return!0}function countPendingForms(){var a=new $.Deferred;
return $.when(MyAnswers.pendingStore.count(),MyAnswers.pendingV1Store.count()).then(function(b,c){a.resolve(b+c)
}).fail(function(){error("countPendingForms() unable to query storage"),a.resolve(0)
}),a.promise()}function pushPendingForm(a,b,c,d){var e=new $.Deferred;return $.when(MyAnswers.pendingStore.set(a+":"+b+":"+c,JSON.stringify(d))).then(function(){e.resolve()
}).fail(function(){e.reject()}).always(setSubmitCachedFormButton),e.promise()}function clearPendingForm(a,b,c){var d=new $.Deferred;
return $.when(MyAnswers.pendingStore.remove(a+":"+b+":"+c)).then(function(){d.resolve()
}).fail(function(){d.reject()}).always(setSubmitCachedFormButton),d.promise()}function pushPendingFormV1(a,b,c){var d=new $.Deferred;
return $.when(MyAnswers.pendingV1Store.set(a+":"+b,JSON.stringify(c))).then(function(){d.resolve(c)
}).fail(function(){d.reject()}).always(setSubmitCachedFormButton),d.promise()}function clearPendingFormV1(a,b){var c=new $.Deferred;
return $.when(MyAnswers.pendingV1Store.remove(a+":"+b)).then(function(){c.resolve()
}).fail(function(){c.reject()}).always(setSubmitCachedFormButton),c.promise()}function requestMoJO(a){var b=new $.Deferred;
return"string"!==$.type(a)||0===a.length?(b.resolve(),b.promise()):($.when(MyAnswers.store.get("mojoLastChecked:"+a)).done(function(c){var d={_id:siteVars.id,_m:a};
c=parseInt(c,10),"number"!=typeof c||isNaN(c)||(d._lc=c),deviceVars.isOnline?$.ajax({url:"/_R_/xhr/GetMoJO.php",data:d,dataType:"xml",complete:function(c){200===c.status?$.when(MyAnswers.store.set("mojoXML:"+a,c.responseText)).fail(b.reject).then(b.resolve):b.resolve()
},timeout:Math.max(1e3*currentConfig.downloadTimeout,computeTimeout(512e3))}):b.reject()
}),$.when(b.promise()).then(function(){MyAnswers.store.set("mojoLastChecked:"+a,$.now())
}),b.promise())}function processMoJOs(a){var b,c,d=new $.Deferred,e={},f=a?[a]:siteVars.map.interactions,g=f.length;
for(b=0;g>b;b++)c=siteVars.config["i"+f[b]],"object"===$.type(c)&&(c=c.pertinent,"object"===$.type(c)&&"xslt"===c.type&&"server-hosted"===c.mojoType&&"string"==typeof c.xml&&"stars:"!==c.xml.substring(0,6)&&(siteVars.mojos[c.xml]?(siteVars.mojos[c.xml].maximumAge=c.maximumAge?Math.min(c.maximumAge,siteVars.mojos[c.xml].maximumAge):siteVars.mojos[c.xml].maximumAge,siteVars.mojos[c.xml].minimumAge=c.minimumAge?Math.max(c.minimumAge,siteVars.mojos[c.xml].minimumAge):siteVars.mojos[c.xml].minimumAge):siteVars.mojos[c.xml]={maximumAge:c.maximumAge||0,minimumAge:c.minimumAge||0},e[c.xml]||(e[c.xml]=requestMoJO(c.xml))));
return e=$.map(e,function(a){return a}),$.whenArray(e).fail(d.reject).then(d.resolve),d.promise()
}function goBackToHome(){History.replaceState(null,null,"/"+siteVars.answerSpace+"/"),MyAnswers.$body.trigger("taskComplete")
}function showLoginView(){var a,b,c=$("#loginView");return currentConfig.loginAccess?MyAnswers.isCustomLogin?(a=resolveItemName(currentConfig.loginPromptInteraction,"interactions"))?(b="/"+siteVars.answerSpace+"/"+siteVars.config["i"+a].pertinent.name+"/?",History.pushState({m:null,c:null,i:a},null,b),!1):(BMP.alert("error: interaction used for login prompt is inaccessible or misconfigured"),!1):void $.when(MyAnswersDevice.prepareView(c)).always(function(){MyAnswersDevice.showView(c),setMainLabel("Login")
}):!1}function updateLoginButtons(){var a=document.getElementById("loginStatus"),b=document.getElementById("loginButton"),c=document.getElementById("logoutButton"),d=function(){var a,b;
return log("submitLogout();"),currentConfig.loginAccess?currentConfig.loginUseInteractions?(a=resolveItemName(currentConfig.loginPromptInteraction,"interactions"))?(b="/"+siteVars.answerSpace+"/"+siteVars.config["i"+a].pertinent.name+"/?",History.pushState({m:null,c:null,i:a},null,b),!1):(BMP.alert("error: login interaction is inaccessible or misconfigured"),!1):(BMP.confirm("Log out?").then(function(a){a&&$.ajax({type:"GET",cache:"false",url:"/_R_/xhr/GetLogin.php",data:{_a:"logout"},complete:function(a){if(200===a.status){var b=$.parseJSON(a.responseText);
b&&("LOGGED IN"===b.status?(MyAnswers.loginAccount=b,MyAnswers.isLoggedIn=!0):(MyAnswers.isLoggedIn=!1,delete MyAnswers.loginAccount,window.location.reload())),updateLoginButtons(),goBackToHome()
}},timeout:1e3*currentConfig.downloadTimeout})}),!1):!1};siteVars.hasLogin&&(MyAnswers.isLoggedIn?(MyAnswers.loginAccount&&"boolean"!=typeof MyAnswers.loginAccount?(MyAnswers.dispatch.add(function(){var b=$(a),c="logged in as<br />";
c+="object"===$.type(MyAnswers.loginAccount)?'<span class="loginAccount">'+MyAnswers.loginAccount.name||MyAnswers.loginAccount.username+"</span>":'<span class="loginAccount">'+MyAnswers.loginAccount+"</span>",b.empty(),b.append(c),b.off(),b.on("click",d)
}),$(a).show()):$(c).show(),$(b).hide()):($(a).hide(),$(c).hide(),$(b).show()),void 0!==currentCategory&&MyAnswers.populateItemListing("interactions",$("#keywordListView")))
}function requestLoginStatus(){var a=new $.Deferred;return siteVars.hasLogin&&deviceVars.isOnline?($.ajax({url:"/_R_/xhr/GetLogin.php",dataType:"json",complete:function(b,c){if(isAJAXError(c)||200!==b.status)return void a.reject();
var d=$.parseJSON(b.responseText);d&&("LOGGED IN"===d.status?(MyAnswers.loginAccount=d,MyAnswers.isLoggedIn=!0):(MyAnswers.isLoggedIn=!1,delete MyAnswers.loginAccount)),updateLoginButtons(),a.resolve()
},timeout:Math.max(1e3*currentConfig.downloadTimeout,computeTimeout(500))}),a.promise()):(a.reject(),a.promise())
}function submitLogin(){log("submitLogin();"),$.ajax({type:"GET",cache:"false",url:"/_R_/xhr/GetLogin.php",data:$("#loginView").find("form").serializeArray(),complete:function(a,b){if($("#loginView").find("input[type=password]").val(""),200===a.status){var c=$.parseJSON(a.responseText);
c&&("LOGGED IN"===c.status?(MyAnswers.loginAccount=c,MyAnswers.isLoggedIn=!0,$.when(window.requestConfig()).always(function(){siteVars.map&&siteVars.config?(window.processConfig(),window.updateNavigationButtons()):BMP.alert("error: insufficient data, check network and reload / refresh")
})):(MyAnswers.isLoggedIn=!1,delete MyAnswers.loginAccount)),updateLoginButtons()
}else BMP.alert("Unable to login:  ("+b+" "+a.status+") "+a.responseText)},timeout:1e3*currentConfig.downloadTimeout})
}function updateNavigationButtons(){var a=MyAnswers.device.persistentStorage;MyAnswers.dispatch.add(function(){try{var b,c,d,e,f=$(".navBar"),g=$("#homeButton, #backButton"),h=$("#helpButton"),i=$("#pendingButton"),j=siteVars.hasLogin,k=window.isHome(),l=k||MyAnswers.isEmptySpace||MyAnswers.isLoginOnly;
switch($(".view:visible").first().attr("id")){case"keywordView":case"answerView":case"answerView2":currentInteraction&&(b=siteVars.config["i"+currentInteraction].pertinent.help);
break;case"helpView":b=null;break;default:b=siteVars.config["a"+siteVars.id]}c="string"==typeof b,c?(h.show(),h.removeAttr("disabled")):h.hide(),e=i.length>0&&l?countPendingForms():!0,$.when(e).always(function(a){"number"!=typeof a&&(a=0),d=l&&!j&&!c&&!a,d?f.hide():l?(f.show(),g.hide()):(g.show(),g.prop("disabled",!1),f.show())
}),$("#loginButton, #logoutButton, #pendingButton").removeAttr("disabled"),a&&k&&"pending"!==MyAnswers.dfrdMoJOs.state()&&processMoJOs(),MyAnswers.dispatch.add(function(){$(window).trigger("scroll")
}),MyAnswers.sideBar&&MyAnswers.sideBar.update()}catch(m){error("Error in updateNavigationButtons..."),error(m)
}})}function initialiseAnswerFeatures(a){log("initialiseAnswerFeatures(): view="+a.attr("id"));
var b,c=new $.Deferred,d=[],e="string"===$.type(currentInteraction)?currentInteraction:String(currentInteraction),f="string"===$.type(currentConfig.loginPromptInteraction)?currentConfig.loginPromptInteraction:String(currentConfig.loginPromptInteraction);
return currentConfig.loginAccess&&currentConfig.loginUseInteractions&&f===e&&(b=MyAnswers.isLoggedIn,$.when(requestLoginStatus()).always(function(){MyAnswers.isLoggedIn!==b&&(MyAnswers.isLoggedIn?$.when(window.requestConfig()).always(function(){siteVars.map&&siteVars.config?(window.processConfig(),window.updateNavigationButtons(),currentConfig.loginToDefaultScreen&&MyAnswers.gotoDefaultScreen()):BMP.alert("error: insufficient data, check network and reload / refresh")
}):window.location.reload())})),MyAnswers.dispatch.add(function(){var b=a.find("input, textarea, select"),c=a.find("form").first(),e=window.google&&window.google.maps&&window.google.maps.Map;
MyAnswers.$body.trigger("taskBegun"),b.off("blur",triggerScroll),b.on("blur",triggerScroll),MyAnswers.device.persistentStorage&&a.find(".blink-starrable").each(function(a,b){var c=$('<div class="blink-starrable" />'),d=$(b).data();
populateDataTags(c,d),c.on("click",onStarClick),c.addClass("object"!==$.type(starsProfile[$(b).data("type")])||"object"!==$.type(starsProfile[$(b).data("type")][$(b).data("id")])?"blink-star-off":"blink-star-on"),$(b).replaceWith(c)
}),a.find("div.googlemap").length>0&&(e?setTimeout(function(){MyAnswers.setupGoogleMaps(a)
},1e3):(MyAnswers.dfrdGoogleMaps=new $.Deferred,$.getCachedScript("//maps.googleapis.com/maps/api/js?key="+_Blink.cfg.GOOGLE_API_KEY+"&v=3&sensor=true&callback=MyAnswers.onGoogleMapsLoad").fail(function(){throw"unable to download Google Maps JavaScript library"
}).then(function(){$.when(MyAnswers.dfrdGoogleMaps.promise()).fail(function(){log("initialiseAnswerFeatures() error: unable to initialise Google Maps API")
}).then(function(){delete window.onGoogleMapsLoad,delete MyAnswers.dfrdGoogleMaps,MyAnswers.setupGoogleMaps(a)
})}))),0!==c.length&&"string"==typeof c.data("objectName")&&c.data("objectName").length>0&&$.when(MyAnswers.formsDeferred.promise()).always(function(){d.push(BlinkForms.initialiseForm(c))
})}),MyAnswers.dispatch.add(function(){$.when.apply($,d).always(function(){MyAnswers.$body.trigger("taskComplete"),c.resolve(),a.trigger("viewReady")
})}),c.promise()}function updateCurrentConfig(){var a,b=[],c=_.clone(deviceVars.features),d=-1!==$.inArray("portrait",deviceVars.features)&&-1!==$.inArray("landscape",deviceVars.features),e="a"+siteVars.id,f="m"+currentMasterCategory,g="c"+currentCategory,h="i"+currentInteraction,i=function(a){var b,d,e,f,g,h,i=a.split("+"),j=i.length;
for(b=0;j>b;b++){if(d=i[b].split("|"),f=d.length,g=!0,h=!1,-1!==i[b].indexOf("|")){for(e=0;f>e;e++)if(-1!==$.inArray(d[e],c)){h=!0;
break}h||(g=!1)}else-1===$.inArray(i[b],c)&&(g=!1);if(!g)return null}return a},j=function(a){return a&&"string"==typeof a&&-1!==a.indexOf("+")?a.match(/\+/g).length:0
},k=function(c,d){b.push(a[d])};log("updateCurrentConfig(): "+e+" "+f+" "+g+" "+h),currentConfig={},b.push(currentConfig),d&&(c=_.without(c,"portrait","landscape"),c.push(MyAnswers.orientation)),$.each([e,f,g,h],function(c,d){var e,f;
a=siteVars.config[d],a&&$.isObject(a)&&(e=_.keys(a),f=1===e.length&&"pertinent"===e[0],f?b.push(a.pertinent):(b.push(a.pertinent),e=$.map(e,i),e=_.sortBy(e,j),$.each(e,k)))
}),$.extend.apply(this,b),currentConfig.logoBanner&&(currentConfig.logoBanner=siteVars.cdnu.getURL(currentConfig.logoBanner)),currentConfig.splashImage&&(currentConfig.splashImage=siteVars.cdnu.getURL(currentConfig.splashImage)),currentConfig.icon&&(currentConfig.icon=siteVars.cdnu.getURL(currentConfig.icon)),MyAnswers.dispatch.add(function(){var a=$("#bannerBox"),b=a.find("img"),c=currentConfig.logoBanner;
"string"==typeof currentConfig.logoBanner?(c!==b.attr("src")&&b.attr("src",c),a.show()):(b.removeAttr("src"),a.hide())
}),MyAnswers.dispatch.add(function(){MyAnswers.$footer.html()!==currentConfig.footer&&MyAnswers.$footer.html(currentConfig.footer),"screen-bottom"===currentConfig.footerPosition?MyAnswers.$footer.css({position:"fixed",bottom:"0px","z-index":1}):MyAnswers.$footer.removeAttr("style")
}),MyAnswers.dispatch.add(function(){var a="",b=$('style[data-setting="styleSheet"]');
a+=currentConfig.styleSheet||"",a+=currentConfig.interfaceStyle?"body { "+currentConfig.interfaceStyle+" }\n":"",a+=currentConfig.backgroundStyle?".box { "+currentConfig.backgroundStyle+" }\n":"",a+=currentConfig.inputPromptStyle?"#argsBox { "+currentConfig.inputPromptStyle+" }\n":"",a+=currentConfig.evenRowStyle?"ul.box > li:nth-child(even), tr.even { "+currentConfig.evenRowStyle+" }\n":"",a+=currentConfig.oddRowStyle?"ul.box > li:nth-child(odd), tr.odd { "+currentConfig.oddRowStyle+" }\n":"",a+=currentConfig.headerStyle?"body > header { "+currentConfig.headerStyle+" }\n":"",a+=currentConfig.footerStyle?"body > footer { "+currentConfig.footerStyle+" }\n":"",a+=currentConfig.masterCategoriesStyle?"#masterCategoriesBox > .masterCategory { "+currentConfig.masterCategoriesStyle+" }\n":"",a+=currentConfig.categoriesStyle?"#categoriesBox > .category { "+currentConfig.categoriesStyle+" }\n":"",a+=currentConfig.interactionsStyle?"#keywordBox > .interaction, #keywordList > .interaction { "+currentConfig.interactionsStyle+" }\n":"",b.length&&(b[0].styleSheet?a!==b[0].styleSheet.cssText&&(b[0].styleSheet.cssText=a):a!==b.text()&&b.text(a))
}),MyAnswers.dispatch.add(function(){var a,b=$(".view:visible").last();try{if(b.hasClass("listing")){switch(b.attr("id")){case"masterCategoriesView":a="masterCategories";
break;case"categoriesView":a="categories";break;default:a="interactions"}MyAnswers.populateItemListing(a,b)
}}catch(c){c("Error in updateCurrentConfig...")}})}function showMasterCategoriesView(a){var b=$("#masterCategoriesView");
log("showMasterCategoriesView()"),currentInteraction=null,currentCategory=null,currentMasterCategory=null,$.when(MyAnswersDevice.prepareView(b,a)).always(function(){MyAnswers.populateItemListing("masterCategories",b),updateCurrentConfig(),setMainLabel("Master Categories"),MyAnswersDevice.showView(b,a)
})}function goBackToMasterCategoriesView(){var a=$("#masterCategoriesView");log("goBackToMasterCategoriesView()"),$.when(MyAnswersDevice.prepareView(a,!0)).always(function(){updateCurrentConfig(),setMainLabel("Master Categories"),MyAnswersDevice.showView($("#masterCategoriesView"),!0)
})}function showCategoriesView(a){var b=$("#categoriesView");log("showCategoriesView(): "+a),currentInteraction=null,currentCategory=null,hasMasterCategories&&a&&(currentMasterCategory=a),$.when(MyAnswersDevice.prepareView(b)).always(function(){updateCurrentConfig(),setMainLabel(a?siteVars.config["m"+a].pertinent.name:"Categories"),MyAnswers.populateItemListing("categories",b),MyAnswersDevice.showView(b)
})}function goBackToCategoriesView(){var a=$("#categoriesView");currentInteraction=null,currentCategory=null,log("goBackToCategoriesView()"),$.when(MyAnswersDevice.prepareView(a,!0)).always(function(){updateCurrentConfig(),setMainLabel(currentMasterCategory?siteVars.config["m"+currentMasterCategory].pertinent.name:"Categories"),MyAnswersDevice.showView(a,!0)
})}function processFormsMap(a){var b,c,d={};return eachElement=function(a,b){var e=$(b);
d[c][e.attr("id")]=e.attr("object")},!a instanceof jQuery||!a.length?{}:(a.children("formObject[id]").each(function(a,e){b=$(e),c=b.attr("id"),d[c]={},b.children("formElement[id][object]").each(eachElement)
}),d)}function processForms(){var a,b=new BlinkDispatch(0),c=new $.Deferred,d=new $.Deferred,e=["add","delete","edit","find","list","search","view"],f=function(a,c){var d=new $.Deferred;
return b.add(function(){var b,f,g=$(c),h=g.tag(),i="formXML:"+a+":"+h,j=g.children(),k=j.length,l="";
if(-1!==e.indexOf(g.tag())){for(b=0;k>b;b++)f=_Blink.stringifyDOM(j[b]),f&&(l+=f);
$.when(MyAnswers.store.set(i,l)).fail(function(){warn("processForms()->formActionFn(): failed storing "+i),d.reject()
}).then(function(){MyAnswers.store.set("formLastChecked:"+a+":"+h,$.now()),MyAnswers.isDebug&&log("processForms()->formActionFn(): formXML="+i),d.resolve()
})}else d.resolve()}),d.promise()},g=function(b,c){var d=$(c);"_map"===d.tag()?siteVars.map.forms=processFormsMap(d):d.children().each(function(b,c){a.push(f(d.attr("id"),c))
})};d=window.BlinkForms&&window.BlinkFormObject&&window.BlinkFormElement?!0:$.getCachedScript("/_R_/forms2/forms2.min.js"),a=[d],MyAnswers.device.persistentStorage&&(a.push(c.promise()),deviceVars.isOnline?$.ajax({url:"/_R_/xhr-forms/GetForm.php",dataType:"xml",complete:function(a){var b;
200===a.status&&"string"==typeof a.responseText&&(a.responseText=a.responseText.substring(a.responseText.indexOf("<formObjects>")),b=$($.parseXML(a.responseText)),b.children().children().each(g)),200===a.status||304===a.status?c.resolve():(warn("processForms()->GetForm.XHR: failed "+a.status),c.reject())
},timeout:Math.max(1e3*currentConfig.downloadTimeout,computeTimeout(512e3))}):c.resolve()),$.whenArray(a).fail(MyAnswers.formsDeferred.reject).then(MyAnswers.formsDeferred.resolve)
}function processConfig(){var a,b;MyAnswers.isEmptySpace=!1,MyAnswers.isLoginOnly=!1,log("processConfig(): currentMasterCategory="+currentMasterCategory+" currentCategory="+currentCategory+" currentInteraction="+currentInteraction),"object"===$.type(siteVars.config["a"+siteVars.id])?(b=siteVars.config["a"+siteVars.id].pertinent,a=b.siteStructure,"master categories"===a&&(hasMasterCategories=siteVars.map.masterCategories.length>0),"interactions only"!==a&&(hasCategories=siteVars.map.categories.length>0),hasInteractions=siteVars.map.interactions.length>0,answerSpaceOneKeyword=1===siteVars.map.interactions.length,b.loginAccess&&b.loginUseInteractions&&b.loginPromptInteraction&&b.loginStatusInteraction&&siteVars.config["i"+b.loginPromptInteraction]&&siteVars.config["i"+b.loginStatusInteraction]&&(MyAnswers.isCustomLogin=!0),siteVars.map&&0===siteVars.map.masterCategories.length&&0===siteVars.map.categories.length&&siteVars.map.interactions.length===(MyAnswers.isCustomLogin?2:0)&&(MyAnswers.isEmptySpace=!0),b.loginAccess&&!MyAnswers.isLoggedIn&&("deny anonymous"===b.registeredOnly||MyAnswers.isEmptySpace)&&(MyAnswers.isLoginOnly=!0)):log("processConfig(): unable to retrieve answerSpace config"),processForms()
}function requestConfig(){var a=($.now(),new $.Deferred),b=MyAnswers.device.persistentStorage,c="/_R_/xhr/GetConfig.php";
return deviceVars.isOnline?(c+="?_asn="+siteVars.answerSpace,MyAnswers.isLoggedIn&&"object"===$.type(MyAnswers.loginAccount)&&(c+="&_username="+MyAnswers.loginAccount.username),$.ajax({url:c,type:"POST",dataType:"json",timeout:computeTimeout(40960),complete:function(c){var d,e,f=["a"+siteVars.id];
200===c.status&&(d=$.parseJSON(c.responseText),"object"===$.type(d.map)&&(siteVars.map=d.map,b&&MyAnswers.siteStore.set("map",JSON.stringify(siteVars.map))),"object"===$.type(d["a"+siteVars.id])&&(e=d["a"+siteVars.id].pertinent.siteStructure,siteVars.cdnu=new _Blink.AnswerSpaceCDN(d["a"+siteVars.id].pertinent.cdnLocation)),siteVars.map&&("master categories"===e&&siteVars.map.masterCategories.length>0&&(f=f.concat($.map(siteVars.map.masterCategories,function(a){return"m"+a
}))),"interactions only"!==e&&siteVars.map.categories.length>0&&(f=f.concat($.map(siteVars.map.categories,function(a){return"c"+a
}))),siteVars.map.interactions.length>0&&(f=f.concat($.map(siteVars.map.interactions,function(a){return"i"+a
}))))),d&&(("object"!==$.type(siteVars.config)||f.length>0)&&(siteVars.config={}),$.each(f,function(a,b){"object"===$.type(d[b])&&(siteVars.config[b]=d[b])
}),b&&MyAnswers.siteStore.set("config",JSON.stringify(siteVars.config)),deviceVars.features=d.deviceFeatures),200===c.status||304===c.status||0===c.status?a.resolve():a.reject()
}}),a.promise()):(a.reject(),a.promise())}function gotoStorageView(){var a,b;if(currentConfig.activeFormsUseInteraction){if(a=siteVars.config["i"+currentConfig.activeFormsInteraction],"object"!==$.type(a))return void BMP.alert("Interaction for active forms listing could not be found.");
b="/"+siteVars.answerSpace+"/"+a.pertinent.name+"/?",History.pushState({i:currentConfig.activeFormsInteraction},null,b)
}else b="/"+siteVars.answerSpace+"/?_storage=true",History.pushState({storage:!0},null,b)
}function showPendingView(){var a=$("#pendingView"),b=$("#pendingBox"),c=b.children("[data-blink-form-version=2]"),d=b.children("[data-blink-form-version=1]"),e=b.children(".bForm-noPending");
$.when(MyAnswers.pendingStore.keys(),MyAnswers.pendingV1Store.keys()).then(function(b,f){var g=(b.length+f.length,function(a,b,c){var d,e=c.data("blinkFormVersion"),f=c.children(".template"),g=f.clone(),h=b.split(":"),i=siteVars.config["i"+h[0]],j=i?i.pertinent.displayName||i.pertinent.name:"* unknown *",k=h[1],l=h[2];
g.children("h3").text(j),g.children("pre.uuid").text(l),g.attr("data-id",b),2===e&&$.when(MyAnswers.pendingStore.get(b)).then(function(a){"string"==typeof a&&0!==a.length&&("object"!==$.type(a)&&(a=$.parseJSON(a)),"array"===$.type(a)&&(d=g.children("dl"),$.each(a[1],function(a,b){d.append("<dt>"+a+"</dt><dd>"+b+"</dd>")
})))}),g.data("interaction",h[0]),g.data("form",k),MyAnswers.dispatch.add(function(){g.appendTo(c),g.show().removeClass("template")
})});MyAnswers.dispatch.add(function(){c.children(".bForm-pending:not(.template)").remove(),b.length>0?($.each(b,function(a,b){g(a,b,c)
}),c.show()):c.hide(),d.children(".bForm-pending:not(.template)").remove(),f.length>0?($.each(f,function(a,b){g(a,b,d)
}),d.show()):d.hide(),f.length+b.length>0?e.hide():e.show()}),MyAnswers.dispatch.add(function(){$.when(MyAnswersDevice.prepareView(a)).always(function(){MyAnswersDevice.showView(a)
})})})}function createParamsAndArgs(a){var b=siteVars.config["i"+a],c="asn="+siteVars.answerSpace+"&iact="+encodeURIComponent(b.pertinent.name),d="",e=$("#argsBox").find("input, textarea, select");
return b&&b.pertinent.inputPrompt?(d="",e.each(function(){!this.type||"radio"!==this.type.toLowerCase()&&"checkbox"!==this.type.toLowerCase()||this.checked?this.name?d+="&"+this.name+"="+(this.value?encodeURIComponent(this.value):""):this.id&&this.id.match(/\d+/g)&&(d+="&args["+this.id.match(/\d+/g)+"]="+(this.value?encodeURIComponent(this.value):"")):$.noop()
}),d.length>0?c+=encodeURI(d):1===e.length&&this.value&&(c+="&args="+encodeURIComponent(this.value)),c):c
}function showAnswerView(a,b,c){log("showAnswerView(): interaction="+a+" args="+b);
var d,e,f=$("#answerView"),g=$("#answerBox"),h=g[0],i=function(){$.when(initialiseAnswerFeatures(f)).always(function(){setMainLabel(currentConfig.displayName||currentConfig.name),MyAnswersDevice.showView(f,c),MyAnswers.dispatch.add(function(){MyAnswers.$body.trigger("taskComplete")
})})},j=MyAnswers.device.persistentStorage,k=!deviceVars.disableXSLT&&j;return a=resolveItemName(a),a===!1?void BMP.alert("The requested Interaction could not be found."):(MyAnswers.$body.trigger("taskBegun"),void $.when(MyAnswersDevice.prepareView(f,c)).always(function(){if(currentInteraction=a,updateCurrentConfig(),"string"==typeof currentConfig.xml&&"stars:"!==currentConfig.xml.substring(0,6)&&"server-hosted"===currentConfig.mojoType&&"pending"!==MyAnswers.dfrdMoJOs.state()&&requestMoJO(currentConfig.xml),"string"==typeof b&&b.length>0?(e={},$.extend(e,deserialize(b))):e="object"===$.type(b)?b:{},currentConfig.inputPrompt&&!b&&($.extend(e,deserialize(createParamsAndArgs(a))),delete e.answerSpace,delete e.interaction),"hyperlink"===currentConfig.type)window.open(currentConfig.hyperlink,currentConfig.hyperlinkTarget);
else if("message"===currentConfig.type)insertHTML(h,currentConfig.message),i();else if("xslt"===currentConfig.type&&k)$.when(MyAnswers.dfrdMoJOs).always(function(){$.when(generateMojoAnswer(e)).always(function(a){insertHTML(h,a),i()
})});else if(c&&j)$.when(MyAnswers.store.get("answer___"+a)).done(function(a){insertHTML(h,a),i()
});else if("form"===currentConfig.type&&currentConfig.blinkFormObjectName&&currentConfig.blinkFormAction)$.when(MyAnswers.dfrdMoJOs,MyAnswers.formsDeferred.promise()).fail(function(){d="<p>Error: forms Interactions are currently unavailable. Reload the application and try again.</p>"
}).then(function(){d=$('<form data-object-name="'+currentConfig.blinkFormObjectName+'" novalidate="novalidate" data-action="'+currentConfig.blinkFormAction+'" />'),d.data(e)
}).always(function(){insertHTML(h,d),i()});else{var f="/_R_/xhr/GetAnswer.php",g={asn:siteVars.answerSpace,iact:currentConfig.name},l=function(){j?$.when(MyAnswers.store.get("answer___"+a)).done(function(a){a||(a="<p>Unable to reach server, and unable to display previously stored content.</p>"),insertHTML(h,a),i()
}):(d="<p>Unable to reach server.</p>",insertHTML(h,d),i())},m={},n={},o="GET";$.isEmptyObject(e)||$.extend(g,e),g._submitStarsType&&(o="POST","string"===$.type(g._submitStarsType)&&(g._submitStarsType=[g._submitStarsType]),"array"===$.type(g._submitStarsType)&&$.each(g._submitStarsType,function(a,b){n[b]=starsProfile[b]||{}
}),m[g._submitStarsPost||"stars"]=n,delete g._submitStarsPost,delete g._submitStarsType,f+="?"+$.param(g),g=m),$.ajax({type:o,url:f,data:g,complete:function(b,c){if("timeout"===c)insertHTML(h,"Error: the server has taken too long to respond.  ("+c+" "+b.status+")"),i();
else if(isAJAXError(c)||200!==b.status)l();else{log("GetAnswer: storing server response"),d=b.responseText;
var e,f,g=d.match(/<!-- blinkAnswerMessage:\{.*\} -->/g);if("array"===$.type(g))for(f=g.length,e=0;f>e;e++)processBlinkAnswerMessage(g[e].substring(24,g[e].length-4));
j&&MyAnswers.store.set("answer___"+a,d),insertHTML(h,d),i()}},timeout:Math.max(1e3*currentConfig.downloadTimeout,6e4)})
}}))}function getAnswer(){var a,b,c,d=resolveItemName(currentInteraction,"interactions");
d&&(b=deserialize(createParamsAndArgs(currentInteraction)),delete b.asn,delete b.iact,c=$.param(b),a="/"+siteVars.answerSpace+"/"+siteVars.config["i"+d].pertinent.name+"/?"+c,History.pushState({m:currentMasterCategory,c:currentCategory,i:d,arguments:b},null,a))
}function showKeywordView(a){var b=$("#keywordView");$.when(MyAnswersDevice.prepareView(b)).always(function(){var c=siteVars.config["i"+a].pertinent,d=$("#argsBox")[0];
currentInteraction=a,updateCurrentConfig(),insertHTML(d,c.inputPrompt),MyAnswersDevice.showView(b),setMainLabel(c.displayName||c.name)
})}function goBackToKeywordView(a){var b=$("#keywordView");$.when(MyAnswersDevice.prepareView(b,!0)).always(function(){var c=siteVars.config["i"+a].pertinent;
currentInteraction=a,updateCurrentConfig(),MyAnswersDevice.showView(b,!0),setMainLabel(c.displayName||c.name)
})}function gotoNextScreen(a,b,c){{var d;siteVars.map.interactions.length}return log("gotoNextScreen(): "+a),a=resolveItemName(a),a===!1?void BMP.alert("The requested Interaction could not be found."):(d=siteVars.config["i"+a],hasMasterCategories&&c&&(currentMasterCategory=c),hasCategories&&b&&(currentCategory=b),currentInteraction=a,void(d.pertinent.inputPrompt?showKeywordView(a):showAnswerView(a)))
}function showSecondLevelAnswerView(a,b){var c,d=resolveItemName(a,"interactions");
log("showSecondLevelAnswerView(): keyword="+a+" args="+b),d&&(c="/"+siteVars.answerSpace+"/"+siteVars.config["i"+d].pertinent.name+"/?"+b,History.pushState({m:currentMasterCategory,c:currentCategory,i:d,arguments:deserialize(b)},null,c))
}function showKeywordListView(a,b){var c,d=$("#keywordListView");currentInteraction=null,currentCategory=a,hasMasterCategories&&b&&(currentMasterCategory=b),log("showKeywordListView(): hasCategories="+hasCategories+" currentCategory="+currentCategory),$.when(MyAnswersDevice.prepareView(d)).always(function(){updateCurrentConfig(),hasCategories?("function"==typeof prepareHistorySideBar&&prepareHistorySideBar(),c=currentConfig.displayName||currentConfig.name):c="Interactions",MyAnswers.populateItemListing("interactions",d),MyAnswersDevice.showView(d),setMainLabel(c)
})}function goBackToKeywordListView(){var a,b,c=$("#keywordListView");return currentInteraction=null,answerSpaceOneKeyword?void showKeywordView(0):hasMasterCategories&&null===currentMasterCategory?void goBackToMasterCategoriesView():hasCategories&&null===currentCategory?void goBackToCategoriesView(hasMasterCategories?currentCategory:null):(hasCategories?(b=siteVars.config["c"+currentCategory].pertinent,a=b.displayName||b.name):a="Interactions",void $.when(MyAnswersDevice.prepareView(c,!0)).always(function(){updateCurrentConfig(),MyAnswersDevice.showView(c,!0),setMainLabel(a)
}))}function showHelpView(){var a,b=document.getElementById("helpBox"),c=$("#helpView");
$.when(MyAnswersDevice.prepareView(c)).always(function(){switch($(".view:visible").first().attr("id")){case"keywordView":case"answerView":case"answerView2":currentInteraction&&(a=siteVars.config["i"+currentInteraction].pertinent.help||"Sorry, no guidance has been prepared for this item.");
break;default:a=siteVars.config["a"+siteVars.id].pertinent.help||"Sorry, no guidance has been prepared for this item."
}insertHTML(b,a),MyAnswersDevice.showView(c)})}function goBackToTopLevelAnswerView(){var a=$("#answerView");
log("goBackToTopLevelAnswerView()"),$.when(MyAnswersDevice.prepareView(a,!0)).always(function(){MyAnswersDevice.showView(a,!0)
})}function submitFormWithRetry(a){var b,c,d,e,f,g,h="/_R_/xhr/GetAnswer.php?",i=$(".view:visible"),j=i.children(".box").first();
"object"===$.type(a)?(b=a.data,c=a.action.split("/"),d=a.method,e=a.uuid,".."===c[0]?(h+="asn="+siteVars.answerSpace+"&iact="+encodeURIComponent(c[1])+(c[2].length>1?"&"+c[2].substring(1):""),f=c[1]):(h+="asn="+c[1]+"&iact="+encodeURIComponent(c[2]),f=c[2]),"GET"===d?g="&"+b:(d="POST",g=b),MyAnswers.$body.trigger("taskBegun"),$.ajax({type:d,cache:"false",url:h,data:g,complete:function(b,c){var d;
isAJAXError(c)||200!==b.status?d="Unable to contact server. Your submission has been stored for future attempts.  ("+c+" "+b.status+")":(MyAnswers.device.persistentStorage&&clearPendingFormV1(a.interaction,e),d=b.responseText),$.when(MyAnswersDevice.prepareView(i)).always(function(){insertHTML(j[0],d),$.when(initialiseAnswerFeatures(j)).always(function(){MyAnswersDevice.showView(i)
}),MyAnswers.$body.trigger("taskComplete")})},timeout:Math.max(1e3*currentConfig.uploadTimeout,computeTimeout(h.length+g.length))})):log("submitFormWithRetry(): error: no forms in the queue")
}function submitForm(){var a,b="",c=$(".view:visible").find("form").first(),d=c.attr("action"),e=c.attr("method"),f=Math.uuid();
return c.find("input, textarea, select").each(function(a,c){c.name&&(!c.type||"radio"!==c.type.toLowerCase()&&"checkbox"!==c.type.toLowerCase()||c.checked!==!1?b+=c.type&&"button"===c.type.toLowerCase()?"&"+c.name+"=":"&"+c.name+"="+encodeURIComponent(c.value):$.noop())
}),log("submitForm(2): "+document.forms[0].action),a={data:b,action:d,method:"string"===$.type(e)?e.toUpperCase():"post",uuid:f,interaction:currentInteraction},MyAnswers.device.persistentStorage?$.when(pushPendingFormV1(currentInteraction,f,a)).fail(function(){BMP.alert("Error: unable to feed submission through queue.")
}).then(submitFormWithRetry):submitFormWithRetry(a),!1}function submitAction(a,b){log("submitAction(): keyword="+a+" action="+b);
var c,d,e,f=$(".view:visible,"),g=f.children(".box"),h=g.find("form").first(),i=h.find("input[type=submit]"),j=h.find("input[name=blink_session_data]"),k="cancel=Cancel"===b?"":h.find("input, textarea, select").serialize(),l=h.attr("method");
return 1===i.length&&i.attr("name")&&i.val()&&(k+="&"+i.attr("name")+"="+i.val()),1!==j.length||$.isEmptyObject(starsProfile)||(e='{"stars":'+JSON.stringify(starsProfile)+"}",k=k.replace("blink_session_data=","blink_session_data="+encodeURIComponent(e)),l="post"),"string"===$.type(l)&&"get"===l.toLowerCase()?(l="GET",d="/_R_/xhr/GetAnswer.php?asn="+siteVars.answerSpace+"&iact="+a,c="&"+k+("string"==typeof b&&b.length>0?"&"+b:"")):(l="POST",d="/_R_/xhr/GetAnswer.php?asn="+siteVars.answerSpace+"&iact="+a+("string"==typeof b&&b.length>0?"&"+b:""),c=k),MyAnswers.$body.trigger("taskBegun"),$.ajax({type:l,cache:"false",url:d,data:c,complete:function(a,b){var c,d,e,h;
if(c=isAJAXError(b)||200!==a.status?"Unable to contact server.":a.responseText,h=c.match(/<!-- blinkAnswerMessage:\{.*\} -->/g),"array"===$.type(h))for(e=h.length,d=0;e>d;d++)processBlinkAnswerMessage(h[d].substring(24,h[d].length-4));
$.when(MyAnswersDevice.prepareView(f)).always(function(){insertHTML(g[0],c),$.when(initialiseAnswerFeatures(g)).always(function(){MyAnswersDevice.showView(f)
}),MyAnswers.$body.trigger("taskComplete")})},timeout:Math.max(1e3*currentConfig.downloadTimeout,computeTimeout(d.length+c.length))}),!1
}Object.create||(Object.create=function(a,b){"use strict";function c(){return this
}var d;if(null===a)throw new TypeError("Object.create(null) is a sham in this implementation");
if("object"!=typeof a&&"function"!=typeof a)throw new TypeError("Object prototype may only be an Object or null");
if(c.prototype=a,d=new c,void 0!==b)throw new TypeError("Object.create(prototype, properties) is a sham in this implementation");
return d});var Hashtable=function(){function a(b){var c;if("string"==typeof b)return b;
if(typeof b.hashCode==k)return c=b.hashCode(),"string"==typeof c?c:a(c);if(typeof b.toString==k)return b.toString();
try{return String(b)}catch(d){return Object.prototype.toString.call(b)}}function b(a,b){return a.equals(b)
}function c(a,b){return typeof b.equals==k?b.equals(a):a===b}function d(a){return function(b){if(null===b)throw new Error("null is not a valid "+a);
if("undefined"==typeof b)throw new Error(a+" must not be undefined")}}function e(a,b,c,d){this[0]=a,this.entries=[],this.addEntry(b,c),null!==d&&(this.getEqualityFunction=function(){return d
})}function f(a){return function(b){for(var c,d=this.entries.length,e=this.getEqualityFunction(b);d--;)if(c=this.entries[d],e(b,c[0]))switch(a){case o:return!0;
case p:return c;case q:return[d,c[1]]}return!1}}function g(a){return function(b){for(var c=b.length,d=0,e=this.entries.length;e>d;++d)b[c+d]=this.entries[d][a]
}}function h(a,b){for(var c,d=a.length;d--;)if(c=a[d],b===c[0])return d;return null
}function i(a,b){var c=a[b];return c&&c instanceof e?c:null}function j(b,c){var d=this,f=[],g={},o=typeof b==k?b:a,p=typeof c==k?c:null;
this.put=function(a,b){m(a),n(b);var c,d,h=o(a),j=null;return c=i(g,h),c?(d=c.getEntryForKey(a),d?(j=d[1],d[1]=b):c.addEntry(a,b)):(c=new e(h,a,b,p),f[f.length]=c,g[h]=c),j
},this.get=function(a){m(a);var b=o(a),c=i(g,b);if(c){var d=c.getEntryForKey(a);if(d)return d[1]
}return null},this.containsKey=function(a){m(a);var b=o(a),c=i(g,b);return c?c.containsKey(a):!1
},this.containsValue=function(a){n(a);for(var b=f.length;b--;)if(f[b].containsValue(a))return!0;
return!1},this.clear=function(){f.length=0,g={}},this.isEmpty=function(){return!f.length
};var q=function(a){return function(){for(var b=[],c=f.length;c--;)f[c][a](b);return b
}};this.keys=q("keys"),this.values=q("values"),this.entries=q("getEntries"),this.remove=function(a){m(a);
var b,c=o(a),d=null,e=i(g,c);return e&&(d=e.removeEntryForKey(a),null!==d&&(e.entries.length||(b=h(f,c),l(f,b),delete g[c]))),d
},this.size=function(){for(var a=0,b=f.length;b--;)a+=f[b].entries.length;return a
},this.each=function(a){for(var b,c=d.entries(),e=c.length;e--;)b=c[e],a(b[0],b[1])
},this.putAll=function(a,b){for(var c,e,f,g,h=a.entries(),i=h.length,j=typeof b==k;i--;)c=h[i],e=c[0],f=c[1],j&&(g=d.get(e))&&(f=b(e,g,f)),d.put(e,f)
},this.clone=function(){var a=new j(b,c);return a.putAll(d),a}}var k="function",l=typeof Array.prototype.splice==k?function(a,b){a.splice(b,1)
}:function(a,b){var c,d,e;if(b===a.length-1)a.length=b;else for(c=a.slice(b+1),a.length=b,d=0,e=c.length;e>d;++d)a[b+d]=c[d]
},m=d("key"),n=d("value"),o=0,p=1,q=2;return e.prototype={getEqualityFunction:function(a){return typeof a.equals==k?b:c
},getEntryForKey:f(p),getEntryAndIndexForKey:f(q),removeEntryForKey:function(a){var b=this.getEntryAndIndexForKey(a);
return b?(l(this.entries,b[0]),b[1]):null},addEntry:function(a,b){this.entries[this.entries.length]=[a,b]
},keys:g(0),values:g(1),getEntries:function(a){for(var b=a.length,c=0,d=this.entries.length;d>c;++c)a[b+c]=this.entries[c].slice(0)
},containsKey:f(o),containsValue:function(a){for(var b=this.entries.length;b--;)if(a===this.entries[b][1])return!0;
return!1}},j}();(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)
};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.2";
var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);
else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return
}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return
};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))
}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;
if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);
if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);
return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);
var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)
}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0
}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)
}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)
},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c
}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0
}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b
})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)
})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;
return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);
if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;
g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);
if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;
g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];
return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return arguments.length<2||c?a[x.random(a.length-1)]:x.shuffle(a).slice(0,Math.max(0,b))
};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);
return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}
}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;
if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={},f=null==c?x.identity:B(c);
return y(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};x.groupBy=C(function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)
}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1
}),x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;
c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]
},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length
},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)
},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))
},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)
};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)
}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))
},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];
return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))
}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);
return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0
})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)
})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);
return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];
return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;
d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;
return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);
for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;
for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f
};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));
if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));
E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));
return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))
}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");
return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};
return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)
}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)
},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))
},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)
};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f
}},x.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;
var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))
},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},x.once=function(a){var b,c=!1;
return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];
return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;
return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];
return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0
}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];
for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];
return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];
return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];
return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);
return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]
}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])
}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);
return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])
}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a
},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;
if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);
var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);
case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;
case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase
}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;
var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;
c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;
if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])
},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;
for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)
},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)
},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"
}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))
}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))
},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)
},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a
},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this
},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);
return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))
};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);
var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};
x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]
})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c
},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];
return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";
return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};
var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;
x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";
a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]
}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b
}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";
try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);
var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i
},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a
};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];
x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)
}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))
}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped
}})}).call(this),function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.returnExports=b()
}(this,function(){function a(){}function b(a){return a=+a,a!==a?a=0:0!==a&&a!==1/0&&a!==-(1/0)&&(a=(a>0||-1)*Math.floor(Math.abs(a))),a
}function c(a){var b=typeof a;return null===a||"undefined"===b||"boolean"===b||"number"===b||"string"===b
}function d(a){var b,d,e;if(c(a))return a;if(d=a.valueOf,l(d)&&(b=d.call(a),c(b)))return b;
if(e=a.toString,l(e)&&(b=e.call(a),c(b)))return b;throw new TypeError}var e=Function.prototype.call,f=Array.prototype,g=Object.prototype,h=f.slice,i=Array.prototype.splice,j=(Array.prototype.push,Array.prototype.unshift),k=g.toString,l=function(a){return"[object Function]"===g.toString.call(a)
},m=function(a){return"[object RegExp]"===g.toString.call(a)},n=function(a){return"[object Array]"===k.call(a)
},o=function(a){var b=k.call(a),c="[object Arguments]"===b;return c||(c=!n(b)&&null!==a&&"object"==typeof a&&"number"==typeof a.length&&a.length>=0&&l(a.callee)),c
};Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(!l(c))throw new TypeError("Function.prototype.bind called on incompatible "+c);
for(var d=h.call(arguments,1),e=function(){if(this instanceof j){var a=c.apply(this,d.concat(h.call(arguments)));
return Object(a)===a?a:this}return c.apply(b,d.concat(h.call(arguments)))},f=Math.max(0,c.length-d.length),g=[],i=0;f>i;i++)g.push("$"+i);
var j=Function("binder","return function ("+g.join(",")+"){return binder.apply(this,arguments)}")(e);
return c.prototype&&(a.prototype=c.prototype,j.prototype=new a,a.prototype=null),j
});var p,q,r,s,t,u=e.bind(g.hasOwnProperty);(t=u(g,"__defineGetter__"))&&(p=e.bind(g.__defineGetter__),q=e.bind(g.__defineSetter__),r=e.bind(g.__lookupGetter__),s=e.bind(g.__lookupSetter__));
var v=function(){var a={};return Array.prototype.splice.call(a,0,0,1),1===a.length
}(),w=0===[1].splice(0).length,x=function(){var a=[1,2],b=a.splice();return 2===a.length&&n(b)&&0===b.length
}();x&&(Array.prototype.splice=function(){return 0===arguments.length?[]:i.apply(this,arguments)
}),w&&v||(Array.prototype.splice=function(a,c){if(0===arguments.length)return[];var d=arguments;
return this.length=Math.max(b(this.length),0),arguments.length>0&&"number"!=typeof c&&(d=h.call(arguments),d.length<2?d.push(b(c)):d[1]=b(c)),i.apply(this,d)
}),1!==[].unshift(0)&&(Array.prototype.unshift=function(){return j.apply(this,arguments),this.length
}),Array.isArray||(Array.isArray=n);var y=Object("a"),z="a"!==y[0]||!(0 in y),A=function(a){var b=!0,c=!0;
return a&&(a.call("foo",function(a,c,d){"object"!=typeof d&&(b=!1)}),a.call([1],function(){"use strict";
c="string"==typeof this},"x")),!!a&&b&&c};Array.prototype.forEach&&A(Array.prototype.forEach)||(Array.prototype.forEach=function(a){var b=Y(this),c=z&&"[object String]"===k.call(this)?this.split(""):b,d=arguments[1],e=-1,f=c.length>>>0;
if(!l(a))throw new TypeError;for(;++e<f;)e in c&&a.call(d,c[e],e,b)}),Array.prototype.map&&A(Array.prototype.map)||(Array.prototype.map=function(a){var b=Y(this),c=z&&"[object String]"===k.call(this)?this.split(""):b,d=c.length>>>0,e=Array(d),f=arguments[1];
if(!l(a))throw new TypeError(a+" is not a function");for(var g=0;d>g;g++)g in c&&(e[g]=a.call(f,c[g],g,b));
return e}),Array.prototype.filter&&A(Array.prototype.filter)||(Array.prototype.filter=function(a){var b,c=Y(this),d=z&&"[object String]"===k.call(this)?this.split(""):c,e=d.length>>>0,f=[],g=arguments[1];
if(!l(a))throw new TypeError(a+" is not a function");for(var h=0;e>h;h++)h in d&&(b=d[h],a.call(g,b,h,c)&&f.push(b));
return f}),Array.prototype.every&&A(Array.prototype.every)||(Array.prototype.every=function(a){var b=Y(this),c=z&&"[object String]"===k.call(this)?this.split(""):b,d=c.length>>>0,e=arguments[1];
if(!l(a))throw new TypeError(a+" is not a function");for(var f=0;d>f;f++)if(f in c&&!a.call(e,c[f],f,b))return!1;
return!0}),Array.prototype.some&&A(Array.prototype.some)||(Array.prototype.some=function(a){var b=Y(this),c=z&&"[object String]"===k.call(this)?this.split(""):b,d=c.length>>>0,e=arguments[1];
if(!l(a))throw new TypeError(a+" is not a function");for(var f=0;d>f;f++)if(f in c&&a.call(e,c[f],f,b))return!0;
return!1});var B=!1;Array.prototype.reduce&&(B="object"==typeof Array.prototype.reduce.call("es5",function(a,b,c,d){return d
})),Array.prototype.reduce&&B||(Array.prototype.reduce=function(a){var b=Y(this),c=z&&"[object String]"===k.call(this)?this.split(""):b,d=c.length>>>0;
if(!l(a))throw new TypeError(a+" is not a function");if(!d&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");
var e,f=0;if(arguments.length>=2)e=arguments[1];else for(;;){if(f in c){e=c[f++];
break}if(++f>=d)throw new TypeError("reduce of empty array with no initial value")
}for(;d>f;f++)f in c&&(e=a.call(void 0,e,c[f],f,b));return e});var C=!1;Array.prototype.reduceRight&&(C="object"==typeof Array.prototype.reduceRight.call("es5",function(a,b,c,d){return d
})),Array.prototype.reduceRight&&C||(Array.prototype.reduceRight=function(a){var b=Y(this),c=z&&"[object String]"===k.call(this)?this.split(""):b,d=c.length>>>0;
if(!l(a))throw new TypeError(a+" is not a function");if(!d&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");
var e,f=d-1;if(arguments.length>=2)e=arguments[1];else for(;;){if(f in c){e=c[f--];
break}if(--f<0)throw new TypeError("reduceRight of empty array with no initial value")
}if(0>f)return e;do f in c&&(e=a.call(void 0,e,c[f],f,b));while(f--);return e}),Array.prototype.indexOf&&-1===[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(a){var c=z&&"[object String]"===k.call(this)?this.split(""):Y(this),d=c.length>>>0;
if(!d)return-1;var e=0;for(arguments.length>1&&(e=b(arguments[1])),e=e>=0?e:Math.max(0,d+e);d>e;e++)if(e in c&&c[e]===a)return e;
return-1}),Array.prototype.lastIndexOf&&-1===[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(a){var c=z&&"[object String]"===k.call(this)?this.split(""):Y(this),d=c.length>>>0;
if(!d)return-1;var e=d-1;for(arguments.length>1&&(e=Math.min(e,b(arguments[1]))),e=e>=0?e:d-Math.abs(e);e>=0;e--)if(e in c&&a===c[e])return e;
return-1});var D=Object.keys&&function(){return 2===Object.keys(arguments).length
}(1,2);if(Object.keys){if(!D){var E=Object.keys;Object.keys=function(a){return E(o(a)?Array.prototype.slice.call(a):a)
}}}else{var F=!{toString:null}.propertyIsEnumerable("toString"),G=function(){}.propertyIsEnumerable("prototype"),H=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],I=H.length;
Object.keys=function(a){var b=l(a),c=o(a),d=null!==a&&"object"==typeof a,e=d&&"[object String]"===k.call(a);
if(!d&&!b&&!c)throw new TypeError("Object.keys called on a non-object");var f=[],g=G&&b;
if(e||c)for(var h=0;h<a.length;++h)f.push(String(h));else for(var i in a)g&&"prototype"===i||!u(a,i)||f.push(String(i));
if(F)for(var j=a.constructor,m=j&&j.prototype===a,n=0;I>n;n++){var p=H[n];m&&"constructor"===p||!u(a,p)||f.push(p)
}return f}}var J=-621987552e5,K="-000001";Date.prototype.toISOString&&-1!==new Date(J).toISOString().indexOf(K)||(Date.prototype.toISOString=function(){var a,b,c,d,e;
if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");
for(d=this.getUTCFullYear(),e=this.getUTCMonth(),d+=Math.floor(e/12),e=(e%12+12)%12,a=[e+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],d=(0>d?"-":d>9999?"+":"")+("00000"+Math.abs(d)).slice(d>=0&&9999>=d?-4:-6),b=a.length;b--;)c=a[b],10>c&&(a[b]="0"+c);
return d+"-"+a.slice(0,2).join("-")+"T"+a.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"
});var L=!1;try{L=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(J).toJSON().indexOf(K)&&Date.prototype.toJSON.call({toISOString:function(){return!0
}})}catch(M){}L||(Date.prototype.toJSON=function(){var a,b=Object(this),c=d(b);if("number"==typeof c&&!isFinite(c))return null;
if(a=b.toISOString,"function"!=typeof a)throw new TypeError("toISOString property is not callable");
return a.call(b)});var N=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),O=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),P=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));
(!Date.parse||P||O||!N)&&(Date=function(a){function b(c,d,e,f,g,h,i){var j=arguments.length;
if(this instanceof a){var k=1===j&&String(c)===c?new a(b.parse(c)):j>=7?new a(c,d,e,f,g,h,i):j>=6?new a(c,d,e,f,g,h):j>=5?new a(c,d,e,f,g):j>=4?new a(c,d,e,f):j>=3?new a(c,d,e):j>=2?new a(c,d):j>=1?new a(c):new a;
return k.constructor=b,k}return a.apply(this,arguments)}function c(a,b){var c=b>1?1:0;
return f[b]+Math.floor((a-1969+c)/4)-Math.floor((a-1901+c)/100)+Math.floor((a-1601+c)/400)+365*(a-1970)
}function d(b){return Number(new a(1970,0,1,0,0,0,b))}var e=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),f=[0,31,59,90,120,151,181,212,243,273,304,334,365];
for(var g in a)b[g]=a[g];return b.now=a.now,b.UTC=a.UTC,b.prototype=a.prototype,b.prototype.constructor=b,b.parse=function(b){var f=e.exec(b);
if(f){var g,h=Number(f[1]),i=Number(f[2]||1)-1,j=Number(f[3]||1)-1,k=Number(f[4]||0),l=Number(f[5]||0),m=Number(f[6]||0),n=Math.floor(1e3*Number(f[7]||0)),o=Boolean(f[4]&&!f[8]),p="-"===f[9]?1:-1,q=Number(f[10]||0),r=Number(f[11]||0);
return(l>0||m>0||n>0?24:25)>k&&60>l&&60>m&&1e3>n&&i>-1&&12>i&&24>q&&60>r&&j>-1&&j<c(h,i+1)-c(h,i)&&(g=60*(24*(c(h,i)+j)+k+q*p),g=1e3*(60*(g+l+r*p)+m)+n,o&&(g=d(g)),g>=-864e13&&864e13>=g)?g:0/0
}return a.parse.apply(this,arguments)},b}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()
}),Number.prototype.toFixed&&"0.000"===8e-5.toFixed(3)&&"0"!==.9.toFixed(0)&&"1.25"===1.255.toFixed(2)&&"1000000000000000128"===0xde0b6b3a7640080.toFixed(0)||!function(){function a(a,b){for(var c=-1;++c<g;)b+=a*h[c],h[c]=b%f,b=Math.floor(b/f)
}function b(a){for(var b=g,c=0;--b>=0;)c+=h[b],h[b]=Math.floor(c/a),c=c%a*f}function c(){for(var a=g,b="";--a>=0;)if(""!==b||0===a||0!==h[a]){var c=String(h[a]);
""===b?b=c:b+="0000000".slice(0,7-c.length)+c}return b}function d(a,b,c){return 0===b?c:b%2===1?d(a,b-1,c*a):d(a*a,b/2,c)
}function e(a){for(var b=0;a>=4096;)b+=12,a/=4096;for(;a>=2;)b+=1,a/=2;return b}var f,g,h;
f=1e7,g=6,h=[0,0,0,0,0,0],Number.prototype.toFixed=function(f){var g,h,i,j,k,l,m,n;
if(g=Number(f),g=g!==g?0:Math.floor(g),0>g||g>20)throw new RangeError("Number.toFixed called with invalid number of decimals");
if(h=Number(this),h!==h)return"NaN";if(-1e21>=h||h>=1e21)return String(h);if(i="",0>h&&(i="-",h=-h),j="0",h>1e-21)if(k=e(h*d(2,69,1))-69,l=0>k?h*d(2,-k,1):h/d(2,k,1),l*=4503599627370496,k=52-k,k>0){for(a(0,l),m=g;m>=7;)a(1e7,0),m-=7;
for(a(d(10,m,1),0),m=k-1;m>=23;)b(1<<23),m-=23;b(1<<m),a(1,1),b(2),j=c()}else a(0,l),a(1<<-k,0),j=c()+"0.00000000000000000000".slice(2,2+g);
return g>0?(n=j.length,j=g>=n?i+"0.0000000000000000000".slice(0,g-n+2)+j:i+j.slice(0,n-g)+"."+j.slice(n-g)):j=i+j,j
}}();var Q=String.prototype.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var a=void 0===/()??/.exec("")[1];
String.prototype.split=function(b,c){var d=this;if(void 0===b&&0===c)return[];if("[object RegExp]"!==k.call(b))return Q.call(this,b,c);
var e,f,g,h,i=[],j=(b.ignoreCase?"i":"")+(b.multiline?"m":"")+(b.extended?"x":"")+(b.sticky?"y":""),l=0;
for(b=new RegExp(b.source,j+"g"),d+="",a||(e=new RegExp("^"+b.source+"$(?!\\s)",j)),c=void 0===c?-1>>>0:Z(c);(f=b.exec(d))&&(g=f.index+f[0].length,!(g>l&&(i.push(d.slice(l,f.index)),!a&&f.length>1&&f[0].replace(e,function(){for(var a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(f[a]=void 0)
}),f.length>1&&f.index<d.length&&Array.prototype.push.apply(i,f.slice(1)),h=f[0].length,l=g,i.length>=c)));)b.lastIndex===f.index&&b.lastIndex++;
return l===d.length?(h||!b.test(""))&&i.push(""):i.push(d.slice(l)),i.length>c?i.slice(0,c):i
}}():"0".split(void 0,0).length&&(String.prototype.split=function(a,b){return void 0===a&&0===b?[]:Q.call(this,a,b)
});var R=String.prototype.replace,S=function(){var a=[];return"x".replace(/x(.)?/g,function(b,c){a.push(c)
}),1===a.length&&"undefined"==typeof a[0]}();if(S||(String.prototype.replace=function(a,b){var c=l(b),d=m(a)&&/\)[*?]/.test(a.source);
if(c&&d){var e=function(c){var d=arguments.length,e=a.lastIndex;a.lastIndex=0;var f=a.exec(c);
return a.lastIndex=e,f.push(arguments[d-2],arguments[d-1]),b.apply(this,f)};return R.call(this,a,e)
}return R.call(this,a,b)}),"".substr&&"b"!=="0b".substr(-1)){var T=String.prototype.substr;
String.prototype.substr=function(a,b){return T.call(this,0>a&&(a=this.length+a)<0?0:a,b)
}}var U="	\n\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",V="\u200b";
if(!String.prototype.trim||U.trim()||!V.trim()){U="["+U+"]";var W=new RegExp("^"+U+U+"*"),X=new RegExp(U+U+"*$");
String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");
return String(this).replace(W,"").replace(X,"")}}(8!==parseInt(U+"08")||22!==parseInt(U+"0x16"))&&(parseInt=function(a){var b=/^0[xX]/;
return function(c,d){return c=String(c).trim(),Number(d)||(d=b.test(c)?16:10),a(c,d)
}}(parseInt));var Y=function(a){if(null==a)throw new TypeError("can't convert "+a+" to object");
return Object(a)},Z=function(a){return a>>>0}}),/*!
 * jQuery Migrate - v1.2.1 - 2013-05-08
 * https://github.com/jquery/jquery-migrate
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT
 */
function(a,b,c){function d(c){var d=b.console;f[c]||(f[c]=!0,a.migrateWarnings.push(c),d&&d.warn&&!a.migrateMute&&(d.warn("JQMIGRATE: "+c),a.migrateTrace&&d.trace&&d.trace()))
}function e(b,c,e,f){if(Object.defineProperty)try{return void Object.defineProperty(b,c,{configurable:!0,enumerable:!0,get:function(){return d(f),e
},set:function(a){d(f),e=a}})}catch(g){}a._definePropertyBroken=!0,b[c]=e}var f={};
a.migrateWarnings=[],!a.migrateMute&&b.console&&b.console.log&&b.console.log("JQMIGRATE: Logging is active"),a.migrateTrace===c&&(a.migrateTrace=!0),a.migrateReset=function(){f={},a.migrateWarnings.length=0
},"BackCompat"===document.compatMode&&d("jQuery is not compatible with Quirks Mode");
var g=a("<input/>",{size:1}).attr("size")&&a.attrFn,h=a.attr,i=a.attrHooks.value&&a.attrHooks.value.get||function(){return null
},j=a.attrHooks.value&&a.attrHooks.value.set||function(){return c},k=/^(?:input|button)$/i,l=/^[238]$/,m=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,n=/^(?:checked|selected)$/i;
e(a,"attrFn",g||{},"jQuery.attrFn is deprecated"),a.attr=function(b,e,f,i){var j=e.toLowerCase(),o=b&&b.nodeType;
return i&&(h.length<4&&d("jQuery.fn.attr( props, pass ) is deprecated"),b&&!l.test(o)&&(g?e in g:a.isFunction(a.fn[e])))?a(b)[e](f):("type"===e&&f!==c&&k.test(b.nodeName)&&b.parentNode&&d("Can't change the 'type' of an input or button in IE 6/7/8"),!a.attrHooks[j]&&m.test(j)&&(a.attrHooks[j]={get:function(b,d){var e,f=a.prop(b,d);
return f===!0||"boolean"!=typeof f&&(e=b.getAttributeNode(d))&&e.nodeValue!==!1?d.toLowerCase():c
},set:function(b,c,d){var e;return c===!1?a.removeAttr(b,d):(e=a.propFix[d]||d,e in b&&(b[e]=!0),b.setAttribute(d,d.toLowerCase())),d
}},n.test(j)&&d("jQuery.fn.attr('"+j+"') may use property instead of attribute")),h.call(a,b,e,f))
},a.attrHooks.value={get:function(a,b){var c=(a.nodeName||"").toLowerCase();return"button"===c?i.apply(this,arguments):("input"!==c&&"option"!==c&&d("jQuery.fn.attr('value') no longer gets properties"),b in a?a.value:null)
},set:function(a,b){var c=(a.nodeName||"").toLowerCase();return"button"===c?j.apply(this,arguments):("input"!==c&&"option"!==c&&d("jQuery.fn.attr('value', val) no longer sets properties"),void(a.value=b))
}};var o,p,q=a.fn.init,r=a.parseJSON,s=/^([^<]*)(<[\w\W]+>)([^>]*)$/;a.fn.init=function(b,c,e){var f;
return b&&"string"==typeof b&&!a.isPlainObject(c)&&(f=s.exec(a.trim(b)))&&f[0]&&("<"!==b.charAt(0)&&d("$(html) HTML strings must start with '<' character"),f[3]&&d("$(html) HTML text after last tag is ignored"),"#"===f[0].charAt(0)&&(d("HTML string cannot start with a '#' character"),a.error("JQMIGRATE: Invalid selector string (XSS)")),c&&c.context&&(c=c.context),a.parseHTML)?q.call(this,a.parseHTML(f[2],c,!0),c,e):q.apply(this,arguments)
},a.fn.init.prototype=a.fn,a.parseJSON=function(a){return a||null===a?r.apply(this,arguments):(d("jQuery.parseJSON requires a valid JSON string"),null)
},a.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];
return{browser:b[1]||"",version:b[2]||"0"}},a.browser||(o=a.uaMatch(navigator.userAgent),p={},o.browser&&(p[o.browser]=!0,p.version=o.version),p.chrome?p.webkit=!0:p.webkit&&(p.safari=!0),a.browser=p),e(a,"browser",a.browser,"jQuery.browser is deprecated"),a.sub=function(){function b(a,c){return new b.fn.init(a,c)
}a.extend(!0,b,this),b.superclass=this,b.fn=b.prototype=this(),b.fn.constructor=b,b.sub=this.sub,b.fn.init=function(d,e){return e&&e instanceof a&&!(e instanceof b)&&(e=b(e)),a.fn.init.call(this,d,e,c)
},b.fn.init.prototype=b.fn;var c=b(document);return d("jQuery.sub() is deprecated"),b
},a.ajaxSetup({converters:{"text json":a.parseJSON}});var t=a.fn.data;a.fn.data=function(b){var e,f,g=this[0];
return!g||"events"!==b||1!==arguments.length||(e=a.data(g,b),f=a._data(g,b),e!==c&&e!==f||f===c)?t.apply(this,arguments):(d("Use of jQuery.fn.data('events') is deprecated"),f)
};var u=/\/(java|ecma)script/i,v=a.fn.andSelf||a.fn.addBack;a.fn.andSelf=function(){return d("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),v.apply(this,arguments)
},a.clean||(a.clean=function(b,c,e,f){c=c||document,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,d("jQuery.clean() is deprecated");
var g,h,i,j,k=[];if(a.merge(k,a.buildFragment(b,c).childNodes),e)for(i=function(a){return!a.type||u.test(a.type)?f?f.push(a.parentNode?a.parentNode.removeChild(a):a):e.appendChild(a):void 0
},g=0;null!=(h=k[g]);g++)a.nodeName(h,"script")&&i(h)||(e.appendChild(h),"undefined"!=typeof h.getElementsByTagName&&(j=a.grep(a.merge([],h.getElementsByTagName("script")),i),k.splice.apply(k,[g+1,0].concat(j)),g+=j.length));
return k});var w=a.event.add,x=a.event.remove,y=a.event.trigger,z=a.fn.toggle,A=a.fn.live,B=a.fn.die,C="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",D=new RegExp("\\b(?:"+C+")\\b"),E=/(?:^|\s)hover(\.\S+|)\b/,F=function(b){return"string"!=typeof b||a.event.special.hover?b:(E.test(b)&&d("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),b&&b.replace(E,"mouseenter$1 mouseleave$1"))
};a.event.props&&"attrChange"!==a.event.props[0]&&a.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),a.event.dispatch&&e(a.event,"handle",a.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),a.event.add=function(a,b,c,e,f){a!==document&&D.test(b)&&d("AJAX events should be attached to document: "+b),w.call(this,a,F(b||""),c,e,f)
},a.event.remove=function(a,b,c,d,e){x.call(this,a,F(b)||"",c,d,e)},a.fn.error=function(){var a=Array.prototype.slice.call(arguments,0);
return d("jQuery.fn.error() is deprecated"),a.splice(0,0,"error"),arguments.length?this.bind.apply(this,a):(this.triggerHandler.apply(this,a),this)
},a.fn.toggle=function(b,c){if(!a.isFunction(b)||!a.isFunction(c))return z.apply(this,arguments);
d("jQuery.fn.toggle(handler, handler...) is deprecated");var e=arguments,f=b.guid||a.guid++,g=0,h=function(c){var d=(a._data(this,"lastToggle"+b.guid)||0)%g;
return a._data(this,"lastToggle"+b.guid,d+1),c.preventDefault(),e[d].apply(this,arguments)||!1
};for(h.guid=f;g<e.length;)e[g++].guid=f;return this.click(h)},a.fn.live=function(b,c,e){return d("jQuery.fn.live() is deprecated"),A?A.apply(this,arguments):(a(this.context).on(b,this.selector,c,e),this)
},a.fn.die=function(b,c){return d("jQuery.fn.die() is deprecated"),B?B.apply(this,arguments):(a(this.context).off(b,this.selector||"**",c),this)
},a.event.trigger=function(a,b,c,e){return c||D.test(a)||d("Global events are undocumented and deprecated"),y.call(this,a,b,c||document,e)
},a.each(C.split("|"),function(b,c){a.event.special[c]={setup:function(){var b=this;
return b!==document&&(a.event.add(document,c+"."+a.guid,function(){a.event.trigger(c,null,b,!0)
}),a._data(this,c,a.guid++)),!1},teardown:function(){return this!==document&&a.event.remove(document,c+"."+a._data(this,c)),!1
}}})}(jQuery,window),function(a){"use strict";var b,c=(a.BMP,{}),d={};c.createObjectURL=function(a,c){{var e=b();
!(!c||!c.autoRevoke)||!1}return d[e]=a,"blob:"+e},c.revokeObjectURL=function(a){var b=a.replace("blob:","");
delete d[b]},c.retrieveObject=function(a){var b=a.replace("blob:","");return d[b]
},c.revokeAllObjectURLs=function(){d={}},b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;
return c.toString(16)})},a.BMP=a.BMP||{},a.BMP.URL=c}(this),function(a){"use strict";
var b,c;a.BMP=a.BMP||{},b=a.BMP,b.MIME=b.MIME||{},c=b.MIME,c.TEXT_TYPES=["application/javascript","application/json","application/x-javascript"],c.isText=function(a){return 0===a.indexOf("text/")?!0:-1!==c.TEXT_TYPES.indexOf(a)?!0:!1
}}(this),function(a){"use strict";{var b,c,d,e,f=!0;a.BMP.MIME}try{b=new a.Blob,b=null
}catch(g){f=!1}e=function(b){var c,d="",e=new a.Uint8Array(b),f=e.byteLength;for(c=0;f>c;c++)d+=String.fromCharCode(e[c]);
return a.btoa(d)},c=function(a,b){var c;if(a&&!Array.isArray(a))throw new Error("first argument should be an Array");
return b=b||{},this.size=0,this.type="",this.base64="",this.text="","object"==typeof b&&(this.type=b.type||this.type),a&&a.length&&(c=a[0],"string"==typeof c&&(0===c.indexOf("data:")&&"text/plain"===this.type?(this.size+=c.length,this.text+=c):(this.size+=c.length,this.base64+=c))),this
},c.createNative=function(b,d){var e;return d=d||{},f?new a.Blob(b,d):a.BlobBuilder?(e=new a.BlobBuilder,e.append(b),e.getBlob(d)):new c(b,d)
},c.fromBlobURL=function(b,d,e){d=d||function(){},e=e||function(){},a.URL&&a.URL.createObjectURL?c.nativelyFromBlobURL(b,d,e):this.fromNativeBlob(a.BMP.URL.retrieveObject(b),function(a){d(a)
},function(a){e(a)})},c.fromNativeBlob=function(b,d,e){var f=new a.FileReader;d=d||function(){},e=e||function(){},f.onload=function(a){var g;
f.onload=null;try{if(g=a.target.result,b=c.fromDataURI(a.target.result),!b)throw new Error("Blob.fromNativeBlob: fromDataURI gave no blob")
}catch(h){return void e(h)}d(b)},f.onerror=function(a){f.onerror=null,e(a.target.error)
};try{f.readAsDataURL(b)}catch(g){f.onload=null,f.onerror=null,e(g)}},c.fromDataURI=function(b){var d,e,f,g,h=new c;
d=b.split(","),g=d[1],d=d[0].split(":"),d=d[1].split(";"),e=d[0],f=d[1],"base64"===f?h.base64=g:h.text=g,h.type=e,h.size=g.length;
try{h=c.fromDataURI(a.atob(h.base64)),h.makeNested()}catch(i){}return h},c.nativelyFromBlobURL=function(b,d,f){var g,h;
d=d||function(){},f=f||function(){},g=new a.XMLHttpRequest,g.onreadystatechange=function(){var b,g,i;
this.readyState===a.XMLHttpRequest.DONE&&(this.onreadystatechange=null,b=this.getResponseHeader("Content-Type"),200===this.status?("arraybuffer"===this.responseType?(g=e(this.response),h=new c([g],{type:b})):"blob"===this.responseType?c.fromNativeBlob(this.response,function(a){d(a)
},function(a){f(a)}):"document"===this.responseType?(i=new a.XMLSerializer,g=a.btoa(i.serializeToString(this.response)),h=new c([g],{type:b})):"json"===this.responseType?(g=a.btoa(JSON.stringify(this.response)),h=new c([g],{type:b})):h=new c([this.response],{type:b}),h?d(h):f(new Error("error retrieving target Blob via Blob URL"))):f(new Error(this.url+" -> "+this.status)))
},g.open("GET",b),g.send()},c.isNested=function(){},c.prototype.makeNested=function(){var a="data:";
a+=this.type,a+=";base64,",a+=this.base64,this.type="text/plain",this.text=a,this.base64=null
},c.prototype.undoNested=function(){var a=c.fromDataURI(this.text);this.type=a.type,this.base64=a.base64,this.text=null
},c.prototype.toNative=function(){return a.BMP.Blob.createNative([a.atob(this.base64)],{type:this.type})
},a.BMP=a.BMP||{},a.BMP.Blob=c,a.BMP.NestedBlob=d}(this),function(a){"use strict";
var b,c,d,e=a.Modernizr,f=a.document,g=a.jQuery;return e?(e.addTest("filereader",function(){return!!(a.File&&a.FileList&&a.FileReader)
}),e.addTest("positionfixed",function(){var b,c,d=f.createElement("div"),e=!1,h=f.body||function(){return e=!0,f.documentElement.appendChild(f.createElement("body"))
}(),i=h.style.cssText;return h.style.cssText="height: 3000px; margin: 0; padding; 0;",d.style.cssText="position: fixed; top: 100px",h.appendChild(d),a.scrollTo(0,500),c=g(d).offset(),b=600===c.top,b||"undefined"==typeof d.getBoundingClientRect||(b=100===d.getBoundingClientRect().top),h.removeChild(d),h.style.cssText=i,a.scrollTo(0,1),e&&f.documentElement.removeChild(h),b
}),e.addTest("xpath",function(){var b,c,d;if(!a.XPathResult||!a.DOMParser)return!1;
try{b=new DOMParser,c=b.parseFromString("<book><page /></book>","text/xml")}catch(e){}if(!c||!c.documentElement||c.getElementsByTagName("parsererror").length)return!1;
if(!c.evaluate)return!1;try{return d=c.evaluate("/book",c,null,9,null),!(!d||!d.singleNodeValue)
}catch(e){}return!1}),e.addTest("documentfragment",function(){var a,b,c;try{return c=f.createElement("p"),a=f.createDocumentFragment(),b=f.createDocumentFragment(),b.appendChild(c),a.appendChild(b),c.parentNode!==a?!1:b.parentNode===a?!1:!0
}catch(d){return!1}}),e.inputtypes.file=function(){var a,b=navigator.userAgent,c=-1!==b.indexOf("Android"),d=c&&/Android 2\.(0|1)/.test(b);
return c&&(-1!==b.indexOf("Android 1.")||d)?!1:(a=f.createElement("input"),a.setAttribute("type","file"),a.disabled===!1)
}(),e.inputtypes.number=function(){var a,b;return e.inputtypes.number?(a=g('<input type="number" />'),a.val(1.5),b=a[0].checkValidity(),a.remove(),b):!1
}(),void(e.canvas&&(b=new Image,c=f.createElement("canvas"),d=c.getContext("2d"),b.onload=function(){d.drawImage(b,0,0),e.addTest("canvastodataurlpng",function(){return 0===c.toDataURL("image/png").indexOf("data:image/png")
}),e.addTest("canvastodataurljpeg",function(){return 0===c.toDataURL("image/jpeg").indexOf("data:image/jpeg")
}),e.addTest("canvastodataurlwebp",function(){return 0===c.toDataURL("image/webp").indexOf("data:image/webp")
})},b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="))):void a.warn("Blink Modernizr tests need Modernizr to be included first.")
}(this),function(a){"use strict";var b=a.jQuery,c=a.Math;a.isBlinkGapDevice=function(){return a.PhoneGap&&"object"===b.type(a.device)&&a.device instanceof a.Device
},a.computeTimeout=function(a){var b=1e3/600;return c.floor(a*b+15e3)}}(this),function(a){"use strict";
var b,c=a.jQuery,d=c(a.document),e={history:[]},f=["log","error","warn","info"],g=function(){d.off("ready deviceready",g),setTimeout(function(){b=a.console||a.debug||{log:c.noop},c.each(f,function(d,e){var f=c.type(b[e]);
a[e]="function"===f?function(){b[e].apply(b,arguments)}:"object"===f?function(a){b[e](a)
}:"log"!==e?a.log:c.noop}),c.each(e.history,function(d,e){var f=a[e.fn],g=c.type(f);
"function"===g?f.apply(b,e.args):"object"===g&&f(e.args[0])}),delete e.history,c.each(f,function(a,b){delete e[b]
})},0)},h=function(){a.PhoneGap&&a.PhoneGap.available?e.history&&g():setTimeout(h,197)
};b=e,c.each(f,function(d,f){e[f]=function(){e.history.push({fn:f,args:c.makeArray(arguments)})
},a[f]=b[f]}),a.isBlinkGap?h():d.on("ready",g)}(this),function(a){"use strict";var b=a.String;
b.prototype.hasEntities=function(){var a=this;return-1===a.indexOf("&")?!1:void 0
},b.prototype.repeat=function(a){var b,c="";for(b=0;a>b;b++)c+=this;return c}}(this),function(a){"use strict";
var b=a.Math,c=b.round;b.round=function(a,d){var e;return d&&0!==d?(e=b.pow(10,d),"number"==typeof d&&d>0&&(a=b.round(a*e)/e),a):c(a)
},"function"!=typeof b.uuid&&(b.uuid=function(){var a,c=b.uuid.CHARS,d=[],e=36;for(d[8]=d[13]=d[18]=d[23]="-",d[14]="4";e--;)d[e]||(a=16*b.random()|0,d[e]=c[19===e?3&a|8:a]);
return d.join("")},b.uuid.CHARS=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"])
}(this),function(a){"use strict";function b(a,b){var d=!0;return a&&"object"===c.type(a)?"array"===c.type(b)?(c.each(b,function(b,c){return void 0===a[c]?(d=!1,!1):!0
}),d):"object"===c.type(b)?(c.each(b,function(b,e){return c.type(a[b])!==e?(d=!1,!1):!0
}),d):!1:!1}var c=a.jQuery,d=c.fn.attr,e=c.fn.show;c.isObject=function(a){return"object"===c.type(a)
},c.isPromise=function(a){var c="function",d={always:c,done:c,fail:c,pipe:c,progress:c,promise:c,state:c,then:c};
return b(a,d)},c.isDeferred=function(a){var d="function",e={notify:d,notifyWith:d,reject:d,rejectWith:d,resolve:d,resolveWith:d};
return c.isPromise(a)?b(a,e):!1},c.fn.attr=function(){var a,b;return this[0]&&0===arguments.length?(b={},a=this[0].attributes,c.each(a,function(a,c){var d=c.name||c.nodeName,e=c.value||c.nodeValue;
d&&(b[d.toLowerCase()]=e)}),b):d.apply(this,arguments)},c.fn.show=function(){return this.removeAttr("hidden"),this.removeClass("hidden"),e.apply(this,arguments)
},c.fn.isHidden=function(){return this.prop("hidden")||this.hasClass("hidden")?!0:this[0]&&this[0].style&&"none"===this[0].style.display
},c.fn.tag=function(){var a;return this.length>0?(a=this[0].nodeName||this[0].tagName||"",a.toLowerCase()):""
},c.fn.tagHTML=function(){var a,b=c(this);return this[0]?(a="<"+b.tag(),c.each(b.attr(),function(b,c){a+=" "+b+'="'+c+'"'
}),a+=" />"):void 0},c.whenArray=function(a){return c.when.apply(c,a)},c.resolveTimeout=function(){var a=c.makeArray(arguments),b=a.shift();
return setTimeout(function(){b.resolve.apply(b,a)},0),this},c.fn.appendWithCheck=function(b,d,e,f){var g=c(this),h=new c.Deferred,i=a.MyAnswers;
return"string"!==c.type(e)&&(e=b.match(/>([^<>\0\n\f\r\t\v]+)</),e||(e=b.match(/(\w+)/)),e="array"===c.type(e)?e[0]:b),"number"!==c.type(f)&&i.dispatch.add(function(){f=g.html().lastIndexOf(e)
}),i.dispatch.add(function(){g.append(b)}),i.dispatch.add(function(){var a=g.html();
"string"!==c.type(a)||!a||a.lastIndexOf(e)>f?h.resolve():d>0?c.when(g.appendWithCheck(b,--d,e,f)).fail(h.reject).then(h.resolve):h.reject()
}),h.promise()},c.fn.childrenAsProperties=function(){var a={};return c(this).children().each(function(b,d){var e=c(d),f=e.tag(),g=e.text();
f.length>0&&g.length>0&&(a[f]=g)}),a},c.getCachedScript=function(a,b){return b=c.extend(b||{},{dataType:"script",cache:!0,url:a}),c.ajax(b)
}}(this),function(a){"use strict";var b=a.jQuery,c=a._Blink,d=a._SERVER,e={PREFIX_GZ:"/_c_/",SUFFIX_GZ:"",PREFIX:"/_c_/",SUFFIX:""},f=["css","js"],g=function(g){var h,i,j;
return i=a.applicationCache&&0!==a.applicationCache.status,j=a.location&&"https:"===a.location.protocol,h=c&&c.cfg&&c.cfg.CDN_PLATFORM,h=b.isObject(h)?h:{},h=b.extend({},e,h),g=g||d&&d.HTTP_ACCEPT_ENCODING,g="string"==typeof g?g:"",-1===g.indexOf("gzip")&&(h.PREFIX_GZ=h.PREFIX,h.SUFFIX_GZ=h.SUFFIX),i&&j&&(h.PREFIX="/_c_/",h.SUFFIX="",h.PREFIX_GZ=h.PREFIX,h.SUFFIX_GZ=h.SUFFIX),this.getURL=function(a){var c;
return a&&"string"==typeof a?(a=b.trim(a),a=a.replace(/^\/*/,""),c=a.match(/\.?(\w+)$/),c="array"===b.type(c)?c[1]:"",c&&-1!==b.inArray(c,f)?h.PREFIX_GZ+a+h.SUFFIX_GZ:h.PREFIX+a+h.SUFFIX):""
},this};c.AnswerSpaceCDN=function(a){var d,e,f,g;return f={ROOT:"images/"},d=c&&c.cfg&&c.cfg.CDN_USER,d=b.isObject(d)?d:{},d=b.extend({},f,d),d.cdnLocation=a,e=function(a,b){var c,d;
return c=a.replace(/^.*[\/\\]/g,""),void 0===b&&(b=""),d=c.length-b.length,c.substr(d)===b&&(c=c.substr(0,d)),c
},g=function(){var a;return a=d.cdnLocation.split(":"),a[1]},this.getURL=function(a){return a&&"string"==typeof a?(a=b.trim(a),a=a.replace(/^\/*/,""),e(a)===a&&(a=d.ROOT+g()+"/"+a),a):""
},this},c.preloadPage=function(a){var c,d=b("<iframe></iframe>"),e=30,f=function(){d.remove()
},g=function(){e--,b(c.document.body).hasClass("s-ready")?f():0>e?(warn('preloadPage(): timed out waiting for "s-ready"'),f()):setTimeout(g,2e3)
};d.attr({height:10,width:10,src:a}),d.css({position:"absolute",top:"-50px",left:"-50px"}),b("body").append(d),c=d[0].contentWindow,b.isWindow(c)&&c.document?b(c.document.body).hasClass("s-ready")?f():setTimeout(g,2e3):warn("preloadPage(): unable to find Window or Document in <iframe>")
},c.stringifyDOM=function(b){var c;return b.xml?b.xml:a.XMLSerializer?(c=new a.XMLSerializer,c.serializeToString(b)):null
},c.hasFontFor=function(d){var e,f,g,h,i=c.hasFontFor;try{i.results||(i.results={}),"boolean"==typeof i.results[d]?e=i.results[d]:(f=b(a.document.body),g=b("<span>"+d+"</span>"),h=b("<span>&#xFFFD;</span>"),g.add(h).appendTo(f),e=g.innerWidth()!==h.innerWidth(),i.results[d]=e,g.add(h).remove())
}catch(j){error(j),e=!1}return e},a._Blink.cdnp=new g}(this),function(a){"use strict";
var b=a.jQuery,c=function(a){function c(){if(!e.isPaused&&null===d&&0!==e.queue.length){var a,f=e.queue.shift();
"function"==typeof f&&(a=f()),"function"==typeof b&&b()instanceof b&&a&&"object"==typeof a&&a.promise&&"function"==typeof a.promise?(d=0,b.when(a).always(function(){d=setTimeout(function(){d=null,c()
},e.interval)})):d=setTimeout(function(){d=null,c()},e.interval)}}var d=null,e=this;
return this.queue=[],this.interval=a||0,this.isPaused=!1,this.poke=function(){c()
},this.pause=function(){clearTimeout(d),d=null,this.isPaused=!0},this.resume=function(){this.isPaused=!1,c()
},this};c.prototype.add=function(a){this.queue.push(a),this.poke()},a.BlinkDispatch=c
}(this),function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(c){return a.BMP=b(a,c),a.BMP
}):a.BMP=b(a,a.$)}(this,function(a,b){"use strict";var c,d,e,f,g,h,i=b(a.document),j=b(a.document.body),k=a.navigator||{},l={};
return c=a.BMP=a.BMP||{},b&&b.fn&&"string"==typeof b.fn.jquery?(e=function(){var a=b('<div id="bmp-dialog-async"></div>');
return a.hide(),j.append(a),a},l.jQueryUI=function(a,b){d=j.find("#bmp-dialog-async"),d.length||(d=e()),d.empty(),d.hasClass("ui-dialog-content")&&d.dialog("destroy"),d.append("<p>"+a+"</p>"),b.modal=!0,b.closeOnEscape=!0,d.dialog(b)
},f=function(){return b.fn.dialog},g=function(){return b.mobile&&b.fn.dialog},c.alertNoQueue=function(c,d){var e,g=new b.Deferred,h=k.notification||{},i=h.alert;
return d=d||{},d.ok="OK",e=function(){g.resolve()},"function"===b.type(i)?(d.title="Alert",i(c,e,d.title,d.ok)):f()?(d.title="Alert",d.buttons={},d.buttons[d.ok]=function(){b(this).dialog("close")
},d.close=e,l.jQueryUI(c,d)):(c=(d.title?d.title+" | ":"")+c,a.alert(c),g.resolve()),g.promise()
},c.confirmNoQueue=function(c,d){var e=new b.Deferred,g=k.notification||{},h=g.alert;
return d=d||{},d.ok=d.ok||"OK",d.cancel=d.cancel||"Cancel","function"===b.type(h)?(d.title=d.title||"Confirm",h(c,function(a){e.resolve(1===a?!0:!1)
},d.title,d.ok+","+d.cancel)):f()?(d.title=d.title||"Confirm",d.buttons={},d.buttons[d.cancel]=function(){b(this).dialog("close")
},d.buttons[d.ok]=function(){e.resolve(!0),b(this).dialog("close")},d.close=function(){e.isRejected()&&e.isResolved()||e.resolve(!1)
},l.jQueryUI(c,d)):(c=(d.title?d.title+" | ":"")+c,e.resolve(a.confirm(c))),e.promise()
},c.promptNoQueue=function(c,d,e){var g=new b.Deferred;return"string"!=typeof d&&(e=d,d=""),e=e||{},e.ok=e.ok||"OK",e.cancel=e.cancel||"Cancel",f()?(c+='</p><p><input type="text" value="'+d+'" />',e.title=e.title||"Prompt",e.buttons={},e.buttons[e.cancel]=function(){b(this).dialog("close")
},e.buttons[e.ok]=function(){var a=b(this);g.resolve(a.find("input").val()),a.dialog("close")
},e.close=function(){g.isRejected()&&g.isResolved()||g.resolve(null)},l.jQueryUI(c,e)):(c=(e.title?e.title+" | ":"")+c,g.resolve(a.prompt(c))),g.promise()
},h=function(a,c,d){return"string"==typeof c&&(c=a[c]),function(){var e=b.makeArray(arguments),f=new b.Deferred;
return i.queue(d,function(g){var h,j=b._data(i[0],d+"queue");return j.unshift("inprogress"),h=c.apply(a,e),h.then(function(){f.resolve.apply(f,b.makeArray(arguments)),j.shift(),g()
},function(){f.reject.apply(f,b.makeArray(arguments)),j.shift(),g()}),h}),i.queue(d).length&&"inprogress"!==i.queue(d)[0]&&i.dequeue(d),f.promise()
}},c.alert=h(this,c.alertNoQueue,"bmp-alerts"),c.confirm=h(this,c.confirmNoQueue,"bmp-alerts"),c.prompt=h(this,c.promptNoQueue,"bmp-alerts"),c):void 0
}),function(a,b){"use strict";"function"==typeof define&&define.amd?define(["../../../../."],function(c){return a.BMP=b(a,c),a.BMP
}):a.BMP=b(a,a._)}(this,function(a,b){"use strict";var c,d,e;return c=a.BMP=a.BMP||{},d=c.BIC=c.BIC||{},e=function(a){this.cfg=a
},e.prototype.toCameraOptions=function(){var a,c={};if(b.isNumber(this.cfg.imageCaptureQuality)&&(c.quality=this.cfg.imageCaptureQuality),b.isNumber(this.cfg.imageCaptureScale)&&(c.imageScale=this.cfg.imageCaptureScale),b.isString(this.cfg.cameraOptions)){try{a=JSON.parse(this.cfg.cameraOptions),(!b.isObject(a)||b.isArray(a))&&(a={})
}finally{a=a||{}}b.extend(c,a)}return c},d.Config=e,c}),function(a){"use strict";
var b,c,d,e,f,g,h,i,j,k,l=a.jQuery,m=a.alert,n={},o={},p=function(j,k,o){var p,q,r,s=this,t=new l.Deferred;
return("string"!=typeof k||k.length<1)&&(k="default"),("string"!=typeof o||o.length<1)&&(o="main"),"string"!=typeof j?j=b[0]:"sessionstorage"===j&&-1===l.inArray("sessionstorage",b)?j="memory":-1===l.inArray(j,b)&&(j=b[0]),s.type=j,s.partition=k,s.section=o,t.done(function(){h("BlinkStorage(): "+j+" -> "+k+" : "+o+" ready")
}),s.ready=function(){return t.promise()},"localstorage"===j||"sessionstorage"===j?(q="localstorage"===j?a.localStorage:a.sessionStorage,s.get=function(a){var b=new l.Deferred;
return b.resolve(q.getItem(k+":"+o+":"+a)),b.promise()},s.set=function(a,b){var c=new l.Deferred;
return q.setItem(k+":"+o+":"+a,b),c.resolve(),c.promise()},s.remove=function(a){var b=new l.Deferred;
return q.removeItem(k+":"+o+":"+a),b.resolve(),b.promise()},s.keys=function(){var a,b,c=new l.Deferred,d=[],e=q.length,f=k+":"+o+":";
for(a=0;e>a;a++)b=q.key(a),0===b.indexOf(f)&&d.push(b.replace(f,""));return c.resolve(d),c.promise()
},s.count=function(){var a=new l.Deferred;return l.when(s.keys()).done(function(b){a.resolve(b.length)
}),a.promise()},t.resolve()):"websqldatabase"===j?(c=a.device?a.sqlitePlugin?100:5:.75,d=1024*c*1024,e=function(a,b){var c=b&&a.executeSql?b:a;
return i("BlinkStorage error1: "+c.code+" "+c.message),(3===c.code||4===c.code||7===c.code)&&m("storage-error: "+c.code+"\n"+c.message),!1
},f=function(a,b){a.transaction(function(a){a.executeSql("CREATE TABLE IF NOT EXISTS `"+o+"` (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",[],l.noop,e)
},function(){b.reject(),e()},function(){b.resolve()})},g=function(b,c,e){try{if(a.sqlitePlugin?(h("sqliteplugin found. opening database."),q=a.sqlitePlugin.openDatabase(b,"1.0",b,d,function(){h("opendb success callback")
},function(){throw h("failed to open "+b),c.reject(),"BlinkStorage: sqliteplugin unable to open database"
})):q=a.openDatabase(b,"1.0",b,d),!q||!q.readTransaction&&!q.transaction)throw"neither sqliteplugin nor window.openDatabase worked. failing.";
n[b]=q,q.readTransaction=q.readTransaction||q.transaction,e(q,c)}catch(f){throw c.reject(),"BlinkStorage: "+f
}},p={get:"SELECT v FROM `"+o+"` WHERE k = ?",set:"INSERT OR REPLACE INTO `"+o+"` (k, v) VALUES (?, ?)",remove:"DELETE FROM `"+o+"` WHERE k = ?",keys:"SELECT k FROM `"+o+"`",count:"SELECT count(k) AS `count` FROM "+o},n[k]?(q=n[k],f(q,t)):g(k,t,f),s.get=function(a){var b=new l.Deferred;
return q.readTransaction(function(c){c.executeSql(p.get,[a],function(a,c){1===c.rows.length?b.resolve(c.rows.item(0).v):(b.resolve(null),c.rows.length>1&&i("BlinkStorage: SELECT returned multiple rows"))
},e)},e,l.noop),b.promise()},s.set=function(a,b,c){var d=new l.Deferred,f=new l.Deferred,g=function(){setTimeout(function(){l.when(s.set(a,b,c)).fail(d.reject).then(d.resolve)
},2e3)};return c="number"!=typeof c?2:c,c--<=0?(d.reject(),d.promise()):(setTimeout(function(){q.transaction(function(c){c.executeSql(p.set,[a,b],function(a,b){1!==b.rowsAffected?(i("BlinkStorage: INSERT did not affect 1 row"),g()):f.resolve()
},function(a,b){e(b),g()})},function(a,b){e(a,b),g()},function(){"pending"===f.state()?g():d.resolve()
})},0),d.promise())},s.remove=function(a){var b=new l.Deferred;return q.transaction(function(c){c.executeSql(p.remove,[a],function(){b.resolve()
})},e,l.noop),b.promise()},s.keys=function(){var a=new l.Deferred;return q.readTransaction(function(b){b.executeSql(p.keys,[],function(b,c){var d,e,f=c.rows.length,g=[];
for(d=0;f>d;d++)e=c.rows.item(d),g.push(e.k);a.resolve(g)})},e,l.noop),a.promise()
},s.count=function(){var a=new l.Deferred;return q.readTransaction(function(b){b.executeSql(p.count,[],function(b,c){var d=c.rows.item(0).count;
l.isNumeric(d)?a.resolve(parseInt(d,10)):(i("BlinkStorage: SELECT count(k) non-numeric"),a.reject())
})},e,l.noop),a.promise()}):"memory"===j&&(r={},s.get=function(a){var b=new l.Deferred;
return b.resolve(r[k+":"+o+":"+a]),b.promise()},s.set=function(a,b){var c=new l.Deferred;
return r[k+":"+o+":"+a]=b,c.resolve(),c.promise()},s.remove=function(a){var b=new l.Deferred;
return delete r[k+":"+o+":"+a],b.resolve(),b.promise()},s.keys=function(){var a,b=new l.Deferred,c=[],d=k+":"+o+":";
for(a in r)r.hasOwnProperty(a)&&0===a.indexOf(d)&&c.push(a.replace(d,""));return b.resolve(c),b.promise()
},s.count=function(){var a=new l.Deferred;return l.when(s.keys()).done(function(b){a.resolve(b.length)
}),a.promise()},t.resolve()),this};return l?(l.each(["log","error","warn","info"],function(b,c){o[c]=function(){a[c]&&a[c].apply(a,arguments)
}}),h=o.log,i=o.error,j=o.warn,k=o.info,p.prototype.removeKeysRegExp=function(a){var b=this,c=new l.Deferred(function(c){l.when(b.keys()).done(function(d){var e,f=d.length,g=[];
for(e=0;f>e;e++)-1!==d[e].search(a)&&g.push(b.remove(d[e]));l.when(g).done(c.resolve())
})});return c.promise()},p.prototype.available=[],b=p.prototype.available,"undefined"!=typeof a.openDatabase&&b.push("websqldatabase"),"undefined"!=typeof a.localStorage&&b.push("localstorage"),"undefined"!=typeof a.sessionStorage&&b.push("sessionstorage"),b.push("memory"),"function"==typeof a.log&&k("BlinkStorage(): available=["+b.join(",")+"]"),void(a.BlinkStorage=p)):void m("error: BlinkStorage.JS requires jQuery to be loaded first")
}(this),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a
}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];
return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'
}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);
case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);
case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";
return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e
}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));
else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));
return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e
}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null
},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()
});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;
"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";
else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");
return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];
if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);
return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;
throw new SyntaxError("JSON.parse")})}(),/**
 * History.js jQuery Adapter
 * @author Benjamin Arthur Lupton <contact@balupton.com>
 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
 */
function(a,b){"use strict";var c=a.History=a.History||{},d=a.jQuery;if("undefined"!=typeof c.Adapter)throw new Error("History.js Adapter has already been loaded...");
c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)
},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;
return e},onDomLoad:function(a){d(a)}},"undefined"!=typeof c.init&&c.init()}(window),/**
 * History.js HTML4 Support
 * Depends on the HTML5 Support
 * @author Benjamin Arthur Lupton <contact@balupton.com>
 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
 */
function(a){"use strict";var b=a.document,c=a.setTimeout||c,d=a.clearTimeout||d,e=a.setInterval||e,f=a.History=a.History||{};
if("undefined"!=typeof f.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");
f.initHtml4=function(){return"undefined"!=typeof f.initHtml4.initialized?!1:(f.initHtml4.initialized=!0,f.enabled=!0,f.savedHashes=[],f.isLastHash=function(a){var b,c=f.getHashByIndex();
return b=a===c},f.isHashEqual=function(a,b){return a=encodeURIComponent(a).replace(/%25/g,"%"),b=encodeURIComponent(b).replace(/%25/g,"%"),a===b
},f.saveHash=function(a){return f.isLastHash(a)?!1:(f.savedHashes.push(a),!0)},f.getHashByIndex=function(a){var b=null;
return b="undefined"==typeof a?f.savedHashes[f.savedHashes.length-1]:0>a?f.savedHashes[f.savedHashes.length+a]:f.savedHashes[a]
},f.discardedHashes={},f.discardedStates={},f.discardState=function(a,b,c){var d,e=f.getHashByState(a);
return d={discardedState:a,backState:c,forwardState:b},f.discardedStates[e]=d,!0},f.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};
return f.discardedHashes[a]=d,!0},f.discardedState=function(a){var b,c=f.getHashByState(a);
return b=f.discardedStates[c]||!1},f.discardedHash=function(a){var b=f.discardedHashes[a]||!1;
return b},f.recycleState=function(a){var b=f.getHashByState(a);return f.discardedState(a)&&delete f.discardedStates[b],!0
},f.emulated.hashChange&&(f.hashChangeInit=function(){f.checkerFunction=null;var c,d,g,h,i="",j=Boolean(f.getHash());
return f.isInternetExplorer()?(c="historyjs-iframe",d=b.createElement("iframe"),d.setAttribute("id",c),d.setAttribute("src","#"),d.style.display="none",b.body.appendChild(d),d.contentWindow.document.open(),d.contentWindow.document.close(),g="",h=!1,f.checkerFunction=function(){if(h)return!1;
h=!0;var b=f.getHash(),c=f.getHash(d.contentWindow.document);return b!==i?(i=b,c!==b&&(g=c=b,d.contentWindow.document.open(),d.contentWindow.document.close(),d.contentWindow.document.location.hash=f.escapeHash(b)),f.Adapter.trigger(a,"hashchange")):c!==g&&(g=c,j&&""===c?f.back():f.setHash(c,!1)),h=!1,!0
}):f.checkerFunction=function(){var b=f.getHash()||"";return b!==i&&(i=b,f.Adapter.trigger(a,"hashchange")),!0
},f.intervalList.push(e(f.checkerFunction,f.options.hashChangeInterval)),!0},f.Adapter.onDomLoad(f.hashChangeInit)),f.emulated.pushState&&(f.onHashChange=function(b){var c,d=b&&b.newURL||f.getLocationHref(),e=f.getHashByUrl(d),g=null,h=null;
return f.isLastHash(e)?(f.busy(!1),!1):(f.doubleCheckComplete(),f.saveHash(e),e&&f.isTraditionalAnchor(e)?(f.Adapter.trigger(a,"anchorchange"),f.busy(!1),!1):(g=f.extractState(f.getFullUrl(e||f.getLocationHref()),!0),f.isLastSavedState(g)?(f.busy(!1),!1):(h=f.getHashByState(g),(c=f.discardedState(g))?(f.getHashByIndex(-2)===f.getHashByState(c.forwardState)?f.back(!1):f.forward(!1),!1):(f.pushState(g.data,g.title,encodeURI(g.url),!1),!0))))
},f.Adapter.bind(a,"hashchange",f.onHashChange),f.pushState=function(b,c,d,e){if(d=encodeURI(d).replace(/%25/g,"%"),f.getHashByUrl(d))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");
if(e!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.pushState,args:arguments,queue:e}),!1;
f.busy(!0);var g=f.createStateObject(b,c,d),h=f.getHashByState(g),i=f.getState(!1),j=f.getHashByState(i),k=f.getHash(),l=f.expectedStateId==g.id;
return f.storeState(g),f.expectedStateId=g.id,f.recycleState(g),f.setTitle(g),h===j?(f.busy(!1),!1):(f.saveState(g),l||f.Adapter.trigger(a,"statechange"),f.isHashEqual(h,k)||f.isHashEqual(h,f.getShortUrl(f.getLocationHref()))||f.setHash(h,!1),f.busy(!1),!0)
},f.replaceState=function(b,c,d,e){if(d=encodeURI(d).replace(/%25/g,"%"),f.getHashByUrl(d))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");
if(e!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.replaceState,args:arguments,queue:e}),!1;
f.busy(!0);var g=f.createStateObject(b,c,d),h=f.getHashByState(g),i=f.getState(!1),j=f.getHashByState(i),k=f.getStateByIndex(-2);
return f.discardState(i,g,k),h===j?(f.storeState(g),f.expectedStateId=g.id,f.recycleState(g),f.setTitle(g),f.saveState(g),f.Adapter.trigger(a,"statechange"),f.busy(!1)):f.pushState(g.data,g.title,g.url,!1),!0
}),void(f.emulated.pushState&&f.getHash()&&!f.emulated.hashChange&&f.Adapter.onDomLoad(function(){f.Adapter.trigger(a,"hashchange")
})))},"undefined"!=typeof f.init&&f.init()}(window),/**
 * History.js Core
 * @author Benjamin Arthur Lupton <contact@balupton.com>
 * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>
 * @license New BSD License <http://creativecommons.org/licenses/BSD/>
 */
function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;
try{f.setItem("TEST","1"),f.removeItem("TEST")}catch(o){f=!1}if(k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init)throw new Error("History.js Core has already been loaded...");
m.init=function(){return"undefined"==typeof m.Adapter?!1:("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)
},m.initCore=function(){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.disableSuid=m.options.disableSuid||!1,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.options.html4Mode=m.options.html4Mode||!1,m.options.delayInit=m.options.delayInit||!1,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;
if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null
}},m.debug=function(){m.options.debug&&m.log.apply(m,arguments)},m.log=function(){var a,b,e,f,g,h=!("undefined"==typeof c||"undefined"==typeof c.log||"undefined"==typeof c.log.apply),i=d.getElementById("log");
for(h?(f=Array.prototype.slice.call(arguments),a=f.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[a,f]):c.log.apply(c,[a,f])):a="\n"+arguments[0]+"\n",b=1,e=arguments.length;e>b;++b){if(g=arguments[b],"object"==typeof g&&"undefined"!=typeof k)try{g=k.stringify(g)
}catch(j){}a+="\n"+g+"\n"}return i?(i.value+=a+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):h||l(a),!0
},/**
		 * History.getInternetExplorerMajorVersion()
		 * Get's the major version of Internet Explorer
		 * @return {integer}
		 * @license Public Domain
		 * @author Benjamin Arthur Lupton <contact@balupton.com>
		 * @author James Padolsey <https://gist.github.com/527683>
		 */
m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4?a:!1
}();return a},/**
		 * History.isInternetExplorer()
		 * Are we using Internet Explorer?
		 * @return {boolean}
		 * @license Public Domain
		 * @author Benjamin Arthur Lupton <contact@balupton.com>
		 */
m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());
return a},m.emulated=m.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent))),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;
return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c
},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);
return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";
return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c
},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();
return a},m.getPageUrl=function(){var a,b=m.getState(!1,!1),c=(b||{}).url||m.getLocationHref();
return a=c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?a:a+"/"
})},m.getBasePageUrl=function(){var a=m.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a
}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);
return b="undefined"==typeof b?!0:b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")
},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")
},m.getLocationHref=function(a){return a=a||d,a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash?a.location.href:-1==a.URL.indexOf("#")&&-1!=a.location.href.indexOf("#")?a.location.href:a.URL||a.location.href
},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}
},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);
var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c
},m.getIdByState=function(a){var b,c=m.extractId(a.url);if(!c)if(b=m.getStateString(a),"undefined"!=typeof m.stateToId[b])c=m.stateToId[b];
else if("undefined"!=typeof m.store.stateToId[b])c=m.store.stateToId[b];else{for(;;)if(c=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof m.idToState[c]&&"undefined"==typeof m.store.idToState[c])break;
m.stateToId[b]=c,m.idToState[c]=a}return c},m.normalizeState=function(a){var b,c;
return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(a.url?a.url:m.getLocationHref()),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&m.options.disableSuid!==!0&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)
},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)
},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;
return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)
},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;
return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d,e;return e=-1!=a.indexOf("#")?a.split("#")[0]:a,c=/(.*)\&_suid=([0-9]+)$/.exec(e),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1
},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c,d,e=null;
return b=b||!1,c=m.extractId(a),c&&(e=m.getStateById(c)),e||(d=m.getFullUrl(a),c=m.getIdByUrl(d)||!1,c&&(e=m.getStateById(c)),e||!b||m.isTraditionalAnchor(a)||(e=m.createStateObject(null,null,d))),e
},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b
},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b
},m.hasUrlDuplicate=function(a){var b,c=!1;return b=m.extractState(a.url),c=b&&b.id!==a.id
},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a
},m.isLastSavedState=function(a){var b,c,d,e=!1;return m.savedStates.length&&(b=a.id,c=m.getLastSavedState(),d=c.id,e=b===d),e
},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)
},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]
},m.getCurrentIndex=function(){var a=null;return a=m.savedStates.length<1?0:m.savedStates.length-1
},m.getHash=function(a){var b,c=m.getLocationHref(a);return b=m.getHashByUrl(c)},m.unescapeHash=function(a){var b=m.normalizeHash(a);
return b=decodeURIComponent(b)},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");
return b},m.setHash=function(a,b){var c,e;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(m.busy(!0),c=m.extractState(a,!0),c&&!m.emulated.pushState?m.pushState(c.data,c.title,c.url,!1):m.getHash()!==a&&(m.bugs.setHash?(e=m.getPageUrl(),m.pushState(null,null,e+"#"+a,!1)):d.location.hash=a),m)
},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.encodeURIComponent(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c
},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");
return b=m.unescapeHash(b)},m.setTitle=function(a){var b,c=a.title;c||(b=m.getStateByIndex(0),b&&b.url===a.url&&(c=b.title||m.options.initialTitle));
try{d.getElementsByTagName("title")[0].innerHTML=c.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")
}catch(e){}return d.title=c,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);
var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))
};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])
},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m
},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m
},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m
},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m
},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0
},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b,c=m.extractState(m.getLocationHref());
if(!m.isLastSavedState(c))return b=c,b||(b=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m
},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)
}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)
}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;a>=c;++c)m.forward(b);else{if(!(0>a))throw new Error("History.go: History.go requires a positive or negative integer passed.");
for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o
}else m.onPopState=function(b,c){var d,e,f=!1,g=!1;return m.doubleCheckComplete(),(d=m.getHash())?(e=m.extractState(d||m.getLocationHref(),!0),e?m.replaceState(e.data,e.title,e.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(f=m.Adapter.extractEventData("state",b,c)||!1,g=f?m.getStateById(f):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(m.getLocationHref()),g||(g=m.createStateObject(null,null,m.getLocationHref())),m.expectedStateId=!1,m.isLastSavedState(g)?(m.busy(!1),!1):(m.storeState(g),m.saveState(g),m.setTitle(g),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))
},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;
m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0
},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;
m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0
};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()
}else m.store={},m.normalizeStore();m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(m.getLocationHref(),!0))),f&&(m.onUnload=function(){var a,b,c;
try{a=k.parse(f.getItem("History.store"))||{}}catch(d){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};
for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);
for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);
m.store=a,m.normalizeStore(),c=k.stringify(a);try{f.setItem("History.store",c)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;
f.length&&(f.removeItem("History.store"),f.setItem("History.store",c))}},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),("Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||""))&&(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")
}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))
},m.options&&m.options.delayInit||m.init()}(window);var activityIndicatorTop,$navBar;
document.getElementById("startUp-loadDevice").className="working",MyAnswers.deviceDeferred=new $.Deferred,function(a){var b=a.jQuery,c=function(){var c=this;
return c.hideLocationBar=function(){a.scrollTo(0,1)},c.prepareView=function(c,d){var e=new b.Deferred;
return MyAnswers.dispatch.add(function(){var f,g=d?"right":"left",h=b(".view:visible"),i=b("#navBoxHeader");
return"screen-bottom"!==a.currentConfig.footerPosition&&MyAnswers.$body.children("footer").hide(),h.length<1?void e.resolve():(MyAnswers.dispatch.pause("prepareView"),i.find("button").attr("disabled","disabled"),h.addClass("animating"),f=setTimeout(function(){h.trigger("webkitTransitionEnd")
},1e3),h.one("webkitTransitionEnd",function(){clearTimeout(f),f=null,h.hide(),h.removeClass("animating slid"+g),MyAnswers.dispatch.resume("hideView"),e.resolve()
}),setTimeout(function(){h.addClass("slid"+g)},0),currentMasterCategory?c.attr({"data-name":siteVars.config["m"+currentMasterCategory].pertinent.name}):b("#categoriesView").removeAttr("data-name"),currentCategory?c.attr({"data-name":siteVars.config["c"+currentCategory].pertinent.name}):b("#keywordListView").removeAttr("data-name"),void(currentInteraction?c.attr({"data-name":siteVars.config["i"+currentInteraction].pertinent.name,"data-type":siteVars.config["i"+currentInteraction].pertinent.type}):(b("#answerView").removeAttr("data-name"),b("#answerView").removeAttr("data-type"))))
}),e.promise()},c.showView=function(a,d){var e=new b.Deferred;return MyAnswers.dispatch.add(function(){var b,f=d?"left":"right";
MyAnswers.dispatch.pause("showView"),c.hideLocationBar(),a.hide(),a.addClass("slid"+f),a.show(),b=setTimeout(function(){a.trigger("webkitTransitionEnd")
},1e3),a.one("webkitTransitionEnd",function(){clearTimeout(b),b=null,a.removeClass("animating"),MyAnswers.dispatch.resume("showView"),updateNavigationButtons(),MyAnswers.$body.children("footer").show(),e.resolve(),a.trigger("viewShow")
}),setTimeout(function(){a.addClass("animating"),a.removeClass("slid"+f)},0)}),e.promise()
},c};a.MyAnswersDevice=new c}(this),document.getElementById("startUp-loadDevice").className="working success",MyAnswers.deviceDeferred.resolve(),function(a){"use strict";
function b(a){var b,c=new g.Deferred,d=new f.maps.DirectionsService;return g.isPlainObject(a)&&a.origin&&a.destination&&a.travelMode?(d.route(a,function(a,d){if(d===f.maps.DirectionsStatus.OK)c.resolve(a);
else{switch(d){case f.maps.DirectionsStatus.NOT_FOUND:b="one of the waypoints could not be geocoded";
break;case f.maps.DirectionsStatus.ZERO_RESULTS:b="no route found, be more specific";
break;case f.maps.DirectionsStatus.MAX_WAYPOINTS_EXCEEDED:b="too many waypoints specified";
break;case f.maps.DirectionsStatus.OVER_QUERY_LIMIT:b="request quota exceeded, try again later";
break;case f.maps.DirectionsStatus.REQUEST_DENIED:b="request denied";break;case f.maps.DirectionsStatus.INVALID_REQUEST:b="invalid request";
break;default:b="unknown error, please try again"}c.reject("GoogleDirections error: "+b)
}}),c.promise()):(c.reject("GoogleDirections error: bad options"),c.promise())}function c(a,b,c){var d,g,h,i;
log("GoogleMaps basic: initialising..."),e.$body.trigger("taskBegun"),d=new f.maps.LatLng(b.latitude,b.longitude),g={zoom:parseInt(b.zoom,10),center:d,mapTypeId:f.maps.MapTypeId[b.type.toUpperCase()]},c.setOptions(g),"string"==typeof b.kml?f.maps.KmlLayer(b.kml,{map:c,preserveViewport:!0}):"string"==typeof b.marker&&(h=new f.maps.Marker({position:d,map:c,icon:b.marker}),"string"==typeof b.markerTitle&&(h.setTitle(b.markerTitle),i=new f.maps.InfoWindow,f.maps.event.addListener(h,"click",function(){i.setContent(h.getTitle()),i.open(c,h)
}))),e.$body.trigger("taskComplete")}function d(a,d,h){var i,j,k,l={},m=d.travelmode.toUpperCase(),n={travelMode:f.maps.DirectionsTravelMode[m],avoidHighways:d.avoidhighways,avoidTolls:d.avoidtolls},o={mapTypeId:f.maps.MapTypeId[d.type.toUpperCase()]},p=g(a),q=p.next(".googledirections").first(),r=q,s=!0,t=!0,u=function(a){"string"==typeof a&&a.length&&insertText(q[0],a)
};log("GoogleMaps directions: initialising..."),"string"==typeof d.language&&(l.language=d.language),"string"==typeof d.region&&(l.region=d.region,n.region=d.region),"string"==typeof d.originAddress&&d.originAddress.length?i=d.originAddress:d.originLatitude?i=new f.maps.LatLng(d.originLatitude,d.originLongitude):Modernizr.geolocation&&(log("Google Maps Directions: missing origin"),insertText(q[0],"using your most recent location as the origin..."),s=e.getGeoLocation().fail(u).then(function(a){i=new f.maps.LatLng(a.latitude,a.longitude)
})),"string"==typeof d.destinationAddress&&d.destinationAddress.length?j=d.destinationAddress:d.destinationLatitude?j=new f.maps.LatLng(d.destinationLatitude,d.destinationLongitude):Modernizr.geolocation&&(log("Google Maps Directions: missing destination"),insertText(q[0],"using your most recent location as the destination..."),t=e.getGeoLocation().fail(u).then(function(a){j=new f.maps.LatLng(a.latitude,a.longitude)
})),g.when(s,t).always(function(){i&&j?"object"===g.type(i)&&"object"===g.type(j)&&i.equals(j)?(insertText(q[0],"origin and destination are the identical"),d.latitude=i.lat(),d.longitude=i.lng(),c(a,d,h)):(n.origin=i,n.destination=j,h.setOptions(o),k=new f.maps.DirectionsRenderer,k.setMap(h),k.setPanel(r[0]),g.when(b(n)).fail(u).then(function(a){k.setDirections(a)
})):i||j?i?(insertText(q[0],"missing destination, only the provided origin is displayed"),d.latitude=i.lat(),d.longitude=i.lng(),c(a,d,h)):(insertText(q[0],"missing origin, only the provided destination is displayed"),d.latitude=j.lat(),d.longitude=j.lng(),c(a,d,h)):insertText(q[0],"error: neither origin or destination could be determined")
})}var e,f,g=a.jQuery,h=a.navigator;e=a.MyAnswers||{},a.MyAnswers=e,e.onGoogleMapsLoad=function(){setTimeout(function(){a.google&&a.google.maps&&a.google.maps.Map?e.dfrdGoogleMaps.resolve():e.dfrdGoogleMaps.reject()
},197)},e.getGeoLocation=function(a){var b=new g.Deferred,c={enableHighAccuracy:!0,maximumAge:6e5,timeout:1e4};
return Modernizr.geolocation?(a=g.isPlainObject(a)?a:{},a=g.extend({},c,a),h.geolocation.getCurrentPosition(function(a){var c;
a.coords?(c={latitude:a.coords.latitude,longitude:a.coords.longitude,altitude:a.coords.altitude,accuracy:a.coords.accuracy,altitudeAccuracy:a.coords.altitudeAccuracy,heading:a.coords.heading,speed:a.coords.speed},b.resolve(c)):b.reject("GeoLocation error: blank location from device")
},function(a){var c;switch(a.code){case a.PERMISSION_DENIED:c="user has not granted permission";
break;case a.PERMISSION_DENIED_TIMEOUT:c="user did not grant permission in time";
break;case a.POSITION_UNAVAILABLE:c="unable to determine position";break;default:c="unknown error"
}b.reject("GeoLocation error: "+c)},a),b.promise()):(b.reject("GeoLocation error: unsupported in this browser / device"),b.promise())
},e.setupGoogleMaps=function(b){var h,i,j,k=b.find("div.googlemap").first(),l=k.data(),m=k[0];
e.$body.trigger("taskBegun"),f=a.google,h=new f.maps.Map(m),"directions"===l.mapAction?d(m,l,h):c(m,l,h),Modernizr.geolocation&&(i=new f.maps.Marker({map:h,icon:"/_R_/BICv2/images/location24.png",title:"you are here"}),j=new f.maps.InfoWindow,g.when(e.getGeoLocation()).then(function(a){i.setPosition(new f.maps.LatLng(a.latitude,a.longitude))
}),f.maps.event.addListener(i,"click",function(){j.setContent(i.getTitle()),j.open(h,i)
})),e.$body.trigger("taskComplete")}}(this);var MyAnswers=MyAnswers||{},siteVars=siteVars||{},deviceVars=deviceVars||{},hasCategories=!1,hasMasterCategories=!1,hasInteractions=!1,answerSpaceOneKeyword=!1,currentInteraction,currentCategory,currentMasterCategory,currentConfig={},starsProfile={};
document.getElementById("startUp-loadMain").className="working",currentConfig.downloadTimeout=30,currentConfig.uploadTimeout=45,deviceVars.isOnline=!0,MyAnswers.mainDeferred=new $.Deferred,MyAnswers.browserDeferred=new $.Deferred,MyAnswers.formsDeferred=new $.Deferred,MyAnswers.dfrdMoJOs=null,MyAnswers.dfrdGoogleMaps=null,siteVars.mojos=siteVars.mojos||{},siteVars.forms=siteVars.forms||{},MyAnswers.isLoggedIn=!1,MyAnswers.isCustomLogin=!1,MyAnswers.isEmptySpace=!1,MyAnswers.gotoDefaultScreen=function(){var a,b=window.History;
"login"===currentConfig.defaultScreen||MyAnswers.isLoginOnly?showLoginView():"interaction"===currentConfig.defaultScreen&&hasInteractions&&void 0!==typeof siteVars.config["i"+currentConfig.defaultInteraction]?(a="/"+siteVars.answerSpace+"/"+siteVars.config["i"+currentConfig.defaultInteraction].pertinent.name+"/?",b.pushState({i:currentConfig.defaultInteraction},null,a)):"category"===currentConfig.defaultScreen&&hasCategories&&void 0!==typeof siteVars.config["c"+currentConfig.defaultCategory]?(a="/"+siteVars.answerSpace+"/?_c="+currentConfig.defaultCategory,b.pushState({c:currentConfig.defaultCategory},null,a)):"master category"===currentConfig.defaultScreen&&hasMasterCategories&&void 0!==typeof siteVars.config["m"+currentConfig.defaultMasterCategory]?(a="/"+siteVars.answerSpace+"/?_m="+currentConfig.defaultMasterCategory,b.pushState({m:currentConfig.defaultMasterCategory},null,a)):b.replaceState({_now:$.now()},null,"/"+siteVars.answerSpace+"/")
},function(a){function b(){History.pushState({m:$(this).data("id")},null,"/"+siteVars.answerSpace+"/?_m="+$(this).data("id"))
}function c(){History.pushState({m:$(this).data("masterCategory"),c:$(this).data("id")},null,"/"+siteVars.answerSpace+"/?_c="+$(this).data("id"))
}function d(){var a=siteVars.config["i"+$(this).data("id")].pertinent.name;History.pushState({m:$(this).data("masterCategory"),c:$(this).data("category"),i:$(this).data("id")},null,"/"+siteVars.answerSpace+"/"+a+"/")
}function e(){a.open($(this).data("hyperlink"),$(this).data("target"))}var f=a.MyAnswers;
f.populateItemListing=function(a,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x={};x.interactions=function(a){var b=a.attr("data-id"),c=siteVars.config["i"+b].pertinent;
"hyperlink"===c.type&&c.hyperlink?(a.attr("data-hyperlink",c.hyperlink),a.attr("data-target",c.hyperlinkTarget),a.on("click",e)):a.on("click",d)
},x.categories=function(a){var b=a.attr("data-id");1===siteVars.map["c"+b].length?(a.attr("data-category",b),a.attr("data-id",siteVars.map["c"+b][0]),x.interactions(a)):siteVars.map["c"+b].length>0&&a.on("click",c)
},x.masterCategories=function(a){var c=a.attr("data-id");1===siteVars.map["m"+c].length?(a.attr("data-master-category",c),a.attr("data-id",siteVars.map["m"+c][0]),x.categories(a)):siteVars.map["m"+c].length>0&&a.on("click",b)
},f.dispatch.add(function(){switch(g.children(".box:not(.welcomeBox)").remove(),l=$('<div class="box bordered" />'),m=$('<ul class="box" />'),a){case"masterCategories":h=currentConfig.masterCategoriesArrangement,i=currentConfig.masterCategoriesDisplay,j=siteVars.map.masterCategories,k=j,n="m";
break;case"categories":h=currentConfig.categoriesArrangement,i=currentConfig.categoriesDisplay,j=siteVars.map.categories,k=siteVars.map["m"+currentMasterCategory]||j,n="c";
break;case"interactions":h=currentConfig.interactionsArrangement,i=currentConfig.interactionsDisplay,j=siteVars.map.interactions,k=siteVars.map["c"+currentCategory]||j,n="i"
}switch("BlinkSideBar"===g.attr("id")&&(h="list",i=currentConfig.sidebarDisplay),log("MyAnswers.populateItemListing(): "+a+" "+h+" "+i+" "+n+"["+k.join(",")+"]"),h){case"list":u=1;
break;case"2 column":u=2;break;case"3 column":u=3;break;case"4 column":u=4}for(t=j.length,s=0;t>s;s++)w=siteVars.config[n+j[s]],w&&-1!==$.inArray(j[s],k)&&"hide"!==w.pertinent.display&&(o=w.pertinent.displayName||w.pertinent.name,"text only"!==i&&w.pertinent.icon?(p=$("<img />"),p.attr({"class":"v"+u+"col",src:w.pertinent.icon,alt:o}),l.append(p)):(p=$("<li />"),q=$('<div class="label" />'),q.text(o),p.append(q),"string"==typeof w.pertinent.description&&(r=$('<div class="description" />'),r.text(w.pertinent.description),p.append(r)),m.append(p)),p.attr("data-id",j[s]),x[a](p))
}),f.dispatch.add(function(){l.children().length>0&&(v=l.find("img"),1===u?(v.first().addClass("topLeft topRight"),v.last().addClass("bottomLeft bottomRight")):(v.first().addClass("topLeft"),v.length>=u&&v.eq(u-1).addClass("topRight"),v.length%u===0&&(v.eq(-1*u).addClass("bottomLeft"),v.last().addClass("bottomRight"))),l.appendTo(g)),m.children().length>0&&m.appendTo(g)
})}}(this),function(a){var b,c,d,e,f=a.jQuery,g=a.MyAnswers,h=a.deviceVars,i={},j=f("#BlinkSideBar"),k=f("#stackLayout");
i.show=function(){g.dispatch.add(function(){k.addClass("bSideBar-on"),k.find(".selected").removeClass("selected"),k.find("[data-id="+currentCategory+"]").addClass("selected")
})},i.hide=function(){g.dispatch.add(function(){k.removeClass("bSideBar-on")})},i.update=function(){var i=siteVars.config["a"+siteVars.id].pertinent;
if(-1!==f.inArray("phone",h.features)||f(a).width()<768||"disabled"===i.sidebarDisplay)return void this.hide();
if(hasMasterCategories&&currentMasterCategory)b="masterCategories",d=currentMasterCategory;
else if(hasCategories&&currentCategory)b="categories",d=currentCategory;else{if(!hasInteractions||!currentCategory)return void this.hide();
b="interactions",d=currentInteraction}c!==b&&g.populateItemListing(b,j),c=b,e=d,this.show()
},g.sideBar=i}(this),MyAnswers.dumpLocalStorage=function(){$.when(MyAnswers.store.keys()).done(function(a){var b,c=a.length,d=function(a){a=a.length>20?a.substring(0,20)+"...":a,log("dumpLocalStorage(): found value: "+a)
};for(b=0;c>b;b++)log("dumpLocalStorage(): found key: "+a[b]),$.when(MyAnswers.store.get(a[b])).done(d)
})},MyAnswers.determineBlinkStorageEngine=function(a){var b,a;return a=void 0!==a?a:navigator.userAgent,a=a||"",b=null,isBlinkGapDevice()||/\bchrom/i.test(a)?b=null:-1!==a.indexOf("Android")&&(b="sessionstorage"),b
},function(a){function b(){var b=new v.Deferred,c=v.now(),d=v("#startUp-initBlinkGap"),e=function(){a.PhoneGap?a.PhoneGap.available?b.resolve():v(r).on("deviceready",b.resolve):v.now()-c>1e4?(warn("waitForBlinkGap(): still no PhoneGap after 10 seconds"),b.reject()):setTimeout(e,197)
};return a.isBlinkGap?(log("waitForBlinkGap(): native application detected"),d.addClass("working"),e(),v.when(b.promise()).fail(function(){d.addClass("error")
}).then(function(){d.addClass("success")}),b.promise()):(log("waitForBlinkGap(): native application not detected"),d.remove(),b.resolve(),b.promise())
}function c(){var b=new v.Deferred,c=null,d=function(a){c=null,x.notification.alert("Database installed, please restart the App.",function(){x.gap_database.requestTerminate()
},"First Run","Close App"),log("fixWebSQL(): quota increase: "+a)},e=function(a){var c={quotaIncrease:String(u.device.storageQuota)},e=a.allocatedSpace,f=a.currentQuota;
log("fixWebSQL(): allocatedSpace="+e+" currentQuota="+f),f<u.device.storageQuota?x.gap_database.increaseQuota(d,b.reject,c):b.resolve()
};if(u&&u.device&&u.device.storageQuota&&"number"===v.type(u.device.storageQuota)&&u.device.storageQuota>0){log("fixWebSQL(): requestedQuota="+u.device.storageQuota);
try{c=a.openDatabase(s.answerSpace,"1.0",s.answerSpace,1048576),x.gap_database.getLimits(e,b.reject,null)
}catch(f){throw b.reject(),f(f),log("*** Open/Increase quota for database failed"),"fixWebSQL(): "+f
}}else log("fixWebSQL(): nothing to do"),b.resolve();return b.promise()}function d(){var a=new v.Deferred;
return u.store?v.when(u.store.get("storageVersion")).always(function(b){b?a.resolve():v.when(u.store.set("storageVersion",0),u.store.remove("siteConfigMessage"),u.store.removeKeysRegExp(/^mojoMessage-/)).always(function(){a.resolve()
})}):a.resolve(),a.promise()}function e(a){var b,c,d,f=v.type(a);return"string"===f&&a.length>0?(b=a.indexOf("#"),-1!==b&&(a=a.substring(0,b))):"array"===f&&a.length>0?(c=[],v.each(a,function(a,b){c.push(e(b))
}),a=c):"object"===f&&(d={},v.each(a,function(a,b){d[a]=e(b)}),a=d),a}function f(){var b,c,d,e,f,g=u.orientation;
-1!==v.inArray("ios",t.features)&&90===Math.abs(a.orientation||0)?(b=a.screen.height,c=a.screen.width):(b=a.screen.width,c=a.screen.height),d=a.innerWidth,e=a.innerHeight,f=d>e?"landscape":"portrait",v.extend(u,{screenX:b,screenY:c,windowX:d,windowY:e,orientation:f}),g&&g!==f&&(log("onOrientationChange(): rotated!"),updateCurrentConfig()),y.trigger("scroll")
}function g(){t.isOnline=x.onLine===!0,log("onNetworkChange(): online="+t.isOnline)
}function h(a){var b,c,d,e,f,g,h,i,j,k,l=v(a.target),m=l.data("action"),n="Check your network connectivity and try again.",p="Are you sure you wish to discard this pending record?",q="Submitting all records may take some time, continue?",r=function(a){var b,c=new v.Deferred,d=a.data("id"),e=d.split(":"),f=e[0],g=e[1],h=e[2];
return s.config["i"+f]?(b=s.config["i"+f].pertinent.name,l.prop("disabled",!0),v.when(u.pendingStore.get(f+":"+g+":"+h)).fail(function(){BMP.alert("Error: unable to retrieve this form"),l.prop("disabled",!1)
}).then(function(d){var e;if("string"!=typeof d||0===d.length)return void l.prop("disabled",!1);
switch("object"!==v.type(d)&&(d=v.parseJSON(d)),v.type(d)){case"array":e=d[0];break;
case"object":e=d}a.addClass("s-working"),v.when(BlinkForms.submitData(b,g,e)).always(function(b,d,e){var i;
e&&"function"===v.type(e.promise)||(i=e,e=b,b=i),l.prop("disabled",!1),200===e.status&&b?u.store&&(clearPendingForm(f,g,h),a.remove()):a.toggleClass("s-working s-error"),c.resolve()
})}),c.promise()):void BMP.alert("Error: this record requires an Interaction that not currently available")
};if("submit-all"===m){if(!t.isOnline)return void BMP.alert(n,{title:"Forms Queue"});
BMP.confirm(q,{title:"Forms Queue"}).then(function(a){a&&(d=new BlinkDispatch(197),c=l.closest(".box, .view"),c.find('[data-blink="active-form"][data-id]').each(function(a,b){d.add(function(){return r(v(b))
})}))})}else e=l.closest('[data-blink="active-form"]'),f=e.data("version"),g=e.data("id"),h=g.split(":"),i=h[0],j=h[1],k=h[2],2===f?"clear"===m?BMP.confirm(p,{title:"Forms Queue"}).then(function(a){a&&v.when(clearPendingForm(i,j,k)).then(function(){e.remove()
})}):"resume"===m?(b="/"+s.answerSpace+"/"+s.config["i"+i].pertinent.name+"/?_uuid="+k,o.pushState({m:currentMasterCategory,c:currentCategory,i:i,arguments:{pendingForm:g}},null,b)):"submit"===m&&r(e):1===f&&("clear"===m?BMP.confirm(p,{title:"Forms Queue"}).then(function(a){a&&v.when(clearPendingFormV1(i,k)).then(function(){e.remove()
})}):"submit"===m&&v.when(u.pendingV1Store.get(i+":"+k)).fail(function(){BMP.alert("Unable to retrieve record from storage.",{title:"Forms Queue"})
}).then(function(a){a=v.parseJSON(a),submitFormWithRetry(a)}))}function i(){return u.runningTasks++,v("#startUp").length>0?!0:"number"==typeof u.activityIndicatorTimer?!0:(u.activityIndicatorTimer=setTimeout(function(){clearTimeout(u.activityIndicatorTimer),u.activityIndicatorTimer=null,v(u.activityIndicator).show()
},1e3),!0)}function j(){return u.runningTasks>0&&u.runningTasks--,u.runningTasks<=0&&(null!==u.activityIndicatorTimer&&clearTimeout(u.activityIndicatorTimer),u.activityIndicatorTimer=null,v(u.activityIndicator).hide()),!0
}function k(){var b=v("#startUp"),c=v("#masterCategoriesView"),d=v("#categoriesView"),e=v("#keywordListView");
if(b.length>0&&s.config){switch((-1!==v.inArray("phone",t.features)||v(a).width()<768)&&v("#mainLabel").remove(),currentConfig=s.config["a"+s.id].pertinent,s.config["a"+s.id].pertinent.siteStructure){case"interactions only":c.remove(),d.remove();
break;case"categories":c.remove(),e.find(".welcomeBox").remove();break;case"master categories":d.find(".welcomeBox").remove(),e.find(".welcomeBox").remove()
}v("#answerSpacesListView").remove(),u.gotoDefaultScreen(),function(){{var a,b=resolveItemName(s.queryParameters.keyword);
s.config["a"+s.id].pertinent}delete s.queryParameters.keyword,b&&!v.isEmptyObject(s.queryParameters)?(a="/"+s.answerSpace+"/"+s.config["i"+b].pertinent.name+"/?"+v.param(s.queryParameters),o.pushState({i:b,arguments:s.queryParameters},null,a)):b?(a="/"+s.answerSpace+"/"+s.config["i"+b].pertinent.name+"/?",o.pushState({i:b},null,a)):"string"==typeof s.queryParameters._c?(a="/"+s.answerSpace+"/?_c="+s.queryParameters._c,o.pushState({c:s.queryParameters._c},null,a)):"string"==typeof s.queryParameters._m&&(a="/"+s.answerSpace+"/?_m="+s.queryParameters._m,o.pushState({m:s.queryParameters._m},null,a)),delete s.queryParameters
}()}b.remove(),v("#content").show(),setSubmitCachedFormButton(),u.device.persistentStorage&&(u.dfrdMoJOs=processMoJOs())
}function l(){var a=u.device.persistentStorage;log("loaded():");try{a&&u.store.set("answerSpace",s.answerSpace),v.when(a?u.siteStore.get("config"):!0).then(function(a){"string"==typeof a&&(a=v.parseJSON(a)),"object"===v.type(a)&&(s.config=a)
}).always(function(){v.when(a?u.siteStore.get("map"):!0).then(function(a){"string"==typeof a&&(a=v.parseJSON(a)),"object"===v.type(a)&&(s.map=a)
}).always(function(){v.when(requestLoginStatus()).always(function(){v.when(requestConfig()).always(function(){s.map&&s.config?(processConfig(),k(),Modernizr.orientation&&y.on("orientationchange",f),y.on("resize",f),f()):w.append("error: unable to contact server, insufficient data found in local storage")
})})})}),v.when(a?u.store.get("starsProfile"):!0).then(function(a){"string"===v.type(a)&&(a=v.parseJSON(a)),"object"===v.type(a)&&(starsProfile=a)
}),v("#startUp-initLoaded").addClass("success")}catch(b){log("loaded(): exception:"),error(b),v("#startUp-initLoaded").addClass("error"),w.append("loading error: "+b)
}}function m(){{var b,e,f=null,k=[];x.userAgent}if(log("init_main(): "),s.requestsCounter=0,v.fx.interval=27,u.dispatch=new BlinkDispatch(isBlinkGapDevice()?149:47),u.runningTasks=0,RegExp.quote=function(a){return a.replace(/([.?*+\^$\[\]\\(){}\-])/g,"\\$1")
},u.activityIndicator=r.getElementById("activityIndicator"),u.activityIndicatorTimer=null,u.$body.on("taskBegun",i),u.$body.on("taskComplete",j),u.$body.delegate('a:not([href="#"])',"click",onLinkClick),u.$body.delegate('a[href="#"]',"click",!1),u.$body.on("click",'[data-blink="active-form"] button',function(a){return a.preventDefault(),h(a),!1
}),_Blink.isPhantomJS||(y.on("online",g),y.on("offline",g),g()),isBlinkGapDevice()&&(b=x.gap_database&&-1!==v.inArray("websqldatabase",BlinkStorage.prototype.available)?c():!0),isBlinkGapDevice()&&u.device.domainWhitelist&&a.navigator.whitelistmanage&&(e=u.device.domainWhitelist,"array"===v.type(e))){log("BlinkGap: replacing domain whitelist...");
try{x.whitelistmanage.appendToWhitelist(v.noop,v.noop,{externalHosts:e})}catch(m){log("BlinkGap: domain whitelist error..."),error(m)
}log("BlinkGap: domain whitelist replaced!")}k.push(u.cacheDfrd.promise()),v.when(b).always(function(){if(u.device.persistentStorage){f=u.determineBlinkStorageEngine();
try{u.store=new BlinkStorage(f,s.answerSpace,"jstore"),k.push(u.store.ready()),u.siteStore=new BlinkStorage(f,s.answerSpace,"site"),k.push(u.siteStore.ready()),u.pendingStore=new BlinkStorage(null,s.answerSpace,"pending"),k.push(u.pendingStore.ready()),u.pendingV1Store=new BlinkStorage(null,s.answerSpace,"pendingV1"),k.push(u.pendingV1Store.ready())
}catch(a){return w.addClass("s-error"),v("#startUp-initMain").addClass("error"),a.toString&&w.children("output").text(a.toString()),void w.children('article[data-name="persistentfull"]').show()
}}v.whenArray(k).fail(function(){throw v("#startUp-initMain").addClass("error"),"initMain(): unable to initialise device storage"
}).then(function(){v.when(d()).always(function(){v("#startUp-initMain").addClass("success"),v("#startUp-initLoaded").addClass("working"),l(),log("loaded(): returned after call by BlinkStorage")
})}),log("init_main(): finished...")})}function n(){var c=v("#startUp");log("onBrowserReady: "+a.location.href);
try{o=a.History,p=o.pushState,o.pushState=function(){var a=v.makeArray(arguments);
a.length>=1&&(a[0]=e(a[0])),a.length>=3&&(a[2]=e(a[2])),p.apply(o,a)},q=o.replaceState,o.replaceState=function(){var a=v.makeArray(arguments);
a.length>=1&&(a[0]=e(a[0])),a.length>=3&&(a[2]=e(a[2])),q.apply(o,a)},log("domain="+s.serverDomain+" branch="+s.serverAppBranch+" version="+s.serverAppVersion+" device="+t.device),s.serverAppPath="/_"+s.serverAppBranch+"_/common/"+s.serverAppVersion,s.serverDevicePath="/_"+s.serverAppBranch+"_/"+t.device+"/"+s.serverAppVersion,s.queryParameters=getURLParameters(),delete s.queryParameters.uid,delete s.queryParameters.answerSpace,u.$html=v("html"),u.$body=u.$html.children("body"),u.$document=v(a.document),u.$window=y,u.$footer=u.$body.children("footer"),y.on("statechange",function(a){var b=o.getState(),c=b.data.arguments;
try{log("History.stateChange: "+v.param(b.data)+" "+b.url),"object"!==v.type(s.config)||v.isEmptyObject(currentConfig)?v.noop():b.data.storage?showPendingView():s.hasLogin&&b.data.login?showLoginView():hasInteractions&&b.data.i?v.isEmptyObject(c)||c.inputs?gotoNextScreen(b.data.i):showAnswerView(b.data.i,c):hasCategories&&b.data.c?showKeywordListView(b.data.c):hasMasterCategories&&b.data.m?showCategoriesView(b.data.m):hasMasterCategories?showMasterCategoriesView():hasCategories?showCategoriesView():answerSpaceOneKeyword?gotoNextScreen(s.map.interactions[0]):showKeywordListView()
}catch(d){d("Error in onStateChange handler...")}return a.preventDefault(),!1}),-1!==location.href.indexOf("index.php?answerSpace=")&&o.replaceState(null,null,"/"+s.answerSpace+"/"),null!==r.getElementById("loginButton")&&(s.hasLogin=!0),v.when(b()).then(function(){isBlinkGapDevice()&&"function"===v.type(onDeviceReady)&&onDeviceReady()
}).always(function(){u.browserDeferred.resolve()}),v("#startUp-initBrowser").addClass("success")
}catch(d){log("onBrowserReady: Exception"),error(d),c.append("browser error: "+d),v("#startUp-initBrowser").addClass("error")
}}var o,p,q,r=a.document,s=a.siteVars,t=a.deviceVars,u=a.MyAnswers,v=a.jQuery,w=v("#startUp"),x=a.navigator,y=v(a);
s.fixImages=function(){var a;a=v(this).attr("src"),a=s.cdnu.getURL(a),v(this).off("error").attr("src",a)
},u.cacheDfrd=new v.Deferred,v(r.body).closest("html[manifest]").length?a.applicationCache?v(a.applicationCache).on({checking:function(a){log("applicationCache: status="+this.status+" event="+a.type),u.cacheDfrd.resolve()
},noupdate:function(a){log("applicationCache: status="+this.status+" event="+a.type),u.cacheDfrd.resolve()
},cached:function(a){log("applicationCache: status="+this.status+" event="+a.type),u.cacheDfrd.resolve()
},obsolete:function(a){log("applicationCache: status="+this.status+" event="+a.type),u.cacheDfrd.resolve()
},updateready:function(b){log("applicationCache: status="+this.status+" event="+b.type),log("applicationCache: reloading to use updated resources..."),a.location.reload()
},error:function(a){log("applicationCache: status="+this.status+" event="+a.type),error("Application Cache: "+this.status),u.cacheDfrd.resolve()
}}):(log("applicationCache: unsupported"),u.cacheDfrd.resolve()):(log("applicationCache: uncached"),u.cacheDfrd.resolve()),u.bootPromises=[u.deviceDeferred.promise(),u.browserDeferred.promise(),u.mainDeferred.promise()],v.whenArray(u.bootPromises).done(function(){log("all promises kept, initialising...");
try{v("#startUp-initMain").addClass("working"),m(),v("#startUp-initDevice").addClass("working"),init_device()
}catch(b){log("exception in init_?():"),error(b),w.append("initialisation error: "+b)
}log("User-Agent: "+a.navigator.userAgent),delete u.bootPromises,delete u.deviceDeferred,delete u.browserDeferred,delete u.mainDeferred
}).fail(function(){log("init failed, not all promises kept")}),v(r).ready(function(){var b,c=x.userAgent;
if(-1!==c.indexOf("Safari")&&a.localStorage){b="SafariTest-"+Math.random()*Math.pow(10,16);
try{a.localStorage.setItem(b,b),a.localStorage.removeItem(b)}catch(d){return w.addClass("s-error"),d.toString&&w.children("output").text(d.toString()),void w.children('article[data-name="privatesafari"]').show()
}}v("#startUp-loadPolyFills").addClass("working"),v("img").off("error",s.fixImages),v("img").on("error",s.fixImages),v.ajaxPrefilter(function(a,b,c){var d=decodeURI(a.url),e={answerSpaceId:s.id,answerSpace:s.answerSpace,conditions:t.features};
d.length>100&&(d=d.substring(0,100)+"..."),c.setRequestHeader("X-Blink-Config",JSON.stringify(e)),c.setRequestHeader("X-Blink-Statistics",v.param({requests:++s.requestsCounter})),a.cache="true",log("AJAX start: "+d)
}),v.getScripts=function(a){var b=new v.Deferred;return"array"!==v.type(a)?b.reject():a.length?v.getCachedScript(a.shift()).fail(b.reject).then(function(){v.getScripts(a).fail(b.reject).then(b.resolve)
}):b.resolve(),b.promise()},v.when(u.mainDeferred.promise()).then(function(){var b,c,d=new v.Deferred;
b=a.JSON&&a.JSON.stringify?!0:v.getCachedScript(_Blink.cdnp.getURL("json2.min.js")),a.XSLTProcessor&&Modernizr.xpath?(log("XPath supported natively"),d.resolve()):a.xpathParse?(log("XPath supported via AJAXSLT"),d.resolve()):v.getScripts([_Blink.cdnp.getURL("ajaxslt/0.8.1-r61/xmltoken.min.js"),_Blink.cdnp.getURL("ajaxslt/0.8.1-r61/util.min.js"),_Blink.cdnp.getURL("ajaxslt/0.8.1-r61/dom.min.js"),_Blink.cdnp.getURL("ajaxslt/0.8.1-r61/xpath.min.js")]).fail(d.reject).then(d.resolve),a.XSLTProcessor?(log("XSLT supported natively"),c=!0):a.xsltProcess?(log("XSLT supported via AJAXSLT"),c=!0):c=d.pipe(function(){return v.getCachedScript(_Blink.cdnp.getURL("ajaxslt/0.8.1-r61/xslt.min.js"))
}),v.when(b,d.promise(),c).fail(function(){v("#startUp-loadPolyFills").addClass("error"),v("#startUp").append("<p>error: refresh the application or clear cache and try again</p>")
}).then(function(){v("#startUp-loadPolyFills").addClass("success"),v("#startUp-initBrowser").addClass("working"),setTimeout(n,a.device?2e3:193)
})})})}(this),document.getElementById("startUp-loadMain").className="working success",MyAnswers.mainDeferred.resolve();

//# sourceMappingURL=ios.min.map