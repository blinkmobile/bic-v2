(function(){var e=false,f=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(k){function i(){!e&&this.init&&this.init.apply(this,arguments)}var l=this.prototype;e=true;var m=new this;e=false;for(var h in k)m[h]=typeof k[h]==="function"&&typeof l[h]==="function"&&f.test(k[h])?function(p,t){return function(){var z=this._super;this._super=l[p];var A=t.apply(this,arguments);this._super=z;return A}}(h,k[h]):k[h];i.prototype=m;i.constructor=i;i.extend=arguments.callee;
return i}})();
(function(e,f){function k(a){switch(a){case u:case v:case s:case w:case x:return true;default:return false}}function i(a,b){return!a?false:a.constructor.toString().match(RegExp(b+"\\(\\)","i"))!==null}function l(a,b,d){if(i(a,"Function"))return a.apply(b||c,i(d,"Array")?d:[d])}function m(a){if(a===undefined)return"";return JSON.stringify(a)}function h(a){return F.test(a)?JSON.parse(a):a}function p(a,b,d){if(!k(a))throw G;if(d[a]!==undefined)throw A;if(l(d)===true){c.available[a]=true;
b.flavor=a;B[a]=H.extend(b)}else{c.available[a]=false;c.enginePriority=e.map(c.enginePriority,function(g){return g===a?null:g})}}function t(){if(!c.isReady)if(C&&c.isFlashReady||!C){c.isReady=true;c.trigger("jstore-ready",[q[n]])}}function z(){if(navigator.plugins&&navigator.plugins.length>0)try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(a){}else{try{var b=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{b.AllowScriptAccess="always"}catch(d){return"6,0,0"}}catch(g){}return(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}return"0,0,0"}var A="JSTORE_ENGINE_NAMESPACE_COLLISION",G="JSTORE_INVALID_FLAVOR",F;F=/^("(\\.|[^"\\\n\r])*?"|[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t])+?$/;var u="jstore-html5-local",v="jstore-html5-sql",s="jstore-flash",w="jstore-google-gears",x="jstore-msie",H,
c={},B={},q={},C=false,o={},r={project:undefined,flash:"jStore.Flash.html",json:"browser.json.js"},n;e.extend(c,{enginePriority:[u,v,w,s,x],available:{},isReady:false,isFlashReady:false,flavors:{local:u,sql:v,flash:s,gears:w,msie:x},init:function(a,b,d){e.extend(r,{project:a},b);e(function(){r.errorCallback&&c.error(r.errorCallback);f.JSON===undefined&&e.ajax({url:r.json,complete:e.noop(),type:"GET",dataType:"script",cache:false});try{d!==undefined?c.create(d,a,"default"):c.create(c.enginePriority[0],
undefined,"best-fit")}catch(g){c.trigger("jstore-error",[g])}});return c},create:function(a,b,d){b=b||r.project||location.hostname.replace(/\./g,"-")||"unknown";if(!k(a))throw G;if(B[a]===undefined)throw"JSTORE_ENGINE_UNAVAILABLE";var g=(d!==undefined?d+".":"")+b+"."+a,j;if(q[g]!==undefined)throw"JSTORE_RESOURCE_NAMESPACE_COLLISION";j=q[g]=new B[a](b,g);if(a===s&&!c.isFlashReady){if(n===undefined)C=true;f.jstore_ready=function(){c.isFlashReady=true;if(n===undefined){n=g;t()}c.trigger("flash-ready");
f.jstore_ready=undefined};f.jstore_error=function(y){c.trigger("jstore-error",["JSTORE_FLASH_EXCEPTION",null,y])};e('<iframe style="height:1px;width:1px;position:absolute;left:0;top:0;margin-left:-100px;" id="jStoreFlashFrame" src="'+r.flash+'"></iframe>').appendTo("body")}else if(n===undefined){n=g;t()}j.ready(function(){c.trigger("jstore-engine-ready",[j])});return j},engine:function(a){return q[a]},activeEngine:function(a){if(a!==undefined)if(q[a]===undefined)throw"JSTORE_UNKNOWN_ENGINE_REQUESTED";
else n=a;return q[n]},bind:function(a,b,d){d=d||"jstore";if(o[d]===undefined)o[d]={};if(o[d][a]===undefined)o[d][a]=[b];else o[d][a].push(b);return c},trigger:function(a,b,d){d=d||"jstore";o[d]!==undefined&&o[d][a]!==undefined&&e.each(o[d][a],function(){l(this,c,b)});return c},error:function(a){c.bind("jstore-error",a)},ready:function(a){c.isReady?l(a):c.bind("jstore-ready",a);return c},engineReady:function(a){c.isReady?l(a):c.bind("jstore-engine-ready",a);return c},store:function(a,b){return b===
undefined?c.get(a):c.set(a,b)},remove:function(a){return c.activeEngine().remove(a)},get:function(a){return c.activeEngine().get(a)},set:function(a,b){return c.activeEngine().set(a,b)}});H=Class.extend({project:undefined,jri:undefined,flavor:undefined,database:undefined,data:undefined,limit:undefined,isReady:undefined,init:function(a,b){this.project=a;this.jri=b;this.data={};this.isReady=false;this.updateCache()},updateCache:function(){this.isReady=true;this.trigger("engine-ready",[this])},bind:function(a,
b){c.bind(a,b,this.jri)},trigger:function(a,b){c.trigger(a,b,this.jri)},ready:function(a){this.isReady?l(a,this):this.bind("engine-ready",a)},get:function(a){this.__interruptAccess();a=c.activeEngine().__normalizeKey(a);if(typeof a=="undefined"||a==null||a=="")return false;return this.data[a]},set:function(a,b){this.__interruptAccess();a=c.activeEngine().__normalizeKey(a);if(typeof a=="undefined"||a==null||a=="")return false;try{this.__set(a,b)}catch(d){c.trigger("jstore-error",["JSTORE_STORAGE_FAILURE",
this.jri,d])}return this.data[a]=b},remove:function(a){this.__interruptAccess();a=c.activeEngine().__normalizeKey(a);if(typeof a=="undefined"||a==null||a=="")return false;try{this.__remove(a)}catch(b){c.trigger("jstore-error",["JSTORE_REMOVE_FAILURE",this.jri,b])}var d=this.data[a];this.data[a]=undefined;return d},__interruptAccess:function(){if(!this.isReady)throw"JSTORE_ENGINE_UNSTABLE";},__normalizeKey:function(a){a+="";return a.replace(/^\s+|\s+$/g,"")},__set:function(){},__remove:function(){}});
e.extend(e.fn,{store:function(a,b){b===undefined?c.get(a):c.set(a,b);return this},removeStore:function(a){c.activeEngine().remove(a);return this},getStore:function(a){return c.activeEngine().get(a)},setStore:function(a,b){c.activeEngine().set(a,b);return this}});f.jStore=e.jStore=c;p(u,{limit:parseInt(5E5,16),init:function(a,b){this.database=!f.globalStorage?f.localStorage:f.globalStorage[location.hostname];this._super(a,b)},updateCache:function(){var a,b;for(a in this.database)if(this.database.hasOwnProperty(a)){b=
this.database.getItem(a);this.data[a]=h(b&&b.value?b.value:b)}this._super()},__set:function(a,b){this.database.setItem(a,m(b))},__remove:function(a){this.database.removeItem(a)}},function(){return f.localStorage!==undefined||f.globalStorage!==undefined});p(v,{limit:parseInt(32E3,16),init:function(a,b){this.database=f.openDatabase(a,"1.0",a,this.limit);if(!this.database)throw"JSTORE_SQL_NO_DB";this.database.transaction(function(d){d.executeSql("CREATE TABLE IF NOT EXISTS jstore (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)")});
this._super(a,b)},updateCache:function(){var a=this,b=this._super;this.database.transaction(function(d){d.executeSql("SELECT k,v FROM jstore",[],function(g,j){for(var y=j.rows,D=0,E;D<y.length;++D){E=y.item(D);a.data[E.k]=h(E.v)}b.apply(a)})})},__set:function(a,b){this.database.transaction(function(d){d.executeSql("INSERT OR REPLACE INTO jstore(k, v) VALUES (?, ?)",[a,m(b)],function(){},function(){c.trigger("jstore-error",["JSTORE_STORAGE_FAILURE",this.jri,"HTML5 SQL Store Exception"])})})},__remove:function(a){this.database.transaction(function(b){b.executeSql("DELETE FROM jstore WHERE k = ?",
[a])})}},function(){return f.openDatabase!==undefined});p(s,{limit:-1,init:function(a,b){var d=this;c.bind("flash-ready",function(){d.__flashReadyListener()});this._super(a,b)},updateCache:function(a){if(a===true){var b;a=this.database.jstore_get_all();for(b in a)if(a.hasOwnProperty(b))this.data[b]=h(this.database.jstore_get(b));this._super()}},__set:function(a,b){this.database.jstore_set(a,m(b))||c.trigger("jstore-error",["JSTORE_STORAGE_FAILURE",this.jri,"Flash Exception"])},__remove:function(a){this.database.jstore_remove(a)},
__flashReadyListener:function(){var a=e("#jStoreFlashFrame")[0];if(a.Document!==undefined&&i(a.Document.jStoreFlash.jstore_get,"Function"))this.database=a.Document.jStoreFlash;else if(a.contentWindow&&a.contentWindow.document){a=e(a.contentWindow.document);if(i(e("object",a)[0].jstore_get,"Function"))this.database=e("object",a)[0];else if(i(e("embed",a)[0].jstore_get,"Function"))this.database=e("embed",a)[0]}if(this.database===undefined)throw"JSTORE_FLASH_REFERENCE_ISSUE";else this.updateCache(true)}},
function(){var a;a:{a=z().match(/\d+/g);for(var b="9.0.0".match(/\d+/g),d=0,g,j;d<3;d++){g=parseInt(a[d],10);j=parseInt(b[d],10);if(g<j){a=false;break a}else if(g>j){a=true;break a}}a=true}return a});p(w,{limit:-1,init:function(a,b){this.database=google.gears.factory.create("beta.database");this.database.open(a);this.database.execute("CREATE TABLE IF NOT EXISTS jstore (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)");this._super(a,b)},updateCache:function(){for(var a=this.database.execute("SELECT k,v FROM jstore");a.isValidRow();){this.data[a.field(0)]=
h(a.field(1));a.next()}a.close();this._super()},__set:function(a,b){this.database.execute("BEGIN");this.database.execute("INSERT OR REPLACE INTO jstore(k, v) VALUES (?, ?)",[a,m(b)]);this.database.execute("COMMIT")},__remove:function(a){this.database.execute("BEGIN");this.database.execute("DELETE FROM jstore WHERE k = ?",[a]);this.database.execute("COMMIT")}},function(){return f.google!==undefined&&f.google.gears!==undefined});p(x,{limit:parseInt(1E4,16),init:function(a,b){this.database=e('<div style="display:none;behavior:url(\'#default#userData\')" id="'+
a+'"></div>').appendTo(document.body).get(0);this._super(a,b)},updateCache:function(){this.database.load(this.project);var a=document.getElementById(this.project).XMLDocument,b=0;if(a&&a.documentElement&&a.documentElement.attributes)for(a=a.documentElement;b<a.attributes.length;++b)this.data[a.attributes.item(b).nodeName]=h(a.attributes.item(b).nodeValue);this._super()},__normalizeKey:function(a){a=this._super(a);if(a.match(/^\d/)!=null)a="jStore-"+a;return a},__set:function(a,b){this.database.setAttribute(a,
m(b));this.database.save(this.project)},__remove:function(a){this.database.removeAttribute(a);this.database.save(this.project)}},function(){return f.ActiveXObject!==undefined})})(jQuery,window);