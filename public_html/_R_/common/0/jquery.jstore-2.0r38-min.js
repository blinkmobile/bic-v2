/*
 *  Class definition
 *
 *  Copyright (c) 2008 John Resig (http://ejohn.org/blog/simple-javascript-inheritance/)
 *  Inspired by base2 and Prototype
 */
"use strict";(function(){var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(g){var f=this.prototype;a=true;var e=new this();a=false;for(var d in g){e[d]=(typeof g[d]==="function"&&typeof f[d]==="function"&&b.test(g[d])?(function(h,i){return function(){var k=this._super;this._super=f[h];var j=i.apply(this,arguments);this._super=k;return j}}(d,g[d])):g[d])}function c(){if(!a&&this.init){this.init.apply(this,arguments)}}c.prototype=e;c.constructor=c;c.extend=arguments.callee;return c}}());
/*
 *  jStore 2.0 - Persistent Client Side Storage
 *
 *  Copyright (c) 2010 Eric Garside (http://eric.garside.name/)
 *  Dual licensed under:
 *      MIT: http://www.opensource.org/licenses/mit-license.php
 *      GPLv3: http://www.opensource.org/licenses/gpl-3.0.html
 *
 *  ---------------------------
 *
 *  jStore Flash Storage Component
 *
 *  Copyright (c) 2006 Jeff Lerman (jeff@blip.tv)
 *  Licensed under the Creative Commons Attribution 3.0 United States License:
 *      http://creativecommons.org/licenses/by/3.0/us
 */
"use strict";(function(i,n){var h="JSTORE_ENGINE_UNSTABLE",t="JSTORE_UNKNOWN_ENGINE_REQUESTED",r="JSTORE_ENGINE_NAMESPACE_COLLISION",j="JSTORE_RESOURCE_NAMESPACE_COLLISION",m="JSTORE_ENGINE_UNAVAILABLE",o="JSTORE_INVALID_FLAVOR",f=(function(){try{return new RegExp('^("(\\\\.|[^"\\\\\\n\\r])*?"|[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t])+?$')}catch(H){return(/^(true|false|null|\[.*\]|\{.*\}|".*"|\d+|\d+\.\d+)$/)}}()),b="jstore-html5-local",x="jstore-html5-sql",E="jstore-flash",F="jstore-google-gears",z="jstore-msie",u,D={},C={},B={},c=false,d={},q={project:undefined,flash:"jStore.Flash.html",json:"browser.json.js"},l;function y(H){switch(H){case b:case x:case E:case F:case z:return true;default:return false}}function g(H,I){return !H?false:H.constructor.toString().match(new RegExp(I+"\\(\\)","i"))!==null}function s(J,H,I){if(g(J,"Function")){return J.apply(H||D,g(I,"Array")?I:[I])}}function p(I,H){i.ajax({url:I,complete:H||i.noop(),type:"GET",dataType:"script",cache:false})}function w(H){if(H===undefined){return""}if(g(H,"Object")||g(H,"Array")||g(H,"Function")){return JSON.stringify(H)}return H}function k(H){return f.test(H)?JSON.parse(H):H}function e(H,I,J){if(!y(H)){throw o}if(J[H]!==undefined){throw r}if(s(J)===true){D.available[H]=true;I.flavor=H;C[H]=u.extend(I)}else{D.available[H]=false;D.enginePriority=i.map(D.enginePriority,function(K){if(K===H){return null}else{return K}})}}function v(){if(D.isReady){return}if((c&&D.isFlashReady)||!c){D.isReady=true;D.trigger("jstore-ready",[B[l]])}}function a(){D.create(D.enginePriority[0],undefined,"best-fit")}function G(){if(navigator.plugins&&navigator.plugins.length>0){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(I){}}else{try{var H=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{H.AllowScriptAccess="always"}catch(I){return"6,0,0"}}catch(I){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}return"0,0,0"}function A(H){var M=G().match(/\d+/g),K=H.match(/\d+/g),I=0,J,L;for(;I<3;I++){J=parseInt(M[I],10);L=parseInt(K[I],10);if(J<L){return false}else{if(J>L){return true}}}return true}i.extend(D,{enginePriority:[b,x,F,E,z],available:{},isReady:false,isFlashReady:false,flavors:{local:b,sql:x,flash:E,gears:F,msie:z},init:function(I,J,H){i.extend(q,{project:I},J);i(function(){if(q.errorCallback){D.error(q.errorCallback)}if(n.JSON===undefined){p(q.json)}try{if(H!==undefined){D.create(H,I,"default")}else{a()}}catch(K){D.trigger("jstore-error",[K])}});return D},create:function(H,L,I){L=L||q.project||location.hostname.replace(/\./g,"-")||"unknown";if(!y(H)){throw o}if(C[H]===undefined){throw m}var K=(I!==undefined?I+".":"")+L+"."+H,J;if(B[K]!==undefined){throw j}J=B[K]=new C[H](L,K);if(H===E&&!D.isFlashReady){if(l===undefined){c=true}n.jstore_ready=function(){D.isFlashReady=true;if(l===undefined){l=K;v()}D.trigger("flash-ready");n.jstore_ready=undefined};n.jstore_error=function(M){D.trigger("jstore-error",["JSTORE_FLASH_EXCEPTION",null,M])};i('<iframe style="height:1px;width:1px;position:absolute;left:0;top:0;margin-left:-100px;" id="jStoreFlashFrame" src="'+q.flash+'"></iframe>').appendTo("body")}else{if(l===undefined){l=K;v()}}J.ready(function(){D.trigger("jstore-engine-ready",[J])});return J},engine:function(H){return B[H]},activeEngine:function(H){if(H!==undefined){if(B[H]===undefined){throw t}else{l=H}}return B[l]},bind:function(I,J,H){H=H||"jstore";if(d[H]===undefined){d[H]={}}if(d[H][I]===undefined){d[H][I]=[J]}else{d[H][I].push(J)}return D},trigger:function(J,I,H){H=H||"jstore";if(d[H]!==undefined){if(d[H][J]!==undefined){i.each(d[H][J],function(){s(this,D,I)})}}return D},error:function(H){D.bind("jstore-error",H)},ready:function(H){if(D.isReady){s(H)}else{D.bind("jstore-ready",H)}return D},engineReady:function(H){if(D.isReady){s(H)}else{D.bind("jstore-engine-ready",H)}return D},store:function(H,I){return I===undefined?D.get(H):D.set(H,I)},remove:function(H){return D.activeEngine().remove(H)},get:function(H){return D.activeEngine().get(H)},set:function(H,I){return D.activeEngine().set(H,I)}});u=Class.extend({project:undefined,jri:undefined,flavor:undefined,database:undefined,data:undefined,limit:undefined,isReady:undefined,init:function(I,H){this.project=I;this.jri=H;this.data={};this.isReady=false;this.updateCache()},updateCache:function(){this.isReady=true;this.trigger("engine-ready",[this])},bind:function(H,I){D.bind(H,I,this.jri)},trigger:function(I,H){D.trigger(I,H,this.jri)},ready:function(H){if(this.isReady){s(H,this)}else{this.bind("engine-ready",H)}},get:function(H){this.__interruptAccess();H=D.activeEngine().__normalizeKey(H);if(typeof(H)=="undefined"||H==null||H==""){return false}return this.data[H]},set:function(H,I){this.__interruptAccess();H=D.activeEngine().__normalizeKey(H);if(typeof(H)=="undefined"||H==null||H==""){return false}try{this.__set(H,I)}catch(J){D.trigger("jstore-error",["JSTORE_STORAGE_FAILURE",this.jri,J])}this.data[H]=I;return I},remove:function(I){this.__interruptAccess();I=D.activeEngine().__normalizeKey(I);if(typeof(I)=="undefined"||I==null||I==""){return false}try{this.__remove(I)}catch(J){D.trigger("jstore-error",["JSTORE_REMOVE_FAILURE",this.jri,J])}var H=this.data[I];this.data[I]=undefined;return H},__interruptAccess:function(){if(!this.isReady){throw h}},__normalizeKey:function(H){H+="";return H.replace(/^\s+|\s+$/g,"")},__set:function(H,I){return},__remove:function(H){return}});i.extend(i.fn,{store:function(H,I){if(I===undefined){D.get(H)}else{D.set(H,I)}return this},removeStore:function(H){D.activeEngine().remove(H);return this},getStore:function(H){return D.activeEngine().get(H)},setStore:function(H,I){D.activeEngine().set(H,I);return this}});n.jStore=i.jStore=D;e(b,{limit:parseInt(500000,16),init:function(I,H){this.database=!n.globalStorage?n.localStorage:n.globalStorage[location.hostname];this._super(I,H)},updateCache:function(){var H,I;for(H in this.database){if(this.database.hasOwnProperty(H)){I=this.database.getItem(H);this.data[H]=k(I&&I.value?I.value:I)}}this._super()},__set:function(H,I){this.database.setItem(H,w(I))},__remove:function(H){this.database.removeItem(H)}},function(){return n.localStorage!==undefined||n.globalStorage!==undefined});e(x,{limit:parseInt(32000,16),init:function(I,H){this.database=n.openDatabase("jstore-"+I,"1.0",I,this.limit);if(!this.database){throw"JSTORE_SQL_NO_DB"}this.database.transaction(function(J){J.executeSql("CREATE TABLE IF NOT EXISTS jstore (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)")});this._super(I,H)},updateCache:function(){var H=this,I=this._super;this.database.transaction(function(J){J.executeSql("SELECT k,v FROM jstore",[],function(N,K){var M=K.rows,L=0,O;for(;L<M.length;++L){O=M.item(L);H.data[O.k]=k(O.v)}I.apply(H)})})},__set:function(H,I){this.database.transaction(function(J){J.executeSql("INSERT OR REPLACE INTO jstore(k, v) VALUES (?, ?)",[H,w(I)],function(K,L){},function(K,L){D.trigger("jstore-error",["JSTORE_STORAGE_FAILURE",this.jri,"HTML5 SQL Store Exception"])})})},__remove:function(H){this.database.transaction(function(I){I.executeSql("DELETE FROM jstore WHERE k = ?",[H])})}},function(){return n.openDatabase!==undefined});e(E,{limit:-1,init:function(J,I){var H=this;D.bind("flash-ready",function(){H.__flashReadyListener()});this._super(J,I)},updateCache:function(H){if(H===true){var I,J=this.database.jstore_get_all();for(I in J){if(J.hasOwnProperty(I)){this.data[I]=k(this.database.jstore_get(I))}}this._super()}},__set:function(H,I){if(!this.database.jstore_set(H,w(I))){D.trigger("jstore-error",["JSTORE_STORAGE_FAILURE",this.jri,"Flash Exception"])}},__remove:function(H){this.database.jstore_remove(H)},__flashReadyListener:function(){var H=i("#jStoreFlashFrame")[0],I;if(H.Document!==undefined&&g(H.Document.jStoreFlash.jstore_get,"Function")){this.database=H.Document.jStoreFlash}else{if(H.contentWindow&&H.contentWindow.document){I=i(H.contentWindow.document);if(g(i("object",I)[0].jstore_get,"Function")){this.database=i("object",I)[0]}else{if(g(i("embed",I)[0].jstore_get,"Function")){this.database=i("embed",I)[0]}}}}if(this.database===undefined){throw"JSTORE_FLASH_REFERENCE_ISSUE"}else{this.updateCache(true)}}},function(){return A("9.0.0")});e(F,{limit:-1,init:function(I,H){this.database=google.gears.factory.create("beta.database");this.database.open("jstore-"+I);this.database.execute("CREATE TABLE IF NOT EXISTS jstore (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)");this._super(I,H)},updateCache:function(){var H=this.database.execute("SELECT k,v FROM jstore");while(H.isValidRow()){this.data[H.field(0)]=k(H.field(1));H.next()}H.close();this._super()},__set:function(H,I){this.database.execute("BEGIN");this.database.execute("INSERT OR REPLACE INTO jstore(k, v) VALUES (?, ?)",[H,w(I)]);this.database.execute("COMMIT")},__remove:function(H){this.database.execute("BEGIN");this.database.execute("DELETE FROM jstore WHERE k = ?",[H]);this.database.execute("COMMIT")}},function(){return n.google!==undefined&&n.google.gears!==undefined});e(z,{limit:parseInt(10000,16),init:function(I,H){this.database=i('<div style="display:none;behavior:url(\'#default#userData\')" id="jstore-'+I+'"></div>').appendTo(document.body).get(0);this._super(I,H)},updateCache:function(){this.database.load(this.project);var J=document.getElementById("jstore-"+this.project),K=J.XMLDocument,H,I=0;if(K&&K.documentElement&&K.documentElement.attributes){H=K.documentElement;for(;I<H.attributes.length;++I){this.data[H.attributes.item(I).nodeName]=k(H.attributes.item(I).nodeValue)}}this._super()},__normalizeKey:function(H){H=this._super(H);if(H.match(/^\d/)!=null){H="jStore-"+H}return H},__set:function(H,I){this.database.setAttribute(H,w(I));this.database.save(this.project)},__remove:function(H){this.database.removeAttribute(H);this.database.save(this.project)}},function(){return n.ActiveXObject!==undefined})}(jQuery,window));