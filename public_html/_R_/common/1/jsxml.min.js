(function(h){var i={context:window,name:"jsxml",file_cache:true,errors:"alert"};h||(h={});for(var j in i)if(h[j])i[j]=h[j];h=i;var l=function(a){if(a)this.cb=a;this.tasks=[]};l.prototype.add=function(a){this.tasks.push(a)};l.prototype.exe=function(a){if(typeof a=="function"){this.cb=a;a=0}a=a?a:0;var c=this;if(this.tasks.length>a)this.tasks[a](function(){c.exe(a+1)});else typeof this.cb=="function"&&this.cb()};i=function(){};var m={ajax:function(a){if(this._ajax===null)this._ajax=window.jQuery?jQuery.ajax:
window.Ext&&window.Ext.Ajax?function(b){Ext.Ajax.request({url:b.url,success:function(e){b.success(e.responseXML)},failure:b.error})}:window.Ajax&&Ajax.Request?function(b){new Ajax.Request(b.url,{method:"get",onSuccess:function(e){b.success(e.responseXML)},onFailure:b.error,onException:function(e,d){b.error(d)}})}:window.YAHOO?function(b){YAHOO.util.Connect.asyncRequest("GET",b.url,{success:function(e){b.success(e.responseXML)},failure:b.error})}:false;if(this._ajax)try{this._ajax(a)}catch(c){a.error(c)}else this._throw(this._msgs.noajax)},
nodeTypes:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},importNode:function(a,c,b){switch(c.nodeType){case this.nodeTypes.ELEMENT_NODE:var e=a.createElement(c.nodeName);if(c.attributes&&c.attributes.length>0)for(var d=0,f=c.attributes.length;d<f;)e.setAttribute(c.attributes[d].nodeName,c.getAttribute(c.attributes[d++].nodeName));
if(b&&c.childNodes&&c.childNodes.length>0){d=0;for(f=c.childNodes.length;d<f;)e.appendChild(this.importNode(a,c.childNodes[d++],b))}return e;case this.nodeTypes.TEXT_NODE:case this.nodeTypes.CDATA_SECTION_NODE:case this.nodeTypes.COMMENT_NODE:return a.createTextNode(c.nodeValue)}},getMsDom:function(){var a=document.createElement("xml");a.src='<?xml version="1.0" encoding="UTF-8"?>';document.body.appendChild(a);var c=a.XMLDocument;document.body.removeChild(a);return c},newDoc:function(a){var c=window.ActiveXObject?
this.getMsDom():document.implementation.createDocument("",a&&!a.tagName?a:"test",null);if(window.ActiveXObject){if(a)a.tagName?c.appendChild(this.importNode(c,a,true)):c.appendChild(c.createElement(a))}else a.tagName&&c.replaceChild(c.importNode(a,true),c.documentElement);return c},copy:function(a){return this.fromString(this.toXml(a))},fromStringOrObject:function(a){return this.fromString(a)||this._fromObject(a)},fromString:function(a,c){if(typeof a!="string")return false;if((c=c==undefined?true:
c)&&!/^<\?xml/.test(a))return false;if(window.ActiveXObject){var b=this.newDoc();b.loadXML(a);if(!b.documentElement){this._throw(this._msgs.broken);return false}return b}else{b=(new DOMParser).parseFromString(a,"text/xml");if(b.getElementsByTagName("parsererror").length>0){this._throw(this._msgs.broken);return false}else return b}},fromFile:function(a,c,b){var e=this._cache_loading,d=this._cache,f=this;if(e[a]){if(e[a]===true)e[a]=new l;e[a].add(function(g){c.call(b?b:d[a],d[a]);g()})}else if(d[a])c.call(b?
b:d[a],d[a]);else{e[a]=true;this.ajax({url:a,success:function(g){if(g.documentElement){d[a]=g;c.call(b?b:g,g);typeof e[a]=="object"&&e[a].exe();e[a]&&delete e[a]}else f._throw(f._msgs.brokenfile+": "+a)},error:function(g){e[a]=false;if(g){var k=[];k.push(f._msgs.exception+":\r\n"+a);g.name&&k.push(g.name);g.message&&k.push(g.message);f._throw(k.join("\r\n"))}else f._throw(f._msgs.brokenfile+": "+a)}})}},load:function(a,c,b){var e=this.fromStringOrObject(a);e?c.call(b?b:e,e):this.fromFile(a,c,b)},
toXml:function(a,c){c=c==false?false:true;var b=typeof a=="string"?a:a.xml?a.xml:(new XMLSerializer).serializeToString(a),e=/^<\?xml/.test(b);if(c&&/\="UTF\-16"\?/.test(b))b=b.replace(/\=\"UTF\-16\"\?/,'="UTF-8"?');if(c&&!e)return this._xmlHeader+b;if(!c&&e)return b.replace(/^<\?xml[^<]+/,"");return b},_borrowRootName:function(a){return a?this._isA(a)?a.shift():a:"root"},toDom:function(a,c,b){rootName=this._borrowRootName(c);b=b?b.appendChild(b.ownerDocument.createElement(rootName)):this.newDoc(rootName).documentElement;
var e;if(this._isA(a))for(var d=0;d<a.length;d++)this.toDom(a[d],this._copy(c),b);else for(d in a){e=typeof a[d];switch(e){case "string":case "number":case "boolean":try{b.setAttribute(d,String(e=="boolean"?a[d]?1:0:a[d]))}catch(f){this._throw('Unable to set attribute named "'+d+'"; '+f.message)}break;case "object":if(a[d]!==null)this.toDom(a[d],this._isA(c)?[d].concat(c):d,b);break;default:this._throw('Unsuitable type of index "'+d+'" for converting to XML: '+e);return false}}return b.ownerDocument.documentElement==
b?b.ownerDocument:b},trans:function(a,c,b,e,d){var f=this;this.load(a,function(g){f._trans2(g,c,b,e,d)})},transReady:function(a,c,b,e){a=this.fromStringOrObject(a);c=this.fromStringOrObject(c);var d;if(!a||!c)return false;try{if(window.ActiveXObject){d=a.transformNode(c);d=this.fromStringOrObject(d)||d}else{var f=new XSLTProcessor;f.importStylesheet(c);d=e?f.transformToDocument(a):f.transformToFragment(a,document)}}catch(g){this._throw(this._msgs.brokenxslt);return false}return b?d:this.toXml(d,false)},
getXslWrap:function(a){a=a||{};a.indent=a.indent?a.indent:"yes";a.method=a.method?a.method:"html";return['<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"><xsl:output encoding="UTF-8" indent="'+a.indent+'" method="'+a.method+'" />',"</xsl:stylesheet>"]},_trans2:function(a,c,b,e,d){this.load(c,function(f){var g;if(b&&typeof b.length=="number"&&typeof b.splice=="function"){g=b[1];b=b[0]}else g=b;b.call(g,this.transReady(a,f,e,d))},
this)},_throw:function(a){switch(h.errors){case "alert":alert("JSXML:\r\n"+a);break;case "throw":throw"JSXML:\r\n"+a;}},_ajax:null,_fromObject:function(a){if(!a.documentElement){if(a.tagName)return this.newDoc(a);return false}return a},_xmlHeader:'<?xml version="1.0" encoding="UTF-8"?>\r\n',_cache:{},_isA:function(a){return a&&typeof a.length=="number"&&typeof a.splice=="function"},_copy:function(a){if(typeof a!="object"||a===null)return a;var c;if(this._isA(a)){c=[];for(var b=0;b<a.length;b++)c.push(a[b])}else{c=
{};for(b in a)c[b]=a[b]}return c},_cache_loading:{},_msgs:{broken:"Broken XML string",brokenfile:"Broken XML file",brokenxslt:"Broken XSLT",noajax:"No AJAX library found. See docs for supported libraries.",exception:"An exception happened while trying to load url"}};for(j in m)i.prototype[j]=m[j];h.context[h.name]=new i})();